<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN" "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">

<sql_mapping>
	<class name="State" table="mz_state">
		<id column="state_id"></id>
	
		<relationships>
			<many_to_one name="country">
				<attribute column="*" table="mz_country" />
				
				<key pcolumn="country_id" fcolumn="country_id" ftable="mz_country" />
			</many_to_one>
			
			<one_to_many name="cities">
				<attribute column="*" table="mz_city" />
				
				<key pcolumn="state_id" fcolumn="state_id" ftable="mz_city" />
			</one_to_many>
		</relationships>
		
		<queries>
			<select id="get_state">
				select st.*, co.country_id, co.name as 'country'
				from mz_state st
				inner join mz_country co on co.country_id=st.country_id
				where st.state_id=#state_id#
			</select>
			
			<select id="get_full_states">
				select st.*, co.country_id, co.name as 'country'
				from mz_state st
				inner join mz_country co on co.country_id=st.country_id
			</select>
		</queries>
	</class>
</sql_mapping>
