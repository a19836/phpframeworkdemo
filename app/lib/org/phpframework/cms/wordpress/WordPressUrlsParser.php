<?php
/*
 * Copyright (c) 2007 PHPMyFrameWork - Joao Pinto
 * AUTHOR: Joao Paulo Lopes Pinto -- http://jplpinto.com
 * 
 * The use of this code must be allowed first by the creator Joao Pinto, since this is a private and proprietary code.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS 
 * OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY 
 * AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR 
 * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL 
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, 
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER 
 * IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT 
 * OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. IN NO EVENT SHALL 
 * THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN 
 * AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE 
 * OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */
include_once get_lib("org.phpframework.util.text.TextSanitizer"); class WordPressUrlsParser { const WORDPRESS_FOLDER_PREFIX = "cms/wordpress"; public static function prepareArrayWithWordPressUrls($pfb662071, $v5d3813882f, $pae77d38c) { $v826ff96094 = is_object($pfb662071) ? $pfb662071 : array(); if ($pfb662071) { $v1312342d80 = isset($pae77d38c["wordpress_site_url"]) ? $pae77d38c["wordpress_site_url"] : null; $pf41879cb = isset($pae77d38c["current_page_url"]) ? $pae77d38c["current_page_url"] : null; foreach ($pfb662071 as $pe5c5e2fe => $v956913c90f) { if (is_array($v956913c90f) || is_object($v956913c90f)) $v956913c90f = self::prepareArrayWithWordPressUrls($v956913c90f, $v5d3813882f, $pae77d38c); else $v956913c90f = self::parseWordPressHtml($v956913c90f, $v1312342d80, $pf41879cb, $v5d3813882f); if (is_object($pfb662071)) $v826ff96094->$pe5c5e2fe = $v956913c90f; else $v826ff96094[$pe5c5e2fe] = $v956913c90f; } } return $v826ff96094; } public static function parseWordPressHtml($pf8ed4912, $v1312342d80, $pf41879cb, $v5d3813882f) { $v1229c9e077 = ""; if (!$v1312342d80 || empty($v5d3813882f["parse_wordpress_urls"])) $v1229c9e077 = $pf8ed4912; else if ($pf8ed4912) { $v1312342d80 = preg_replace("/\/+$/", "", $v1312342d80); $pf41879cb = preg_replace("/\/+$/", "", $pf41879cb); if (!empty($v5d3813882f["parse_wordpress_relative_urls"])) { $v6f44a5d462 = parse_url($v1312342d80, PHP_URL_PATH); $v32d7748b62 = parse_url($pf41879cb, PHP_URL_PATH); $pf8ed4912 = self::f009bcdd586($pf8ed4912, $v6f44a5d462, $v32d7748b62, $v5d3813882f); $pf8ed4912 = self::f009bcdd586($pf8ed4912, addcslashes($v6f44a5d462, '/'), addcslashes($v32d7748b62, '/'), $v5d3813882f, true); } $pf8ed4912 = self::f009bcdd586($pf8ed4912, $v1312342d80, $pf41879cb, $v5d3813882f); $pf41879cb .= strpos($pf41879cb, "?") === false ? "?" : "&"; $v9969b007b7 = preg_replace("/^(\/\/|https?:\/\/)/i", "", $v1312342d80); if (!empty($v5d3813882f["allowed_wordpress_urls"])) $v5d3813882f["allowed_wordpress_urls"] = is_array($v5d3813882f["allowed_wordpress_urls"]) ? $v5d3813882f["allowed_wordpress_urls"] : array($v5d3813882f["allowed_wordpress_urls"]); $pdda5eb2d = TextSanitizer::mbStrSplit($pf8ed4912); $pe2ae3be9 = count($pdda5eb2d); $v79b7cb19d1 = $v66327139f0 = $v975b306af3 = false; for ($v43dd7d0051 = 0; $v43dd7d0051 < $pe2ae3be9; $v43dd7d0051++) { $pc288256e = $pdda5eb2d[$v43dd7d0051]; if ($pc288256e == '"' && !$v66327139f0 && !TextSanitizer::isMBCharEscaped($pf8ed4912, $v43dd7d0051, $pdda5eb2d)) $v79b7cb19d1 = !$v79b7cb19d1; else if ($pc288256e == "'" && !$v79b7cb19d1 && !TextSanitizer::isMBCharEscaped($pf8ed4912, $v43dd7d0051, $pdda5eb2d)) $v66327139f0 = !$v66327139f0; else if ($pc288256e == "<" && !$v79b7cb19d1 && !$v66327139f0) { if ($pdda5eb2d[$v43dd7d0051 + 1] != "/") { $v02a69d4e0f = implode("", array_slice($pdda5eb2d, $v43dd7d0051, 10)); $v86269ee981 = array("script", "style"); $pb730b730 = false; foreach ($v86269ee981 as $v1b1c6a10a2) if (strtolower(substr($v02a69d4e0f, 0, strlen($v1b1c6a10a2))) == "<$v1b1c6a10a2") { $pb730b730 = true; $pbd1bc7b0 = mb_stripos($pf8ed4912, "</$v1b1c6a10a2", $v43dd7d0051 + 1); $pbd1bc7b0 = $pbd1bc7b0 === false ? $pe2ae3be9 : $pbd1bc7b0; $pbd1bc7b0 = mb_strpos($pf8ed4912, ">", $pbd1bc7b0); $pbd1bc7b0 = $pbd1bc7b0 === false ? $pe2ae3be9 : $pbd1bc7b0; break; } if ($pb730b730) { $v1229c9e077 .= implode("", array_slice($pdda5eb2d, $v43dd7d0051, ($pbd1bc7b0 - $v43dd7d0051) + 1)); $v43dd7d0051 = $pbd1bc7b0; continue 1; } } $v975b306af3 = true; } else if ($pc288256e == ">" && !$v79b7cb19d1 && !$v66327139f0) $v975b306af3 = false; else if ($v975b306af3 && ($v79b7cb19d1 || $v66327139f0)) { for ($v9d27441e80 = $v43dd7d0051; $v9d27441e80 < $pe2ae3be9; $v9d27441e80++) { $pc288256e = $pdda5eb2d[$v9d27441e80]; if ($pc288256e == '"' && $v79b7cb19d1 && !TextSanitizer::isMBCharEscaped($pf8ed4912, $v9d27441e80, $pdda5eb2d)) break; else if ($pc288256e == "'" && $v66327139f0 && !TextSanitizer::isMBCharEscaped($pf8ed4912, $v9d27441e80, $pdda5eb2d)) break; } $pd6321fb0 = trim(implode("", array_slice($pdda5eb2d, $v43dd7d0051, $v9d27441e80 - $v43dd7d0051))); if ($pd6321fb0) { $pdfa3f944 = false; if (stripos($pd6321fb0, $v1312342d80) === 0) { $pb3c82f3d = trim(substr($pd6321fb0, strlen($v1312342d80))); $pdfa3f944 = !$pbdb99a55 || preg_match("/^(\/|\\\/|\$|#|&)/", $pb3c82f3d); } else if (substr($pd6321fb0, 0, 2) == "//" && stripos(substr($pd6321fb0, 2), $v9969b007b7) === 0) { $pb3c82f3d = trim(substr($pd6321fb0, strlen($v9969b007b7) + 2)); $pdfa3f944 = !$pbdb99a55 || preg_match("/^(\/|\\\/|\$|#|&)/", $pb3c82f3d); } if (!$pdfa3f944 && !empty($v5d3813882f["parse_wordpress_relative_urls"]) && stripos($pd6321fb0, $v6f44a5d462) !== false) { $pbd1bc7b0 = stripos($pd6321fb0, $v6f44a5d462); $pb3c82f3d = trim(substr($pd6321fb0, $pbd1bc7b0 + strlen($v6f44a5d462))); $pdfa3f944 = !$pbdb99a55 || preg_match("/^(\/|\\\/|\$|#|&)/", $pb3c82f3d); } if ($pdfa3f944 && !self::f601c4a839a($pd6321fb0, $v5d3813882f)) { $v01b7bef391 = self::isWordPressPHPFile($pd6321fb0); if ($v01b7bef391 || !self::isWordPressRawFile($pd6321fb0)) { $pd6321fb0 = self::convertUrlToRedirectUrl($v1312342d80, $pf41879cb, $pd6321fb0, $v5d3813882f, $v01b7bef391 ? "wp_file" : "wp_url"); } } } $v1229c9e077 .= $pd6321fb0; $v43dd7d0051 = $v9d27441e80 - 1; continue 1; } $v1229c9e077 .= $pc288256e; } } return $v1229c9e077; } private static function f009bcdd586($pf8ed4912, $v1312342d80, $pf41879cb, $v5d3813882f, $pe6e0b657 = false) { if ($pf8ed4912) { $pac65f06f = 0; do { $pbd1bc7b0 = stripos($pf8ed4912, $v1312342d80, $pac65f06f); if ($pbd1bc7b0 !== false) { $v539082ff30 = self::f30f11449a1($pf8ed4912, $v1312342d80, $pbd1bc7b0, $v5d3813882f); $v464f1cc051 = $v539082ff30[0]; $v7e4b517c18 = $v539082ff30[1]; $pac65f06f = $v539082ff30[2]; $pbd1bc7b0 = stripos($v464f1cc051, $v1312342d80); $pb3c82f3d = trim(substr($v464f1cc051, $pbd1bc7b0 + strlen($v1312342d80))); $pdfa3f944 = !$pbdb99a55 || preg_match("/^(\/|\\\/|\$|#|&|\"|')/", $pb3c82f3d); if ($pdfa3f944 && !self::f601c4a839a($v464f1cc051, $v5d3813882f)) { $v01b7bef391 = self::isWordPressPHPFile($v464f1cc051); if ($v01b7bef391 || !self::isWordPressRawFile($v464f1cc051)) { $v401491fc94 = self::convertUrlToRedirectUrl($v1312342d80, $pf41879cb, $v464f1cc051, $v5d3813882f, $v01b7bef391 ? "wp_file" : "wp_url", $pe6e0b657); if ($v401491fc94 != $v464f1cc051) { $pf8ed4912 = substr($pf8ed4912, 0, $v7e4b517c18) . $v401491fc94 . substr($pf8ed4912, $pac65f06f); $pac65f06f = $v7e4b517c18 + strlen($v401491fc94); } } } } } while($pbd1bc7b0 !== false); } return $pf8ed4912; } private static function f30f11449a1($pf8ed4912, $v7061b5a62e, $pbd1bc7b0, $v5d3813882f) { $v346e1685e3 = null; $v29b7e75ba8 = strlen($pf8ed4912); $pf80ef7b7 = strlen($v7061b5a62e); $pa9880268 = $v5d3813882f && isset($v5d3813882f["delimiters"]) ? $v5d3813882f["delimiters"] : ""; for ($v43dd7d0051 = $pbd1bc7b0 - 1; $v43dd7d0051 >= 0; $v43dd7d0051--) { $pc288256e = $pf8ed4912[$v43dd7d0051]; if ($pc288256e == '"' || $pc288256e == "'") { $v346e1685e3 = array($pc288256e); break; } else if ($pa9880268 && $pa9880268[$pc288256e]) { $v346e1685e3 = is_array($pa9880268[$pc288256e]) ? $pa9880268[$pc288256e] : array($pa9880268[$pc288256e]); break; } else if (!preg_match("/[a-z0-9_\-\.\:\/\\\\]/i", $pc288256e)) break; } for ($v9d27441e80 = $pbd1bc7b0 + $pf80ef7b7; $v9d27441e80 < $v29b7e75ba8; $v9d27441e80++) { $pc288256e = $pf8ed4912[$v9d27441e80]; if ( ($v346e1685e3 && in_array($pc288256e, $v346e1685e3)) || (!$v346e1685e3 && preg_match("/(\s|\"|\'|>)/", $pc288256e)) ) break; } $v43dd7d0051++; $v464f1cc051 = substr($pf8ed4912, $v43dd7d0051, $v9d27441e80 - $v43dd7d0051); $pac65f06f = $v9d27441e80; return array($v464f1cc051, $v43dd7d0051, $v9d27441e80); } public static function parseWordPressHeaders($v1312342d80, $pf41879cb, $v5d3813882f, &$pa2507f6c = false) { $v15493e4c60 = headers_list(); if ($v15493e4c60 && $v1312342d80 && !empty($v5d3813882f["parse_wordpress_urls"])) { $v1312342d80 = preg_replace("/\/+$/", "", $v1312342d80); $pf41879cb = preg_replace("/\/+$/", "", $pf41879cb); $pf41879cb .= strpos($pf41879cb, "?") === false ? "?" : "&"; if (!empty($v5d3813882f["parse_wordpress_relative_urls"])) { $v6f44a5d462 = parse_url($v1312342d80, PHP_URL_PATH); $v32d7748b62 = parse_url($pf41879cb, PHP_URL_PATH); } foreach ($v15493e4c60 as $v6c438ea8cd) { $v9cd205cadb = explode(":", $v6c438ea8cd); if (count($v9cd205cadb) > 1) { $v5e813b295b = array_shift($v9cd205cadb); $v67db1bd535 = implode(":", $v9cd205cadb); $v5d3813882f["delimiters"] = array("<" => ">"); $pa456327a = $v67db1bd535; if (!empty($v5d3813882f["parse_wordpress_relative_urls"])) { $pa456327a = self::f009bcdd586($pa456327a, $v6f44a5d462, $v32d7748b62, $v5d3813882f); $pa456327a = self::f009bcdd586($pa456327a, addcslashes($v6f44a5d462, '/'), addcslashes($v32d7748b62, '/'), $v5d3813882f, true); } if (stripos($pa456327a, $v1312342d80) !== false) $pa456327a = self::f009bcdd586($pa456327a, $v1312342d80, $pf41879cb, $v5d3813882f); if ($pa456327a != $v67db1bd535) { $v6c438ea8cd = $v5e813b295b . ":" . $pa456327a; header($v6c438ea8cd); } if (strtolower(trim($v5e813b295b)) == "location") $pa2507f6c = true; } } } } public static function convertUrlToRedirectUrl($v1312342d80, $pf41879cb, $pf0ba5004, $v5d3813882f, $v5e45ec9bb9 = "wp_url", $pe6e0b657 = false) { $v1312342d80 = htmlspecialchars_decode($v1312342d80); $pf41879cb = htmlspecialchars_decode($pf41879cb); $pf0ba5004 = htmlspecialchars_decode($pf0ba5004); $pef22cc31 = $v1312342d80; $pd861a3d0 = $pf41879cb; $v1312342d80 = self::f40c2157a57($v1312342d80, $pf0ba5004, $pe6e0b657); $pf41879cb = self::f40c2157a57($pf41879cb, $pf0ba5004, $pe6e0b657); $v9969b007b7 = preg_replace("/^(\/\/|https?:\/\/)/i", "", $v1312342d80); $v6f44a5d462 = parse_url($v1312342d80, PHP_URL_PATH); self::f5f82edbec8($pf0ba5004, $v1312342d80); if (substr($pf0ba5004, 0, 2) == "//") self::f5f82edbec8($pf0ba5004, $v9969b007b7); $v9cd205cadb = parse_url($pf0ba5004); if (isset($v9cd205cadb["scheme"])) { $v9bf2f1652d = parse_url($pf0ba5004, PHP_URL_SCHEME); $v7932ae63c3 = parse_url($pf41879cb); $v42c1a67f73 = $v9bf2f1652d . "://" . $v7932ae63c3["host"] . (isset($v7932ae63c3["port"]) ? ":" . $v7932ae63c3["port"] : "") . "/"; self::f5f82edbec8($pf0ba5004, $v42c1a67f73); } $v9cd205cadb = parse_url($pf0ba5004); if (isset($v9cd205cadb["scheme"])) return $pf0ba5004; $pf0ba5004 = isset($v9cd205cadb["path"]) ? $v9cd205cadb["path"] : null; $pc2defd39 = isset($v9cd205cadb["query"]) ? $v9cd205cadb["query"] : null; $v258de04f2e = isset($v9cd205cadb["fragment"]) ? $v9cd205cadb["fragment"] : null; $v3be7a4d36f = $v6f44a5d462 . (substr($v6f44a5d462, -1) == "/" ? "" : "/"); if (strpos($pf0ba5004, $v3be7a4d36f) === 0) $pf0ba5004 = substr($pf0ba5004, strlen($v3be7a4d36f)); else if ($pf0ba5004 == $v6f44a5d462) $pf0ba5004 = ""; if (preg_match("/paged=([0-9]*)/", $pf41879cb, $pbae7526c)) { $v5c767f128f = $pbae7526c[1]; $pf41879cb = preg_replace("/paged=([0-9]*)&?/", "", $pf41879cb); if (preg_match("/paged=([0-9]*)/", $pc2defd39, $pbae7526c)) { $paae2e755 = $pbae7526c[1]; if ($paae2e755 == $v5c767f128f) $pc2defd39 = preg_replace("/paged=([0-9]*)&?/", "", $pc2defd39); } } if ($pc2defd39) { parse_str($pc2defd39, $v9b391a5b1f); if ($v9b391a5b1f) { foreach ($v9b391a5b1f as $v67ccb03f4c => $v72eb975550) { $pf41879cb = preg_replace("/$v67ccb03f4c=[^&]*/", "", $pf41879cb); if ($v67ccb03f4c != "wp_url" && $v67ccb03f4c != "wp_file") { $v72eb975550 = urldecode($v72eb975550); $pdfa3f944 = false; if (stripos($v72eb975550, $v1312342d80) === 0) $pdfa3f944 = true; else if (substr($v72eb975550, 0, 2) == "//" && stripos(substr($v72eb975550, 2), $v9969b007b7) === 0) $pdfa3f944 = true; else if (!empty($v5d3813882f["parse_wordpress_relative_urls"]) && stripos($v72eb975550, $v6f44a5d462) !== false) { $pbd1bc7b0 = stripos($v72eb975550, $v6f44a5d462); $pdfa3f944 = preg_match("/(|\s|\"|'|\/|\?|#)/", $v72eb975550[$pbd1bc7b0 + 1]); } if ($pdfa3f944 && !self::f601c4a839a($v72eb975550, $v5d3813882f)) { $v01b7bef391 = self::isWordPressPHPFile($v72eb975550); if ($v01b7bef391 || !self::isWordPressRawFile($v72eb975550)) { $v21e47e1276 = self::convertUrlToRedirectUrl($pef22cc31, $pd861a3d0, $v72eb975550, $v5d3813882f, $v01b7bef391 ? "wp_file" : "wp_url"); $pc2defd39 = "&$pc2defd39&"; $pc2defd39 = str_replace("&$v67ccb03f4c=$v72eb975550&", "&$v67ccb03f4c=" . urlencode($v21e47e1276) . "&", $pc2defd39); $pc2defd39 = substr($pc2defd39, 1, -1); } } } } } } if ($pe6e0b657) $pf0ba5004 = stripcslashes($pf0ba5004); if ($pf0ba5004 == "/") $pf0ba5004 = ""; $pf41879cb = $pf41879cb . (strpos($pf41879cb, "?") === false ? "?" : "&") . "$v5e45ec9bb9=" . urlencode($pf0ba5004) . ($pc2defd39 ? "&$pc2defd39" : ""); if (!empty($v5d3813882f["phpframework_block_id"])) self::replaceUrlPhpFrameworkBlockId($pf41879cb, $v5d3813882f["phpframework_block_id"]); if ($v258de04f2e) $pf41879cb .= "#$v258de04f2e"; $pf41879cb = str_replace("?&", "?", preg_replace("/&+/", "&", $pf41879cb)); return $pf41879cb; } private static function f40c2157a57($v6f3a2700dd, $v8403379471, $pe6e0b657) { if ($pe6e0b657) { $v6f3a2700dd = stripcslashes($v6f3a2700dd); $v8403379471 = stripcslashes($v8403379471); } $v35217a3375 = parse_url($v6f3a2700dd); $pab4b32fa = parse_url($v8403379471); if (empty($v35217a3375["host"]) && !empty($pab4b32fa["host"])) { $pd5141703 = isset($pab4b32fa["user"]) ? $pab4b32fa["user"] : null; $v52e9ea5509 = !empty($pab4b32fa["pass"]) ? ":" . $pab4b32fa["pass"] : ""; $v7e782022ec = isset($pab4b32fa["port"]) ? $pab4b32fa["port"] : null; $v6f3a2700dd = ($pd5141703 || $v52e9ea5509 ? "$pd5141703$v52e9ea5509@" : "") . $pab4b32fa["host"] . ($v7e782022ec ? ":$v7e782022ec" : "") . (substr($v6f3a2700dd, 0, 1) == "/" ? "" : "/") . $v6f3a2700dd; } if (empty($v35217a3375["scheme"]) && !empty($pab4b32fa["scheme"])) $v6f3a2700dd = $pab4b32fa["scheme"] . "://" . $v6f3a2700dd; if ($pe6e0b657) { $v6f3a2700dd = addcslashes($v6f3a2700dd, '/'); $v8403379471 = addcslashes($v8403379471, '/'); } return $v6f3a2700dd; } private static function f5f82edbec8(&$v6f3a2700dd, $v2d41eba608) { self::prepareUrl($v6f3a2700dd); $v6f3a2700dd = $v2d41eba608 && strpos($v6f3a2700dd, $v2d41eba608) === 0 ? substr($v6f3a2700dd, strlen($v2d41eba608)) : $v6f3a2700dd; } public static function prepareUrl(&$v6f3a2700dd) { $v6f3a2700dd = trim($v6f3a2700dd); $v6f3a2700dd = preg_replace("/(\?|&)(phpframework_block_id|wp_url|wp_file)=([^&]*)/", "\${1}", $v6f3a2700dd); $v6f3a2700dd = preg_replace("/&+/", "&", $v6f3a2700dd); $v6f3a2700dd = preg_replace("/\?&/", "?", $v6f3a2700dd); } public static function replaceUrlPhpFrameworkBlockId(&$v6f3a2700dd, $v29fec2ceaa) { $v6f3a2700dd = preg_replace("/(\?|&)phpframework_block_id=([^&]*)/", "\${1}", $v6f3a2700dd); $v6f3a2700dd .= (strpos($v6f3a2700dd, "?") === false ? "?" : "&") . "phpframework_block_id=" . $v29fec2ceaa; } public static function isWordPressPHPFile($v6f3a2700dd) { $pbd1bc7b0 = strpos($v6f3a2700dd, "?"); if ($pbd1bc7b0 !== false) $v6f3a2700dd = substr($v6f3a2700dd, 0, $pbd1bc7b0); $pbd1bc7b0 = strpos($v6f3a2700dd, "#"); if ($pbd1bc7b0 !== false) $v6f3a2700dd = substr($v6f3a2700dd, 0, $pbd1bc7b0); $v6f3a2700dd = trim($v6f3a2700dd); return strtolower(substr($v6f3a2700dd, -4)) == ".php"; } public static function isWordPressRawFile($v6f3a2700dd) { $pbd1bc7b0 = strpos($v6f3a2700dd, "?"); if ($pbd1bc7b0 !== false) $v6f3a2700dd = substr($v6f3a2700dd, 0, $pbd1bc7b0); $pbd1bc7b0 = strpos($v6f3a2700dd, "#"); if ($pbd1bc7b0 !== false) $v6f3a2700dd = substr($v6f3a2700dd, 0, $pbd1bc7b0); $v6f3a2700dd = trim($v6f3a2700dd); if (substr($v6f3a2700dd, -1) == "/") return false; else if (stripos($v6f3a2700dd, "/wp-content/uploads/") !== false) return true; $v6f3a2700dd = str_replace("://", "", $v6f3a2700dd); $v6f3a2700dd = preg_replace("/\/+/", "/", $v6f3a2700dd); $v9cd205cadb = explode("/", $v6f3a2700dd); $pf579a273 = $v9cd205cadb[ count($v9cd205cadb) - 1 ]; $pbd1bc7b0 = strrpos($pf579a273, "."); $v6bfcc44e7b = $pbd1bc7b0 !== false ? substr($pf579a273, $pbd1bc7b0 + 1) : ''; return $v6bfcc44e7b && strlen($v6bfcc44e7b) < 4; } private static function f601c4a839a($v6f3a2700dd, $v5d3813882f) { if ($v5d3813882f && !empty($v5d3813882f["allowed_wordpress_urls"])) foreach ($v5d3813882f["allowed_wordpress_urls"] as $v5f7147fb39) { $pf71bbb46 = $v5f7147fb39[0] == "/" && substr($v5f7147fb39, -1) == "/"; if ( ($pf71bbb46 && preg_match($v5f7147fb39, $v6f3a2700dd)) || (!$pf71bbb46 && $v5f7147fb39 == $v6f3a2700dd) ) return true; } return false; } } ?>
