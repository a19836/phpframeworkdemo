<?php
/*
 * Copyright (c) 2007 PHPMyFrameWork - Joao Pinto
 * AUTHOR: Joao Paulo Lopes Pinto -- http://jplpinto.com
 * 
 * The use of this code must be allowed first by the creator Joao Pinto, since this is a private and proprietary code.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS 
 * OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY 
 * AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR 
 * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL 
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, 
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER 
 * IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT 
 * OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. IN NO EVENT SHALL 
 * THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN 
 * AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE 
 * OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

if (!function_exists("normalize_windows_path_to_linux")) { function normalize_windows_path_to_linux($pa32be502) { return DIRECTORY_SEPARATOR != "/" ? str_replace(DIRECTORY_SEPARATOR, "/", $pa32be502) : $pa32be502; } } if (!function_exists("get_lib")) { function get_lib($pa32be502) { $pa32be502 = strpos($pa32be502, "lib.") === 0 ? substr($pa32be502, strlen("lib.")) : $pa32be502; return dirname(dirname(dirname(dirname(normalize_windows_path_to_linux(__DIR__))))) . "/" . str_replace(".", "/", $pa32be502) . ".php"; } } include_once get_lib("org.phpframework.cms.wordpress.WordPressUrlsParser"); class WordPressRequestHandler { public $parse_output; private $v0e0f1bdb43; private $pa02dc6aa; private $pfe7577f3 = false; public function __construct($v0e0f1bdb43, $pa02dc6aa) { $this->v0e0f1bdb43 = $v0e0f1bdb43; $this->pa02dc6aa = $pa02dc6aa ? $pa02dc6aa : $v0e0f1bdb43; $this->parse_output = $this->isPHPFrameworkRequestToParse(); } public function isPHPFrameworkRequestToParse() { global $phpframework_options, $current_phpframework_result_key; if (isset($phpframework_options) || isset($current_phpframework_result_key)) return false; if ($_SERVER["HTTP_REFERER"] && $_COOKIE[$this->pa02dc6aa . "_phpframework_url"]) { $v0c2387431b = explode("#", $_SERVER["HTTP_REFERER"]); $v0c2387431b = explode("?", $v0c2387431b[0]); $v0c2387431b = $v0c2387431b[0]; $v5841083cb4 = explode("#", $_COOKIE[$this->pa02dc6aa . "_phpframework_url"]); $v5841083cb4 = explode("?", $v5841083cb4[0]); $v5841083cb4 = $v5841083cb4[0]; return $v5841083cb4 == $v0c2387431b; } return false; } public function startCatchingOutput() { if ($this->parse_output) { register_shutdown_function(array($this, "endCatchingOutput")); $this->pfe7577f3 = true; ob_start(); } } public function endCatchingOutput() { if ($this->pfe7577f3) { $this->pfe7577f3 = false; $pf8ed4912 = ob_get_contents(); ob_end_clean(); $v1312342d80 = site_url() . "/"; $pae77d38c = array( "wordpress_site_url" => $v1312342d80, "current_page_url" => $_COOKIE[$this->pa02dc6aa . "_phpframework_url"], ); $v5d3813882f = array( "allowed_wordpress_urls" => unserialize($_COOKIE[$this->pa02dc6aa . "_allowed_wordpress_urls"]), "parse_wordpress_urls" => $_COOKIE[$this->pa02dc6aa . "_parse_wordpress_urls"], "parse_wordpress_relative_urls" => $_COOKIE[$this->pa02dc6aa . "_parse_wordpress_relative_urls"], ); WordPressUrlsParser::parseWordPressHeaders($pae77d38c["wordpress_site_url"], $pae77d38c["current_page_url"], $v5d3813882f); if ($pf8ed4912) { $pb55d576b = substr($pf8ed4912, 0, 1) == "{" && substr($pf8ed4912, -1) == "}" ? json_decode($pf8ed4912, true) : null; if ($pb55d576b) { $pb55d576b = WordPressUrlsParser::prepareArrayWithWordPressUrls($pb55d576b, $v5d3813882f, $pae77d38c); $pf8ed4912 = json_encode($pb55d576b); } else $pf8ed4912 = WordPressUrlsParser::parseWordPressHtml($pf8ed4912, $pae77d38c["wordpress_site_url"], $pae77d38c["current_page_url"], $v5d3813882f); } echo $pf8ed4912; } } } ?>
