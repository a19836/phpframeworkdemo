<?php
/*
 * Copyright (c) 2007 PHPMyFrameWork - Joao Pinto
 * AUTHOR: Joao Paulo Lopes Pinto -- http://jplpinto.com
 * 
 * The use of this code must be allowed first by the creator Joao Pinto, since this is a private and proprietary code.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS 
 * OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY 
 * AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR 
 * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL 
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, 
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER 
 * IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT 
 * OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. IN NO EVENT SHALL 
 * THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN 
 * AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE 
 * OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */
if (file_exists( get_lib("lib.vendor.phpmailer.PHPMailerAutoload") )) include_once get_lib("lib.vendor.phpmailer.PHPMailerAutoload"); class SmtpEmail { private $v641a8eff1b; private $pb38119eb; private $v2063d7a628; private $pa913859c; private $pe1b79626; private $v062ac71672; private $v53e6fbb1f7 = null; private $v79050c19e4 = false; public function __construct($v641a8eff1b, $pb38119eb, $v2063d7a628, $pa913859c, $pe1b79626, $v062ac71672 = 'utf-8') { $this->v641a8eff1b = $v641a8eff1b; $this->pb38119eb = $pb38119eb; $this->v2063d7a628 = $v2063d7a628; $this->pa913859c = $pa913859c; $this->pe1b79626 = $pe1b79626; $this->v062ac71672 = $v062ac71672; $this->v79050c19e4 = class_exists("PHPMailer"); } public function setDebug($v8b809255dd, $pf7dd614f = 'echo') { $this->v53e6fbb1f7->SMTPDebug = $v8b809255dd; $this->v53e6fbb1f7->Debugoutput = $pf7dd614f; } public function send($v769a9c3807, $v4446fb8633, $pa04f7e11, $v94a62ba63a, $pe6c1d5bd, $v568e7467ac, $pe4c7aeda, $pffa799aa, $v4256d0e3cc = null) { if (!$this->v79050c19e4) return false; $this->mdc9f9cb49924($v769a9c3807, $v4446fb8633); $this->mdc9f9cb49924($pa04f7e11, $v94a62ba63a); $pac65f06f = 0; $v1d04a742d3 = array(); do { $pe87d31f2 = $pe6c1d5bd; $pd98df87c = $v568e7467ac; $pac65f06f = $this->mdc9f9cb49924($pe87d31f2, $pd98df87c, $pac65f06f); if ($pac65f06f !== false) { $pac65f06f = strpos($pe6c1d5bd, ",", $pac65f06f); $pac65f06f = $pac65f06f !== false ? $pac65f06f + 1 : false; } $v1d04a742d3[] = array($pe87d31f2, $pd98df87c); } while ($pac65f06f !== false && $pac65f06f < strlen($pe6c1d5bd)); $this->v53e6fbb1f7 = new PHPMailer; $this->v53e6fbb1f7->isSMTP(); $this->v53e6fbb1f7->CharSet = $this->v062ac71672; $this->v53e6fbb1f7->Host = $this->v641a8eff1b; $this->v53e6fbb1f7->Port = $this->pb38119eb; $this->v53e6fbb1f7->SMTPSecure = $this->pe1b79626 ? $this->pe1b79626 : null; $this->v53e6fbb1f7->SMTPAuth = $this->v2063d7a628 ? true : false; $this->v53e6fbb1f7->Username = $this->v2063d7a628; $this->v53e6fbb1f7->Password = $this->pa913859c; $this->v53e6fbb1f7->setFrom($v769a9c3807, $v4446fb8633); $this->v53e6fbb1f7->addReplyTo($pa04f7e11, $v94a62ba63a); foreach ($v1d04a742d3 as $pe6c1d5bd) $this->v53e6fbb1f7->addAddress($pe6c1d5bd[0], $pe6c1d5bd[1]); $this->v53e6fbb1f7->Subject = $pe4c7aeda; $v6107abf109 = preg_replace("/<br\s*\/?>/", "", $pffa799aa); $pcbe60070 = $v6107abf109 != strip_tags($v6107abf109); if ($pcbe60070) { $this->v53e6fbb1f7->ContentType = 'text/html'; $pffa799aa = trim(str_replace(array("\n", "\r"), "", $pffa799aa)); $this->v53e6fbb1f7->msgHTML( nl2br($pffa799aa) ); } else { $this->v53e6fbb1f7->msgHTML( nl2br($pffa799aa) ); $this->v53e6fbb1f7->AltBody = strip_tags($pffa799aa); } if ($v4256d0e3cc) { $v4256d0e3cc = is_array($v4256d0e3cc) ? $v4256d0e3cc : array($v4256d0e3cc); for ($v43dd7d0051 = 0, $pc37695cb = count($v4256d0e3cc); $v43dd7d0051 < $pc37695cb; $v43dd7d0051++) { $pa3747e16 = $v4256d0e3cc[$v43dd7d0051]; $pf5978442 = $pa3747e16; $v181c3d5aed = ""; if (is_array($pa3747e16)) { $pf5978442 = $pa3747e16["path"]; $v181c3d5aed = $pa3747e16["name"]; } if ($pf5978442 && file_exists($pf5978442)) $this->v53e6fbb1f7->addAttachment($pf5978442, $v181c3d5aed); } } return $this->v53e6fbb1f7->send() ? true : false; } public function getPHPMailer() { return $this->v53e6fbb1f7; } public function getErrorInfo() { return $this->v79050c19e4 ? $this->v53e6fbb1f7->ErrorInfo : "PHPMailer library is not loaded, wasn't installed or doesn't exists!"; } private function mdc9f9cb49924(&$v9239e028dd, &$v5e813b295b, $pac65f06f = 0) { $pea98bd8b = strpos($v9239e028dd, "<", $pac65f06f); if ($pea98bd8b !== false) { $v1fdc6f29da = strpos($v9239e028dd, ">", $pea98bd8b); $v1fdc6f29da = $v1fdc6f29da === false ? strlen($v9239e028dd) : $v1fdc6f29da; $v5e813b295b = trim($v5e813b295b); $v5e813b295b = empty($v5e813b295b) ? trim(substr($v9239e028dd, $pac65f06f, $pea98bd8b - $pac65f06f)) : $v5e813b295b; $v9239e028dd = trim(substr($v9239e028dd, $pea98bd8b + 1, $v1fdc6f29da - $pea98bd8b - 1)); $pac65f06f = $v1fdc6f29da; } else $pac65f06f = strlen($v9239e028dd); return $pac65f06f; } } ?>
