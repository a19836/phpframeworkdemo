<?php
/*
 * Copyright (c) 2007 PHPMyFrameWork - Joao Pinto
 * AUTHOR: Joao Paulo Lopes Pinto -- http://jplpinto.com
 * 
 * The use of this code must be allowed first by the creator Joao Pinto, since this is a private and proprietary code.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS 
 * OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY 
 * AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR 
 * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL 
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, 
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER 
 * IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT 
 * OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. IN NO EVENT SHALL 
 * THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN 
 * AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE 
 * OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

include_once get_lib("lib.vendor.phpparser.lib.bootstrap"); include_once get_lib("org.phpframework.workflow.PHPParserPrettyPrinter"); include_once get_lib("org.phpframework.phpscript.PHPCodeBeautifier"); include_once get_lib("org.phpframework.util.text.TextSanitizer"); class CMSFileHandler { public static function getFileTemplates($pf3dc0762, $pacfef7d5 = false, $v08a1062039 = 0, $pf9851a9c = -1) { return self::getTemplates(self::getFileContents($pf3dc0762), $pacfef7d5, $v08a1062039, $pf9851a9c); } public static function getTemplates($v6490ea3a15, $pacfef7d5 = false, $v08a1062039 = 0, $pf9851a9c = -1) { $v94d48fb72f = array(); if ($v6490ea3a15) { self::f0dbc620630($v6490ea3a15); $v0b196f001b = $pacfef7d5 && substr($pacfef7d5, 0, 1) != '$' ? '$' . $pacfef7d5 : $pacfef7d5; $pedde3449 = self::f9312178574($v6490ea3a15, "setTemplate", $v0b196f001b, $v08a1062039, $pf9851a9c); foreach ($pedde3449 as $v6cd9d4006f) { if (!$v6cd9d4006f["static"]) { if ($v6cd9d4006f["params"][0]["type"] == "variable") { $pe7333513 = $v6cd9d4006f["params"][0]["referenced_value"]; $v3ba41b5a07 = $v6cd9d4006f["params"][0]["referenced_type"]; } else { $pe7333513 = $v6cd9d4006f["params"][0]["value"]; $v3ba41b5a07 = $v6cd9d4006f["params"][0]["type"]; } if ($v6cd9d4006f["params"][1]["type"] == "variable") { $v9e3513bc0e = $v6cd9d4006f["params"][1]["referenced_value"]; $pc34fdd94 = $v6cd9d4006f["params"][1]["referenced_type"]; } else { $v9e3513bc0e = $v6cd9d4006f["params"][1]["value"]; $pc34fdd94 = $v6cd9d4006f["params"][1]["type"]; } $v94d48fb72f[] = array( "match" => $v6cd9d4006f["match"], "class_obj" => $v6cd9d4006f["class_obj"], "template" => $pe7333513, "template_type" => $v3ba41b5a07, "template_params" => $v9e3513bc0e, "template_params_type" => $pc34fdd94, "line" => $v6cd9d4006f["line"], ); } } } return $v94d48fb72f; } public static function getFileRegions($pf3dc0762, $pacfef7d5 = false, $v08a1062039 = 0, $pf9851a9c = -1) { return self::getRegions( self::getFileContents($pf3dc0762), $pacfef7d5, $v08a1062039, $pf9851a9c); } public static function getRegions($v6490ea3a15, $pacfef7d5 = false, $v08a1062039 = 0, $pf9851a9c = -1) { $v86f703e78b = array(); if ($v6490ea3a15) { self::f0dbc620630($v6490ea3a15); $v0b196f001b = $pacfef7d5 && substr($pacfef7d5, 0, 1) != '$' ? '$' . $pacfef7d5 : $pacfef7d5; $pedde3449 = self::f9312178574($v6490ea3a15, "renderRegion", $v0b196f001b, $v08a1062039, $pf9851a9c); foreach ($pedde3449 as $v6cd9d4006f) { if (!$v6cd9d4006f["static"]) { if ($v6cd9d4006f["params"][0]["type"] == "variable") { $v9b9b8653bc = $v6cd9d4006f["params"][0]["referenced_value"]; $v3017a9dd59 = $v6cd9d4006f["params"][0]["referenced_type"]; } else { $v9b9b8653bc = $v6cd9d4006f["params"][0]["value"]; $v3017a9dd59 = $v6cd9d4006f["params"][0]["type"]; } $v86f703e78b[] = array( "match" => $v6cd9d4006f["match"], "class_obj" => $v6cd9d4006f["class_obj"], "region" => $v9b9b8653bc, "region_type" => $v3017a9dd59, "line" => $v6cd9d4006f["line"], ); } } } return $v86f703e78b; } public static function getFileRegionsBlocks($pf3dc0762, $pacfef7d5 = false) { return self::getRegionsBlocks( self::getFileContents($pf3dc0762), $pacfef7d5 ); } public static function getRegionsBlocks($v6490ea3a15, $pacfef7d5 = false) { $pf2e4821f = array(); if ($v6490ea3a15) { self::f0dbc620630($v6490ea3a15); preg_match_all('/(include_once|include|require_once|require)(\s*)\$(\w+)(\s*)->(\s*)getBlockPath(\s*)\((\s*)([^\),]*)(\s*),?(\s*)([^\)]*)(\s*)\)([^;]*);/iu', $v6490ea3a15, $pbae7526c, PREG_PATTERN_ORDER); $v4e2bc3d073 = $pbae7526c[8] ? $pbae7526c[8] : array(); $v53f9c31536 = $pbae7526c[11] ? $pbae7526c[11] : array(); $v705772ca7e = array(); $pc37695cb = count($v4e2bc3d073); for ($v43dd7d0051 = 0; $v43dd7d0051 < $pc37695cb; $v43dd7d0051++) { $v303bc2287d = trim($v4e2bc3d073[$v43dd7d0051]); $v93756c94b3 = trim($v53f9c31536[$v43dd7d0051]); $v705772ca7e[$v303bc2287d][] = $v93756c94b3; } $v0b196f001b = $pacfef7d5 && substr($pacfef7d5, 0, 1) != '$' ? '$' . $pacfef7d5 : $pacfef7d5; $pedde3449 = self::f9312178574($v6490ea3a15, array("addRegionBlock", "addRegionHtml"), $v0b196f001b, $v08a1062039, $pf9851a9c); $v3704c439d9 = array(); foreach ($pedde3449 as $v6cd9d4006f) { if (!$v6cd9d4006f["static"]) { $pcbe60070 = $v6cd9d4006f["method"] == "addRegionHtml"; if ($v6cd9d4006f["params"][0]["type"] == "variable") { $v9b9b8653bc = $v6cd9d4006f["params"][0]["referenced_value"]; $v3017a9dd59 = $v6cd9d4006f["params"][0]["referenced_type"]; } else { $v9b9b8653bc = $v6cd9d4006f["params"][0]["value"]; $v3017a9dd59 = $v6cd9d4006f["params"][0]["type"]; } if ($v6cd9d4006f["params"][1]["type"] == "variable") { $peebaaf55 = $v6cd9d4006f["params"][1]["referenced_value"]; $pa7fd620a = $v6cd9d4006f["params"][1]["referenced_type"]; } else { $peebaaf55 = $v6cd9d4006f["params"][1]["value"]; $pa7fd620a = $v6cd9d4006f["params"][1]["type"]; } if (!$pcbe60070) { $v7aeaf992f5 = trim( self::getVariableValueCode($peebaaf55, $pa7fd620a) ); $pd69fb7d0 = $v3704c439d9[$v7aeaf992f5] ? $v3704c439d9[$v7aeaf992f5] : 0; $v175e16d850 = $v705772ca7e[$v7aeaf992f5][$pd69fb7d0]; $v3704c439d9[$v7aeaf992f5] = $v705772ca7e[$v7aeaf992f5] && count($v705772ca7e[$v7aeaf992f5]) > $pd69fb7d0 + 1 ? $pd69fb7d0 + 1 : $pd69fb7d0; if ($v175e16d850) { $v76425220d5 = self::getArgumentType($v175e16d850); $v175e16d850 = self::prepareArgument($v175e16d850, $v76425220d5); } else { if ($v6cd9d4006f["params"][2]["type"] == "variable") { $v175e16d850 = $v6cd9d4006f["params"][2]["referenced_value"]; $v76425220d5 = $v6cd9d4006f["params"][2]["referenced_type"]; } else { $v175e16d850 = $v6cd9d4006f["params"][2]["value"]; $v76425220d5 = $v6cd9d4006f["params"][2]["type"]; } } } else $v175e16d850 = $v76425220d5 = null; $pf2e4821f[] = array( "match" => $v6cd9d4006f["match"], "method" => $v6cd9d4006f["method"], "is_html" => $pcbe60070, "class_obj" => $v6cd9d4006f["class_obj"], "region" => $v9b9b8653bc, "region_type" => $v3017a9dd59, "block" => $peebaaf55, "block_type" => $pa7fd620a, "block_project" => $v175e16d850, "block_project_type" => $v76425220d5, "line" => $v6cd9d4006f["line"], ); } } } return $pf2e4821f; } public static function getFileIncludes($pf3dc0762, $pc1ebfcb5 = true) { return self::getIncludes( self::getFileContents($pf3dc0762, $pc1ebfcb5) ); } public static function getIncludes($v6490ea3a15, $pc1ebfcb5 = true) { $pc06f1034 = array(); if ($v6490ea3a15) { self::f0dbc620630($v6490ea3a15); preg_match_all('/(include( |\$)|include_once( |\$)|require( |\$)|require_once( |\$))(\s*)([^;]+);/iu', $v6490ea3a15, $pbae7526c, PREG_PATTERN_ORDER); $v9fb2eada1a = $pbae7526c[0] ? $pbae7526c[0] : array(); $v4159504aa3 = $pbae7526c[1] ? $pbae7526c[1] : array(); $v57a9807e67 = $pbae7526c[7] ? $pbae7526c[7] : array(); $pc37695cb = count($v9fb2eada1a); for ($v43dd7d0051 = 0; $v43dd7d0051 < $pc37695cb; $v43dd7d0051++) { $pa32be502 = trim($v57a9807e67[$v43dd7d0051]); $v62cb335f98 = self::getArgumentType($pa32be502); $pa32be502 = self::prepareArgument($pa32be502, $v62cb335f98); if (!$pc1ebfcb5) { preg_match_all('/(include_once|include|require_once|require)(\s*)\$(\w+)(\s*)->(\s*)getBlockPath(\s*)\((\s*)([^\)]*)(\s*)\)([^;]*);/iu', $v9fb2eada1a[$v43dd7d0051], $v6107abf109, PREG_PATTERN_ORDER); if (isset($v6107abf109[8][0])) { continue 1; } } $pc06f1034[] = array( "match" => $v9fb2eada1a[$v43dd7d0051], "once" => strpos($v4159504aa3[$v43dd7d0051], "_once") > 0, "path" => $pa32be502, "path_type" => $v62cb335f98, ); } } return $pc06f1034; } public static function getFileIncludesBlock($pf3dc0762) { return self::getIncludesBlock( self::getFileContents($pf3dc0762) ); } public static function getIncludesBlock($v6490ea3a15) { $pc06f1034 = array(); if ($v6490ea3a15) { self::f0dbc620630($v6490ea3a15); preg_match_all('/(include_once|include|require_once|require)(\s*)\$(\w+)(\s*)->(\s*)getBlockPath(\s*)\((\s*)([^\),]*)(\s*),?(\s*)([^\)]*)(\s*)\)([^;]*);/iu', $v6490ea3a15, $pbae7526c, PREG_PATTERN_ORDER); $pad730ee8 = $pbae7526c[0] ? $pbae7526c[0] : array(); $v306d1e048e = $pbae7526c[1] ? $pbae7526c[1] : array(); $pe06b5f32 = $pbae7526c[8] ? $pbae7526c[8] : array(); $v90b50cf52d = $pbae7526c[11] ? $pbae7526c[11] : array(); preg_match_all('/(include_once|include|require_once|require)(\s*)\$(\w+)(\s*)->(\s*)getBlocksPath\(\)(\s*)\.(\s*)([^;]*)(\s*)([^;]*);/iu', $v6490ea3a15, $pbae7526c, PREG_PATTERN_ORDER); $peae05b1e = $pbae7526c[0] ? $pbae7526c[0] : array(); $pce5fe1bb = $pbae7526c[1] ? $pbae7526c[1] : array(); $pb16e5996 = $pbae7526c[8] ? $pbae7526c[8] : array(); $v9fb2eada1a = array_merge($pad730ee8, $peae05b1e); $v4159504aa3 = array_merge($v306d1e048e, $pce5fe1bb); $v57a9807e67 = array_merge($pe06b5f32, $pb16e5996); $pc37695cb = count($v9fb2eada1a); for ($v43dd7d0051 = 0; $v43dd7d0051 < $pc37695cb; $v43dd7d0051++) { $pa32be502 = trim($v57a9807e67[$v43dd7d0051]); $v62cb335f98 = self::getArgumentType($pa32be502); $pa32be502 = self::prepareArgument($pa32be502, $v62cb335f98); $v93756c94b3 = trim($v90b50cf52d[$v43dd7d0051]); $v55c04fed81 = self::getArgumentType($v93756c94b3); $v93756c94b3 = self::prepareArgument($v93756c94b3, $v55c04fed81); $pc06f1034[] = array( "match" => $v9fb2eada1a[$v43dd7d0051], "once" => strpos($v4159504aa3[$v43dd7d0051], "_once") > 0, "path" => $pa32be502, "path_type" => $v62cb335f98, "project" => $v93756c94b3, "project_type" => $v55c04fed81, ); } } return $pc06f1034; } public static function getFileParams($pf3dc0762, $pacfef7d5 = false, $v08a1062039 = 0, $pf9851a9c = -1) { return self::getParams( self::getFileContents($pf3dc0762), $pacfef7d5, $v08a1062039, $pf9851a9c); } public static function getParams($v6490ea3a15, $pacfef7d5 = false, $v08a1062039 = 0, $pf9851a9c = -1) { $v9b391a5b1f = array(); if ($v6490ea3a15) { self::f0dbc620630($v6490ea3a15); $v0b196f001b = $pacfef7d5 && substr($pacfef7d5, 0, 1) != '$' ? '$' . $pacfef7d5 : $pacfef7d5; $pedde3449 = self::f9312178574($v6490ea3a15, "getParam", $v0b196f001b, $v08a1062039, $pf9851a9c); foreach ($pedde3449 as $v6cd9d4006f) { if (!$v6cd9d4006f["static"]) { if ($v6cd9d4006f["params"][0]["type"] == "variable") { $v58b61e02bc = $v6cd9d4006f["params"][0]["referenced_value"]; $v9a52216fbf = $v6cd9d4006f["params"][0]["referenced_type"]; } else { $v58b61e02bc = $v6cd9d4006f["params"][0]["value"]; $v9a52216fbf = $v6cd9d4006f["params"][0]["type"]; } $v9b391a5b1f[] = array( "match" => $v6cd9d4006f["match"], "class_obj" => $v6cd9d4006f["class_obj"], "param" => $v58b61e02bc, "param_type" => $v9a52216fbf, "line" => $v6cd9d4006f["line"], ); } } } return $v9b391a5b1f; } public static function getFileParamsValues($pf3dc0762, $pacfef7d5 = false, $v08a1062039 = 0, $pf9851a9c = -1) { return self::getParamsValues( self::getFileContents($pf3dc0762), $pacfef7d5, $v08a1062039, $pf9851a9c); } public static function getParamsValues($v6490ea3a15, $pacfef7d5 = false, $v08a1062039 = 0, $pf9851a9c = -1) { $v9b391a5b1f = array(); if ($v6490ea3a15) { self::f0dbc620630($v6490ea3a15); $v0b196f001b = $pacfef7d5 && substr($pacfef7d5, 0, 1) != '$' ? '$' . $pacfef7d5 : $pacfef7d5; $pedde3449 = self::f9312178574($v6490ea3a15, "setParam", $v0b196f001b, $v08a1062039, $pf9851a9c); foreach ($pedde3449 as $v6cd9d4006f) { if (!$v6cd9d4006f["static"]) { if ($v6cd9d4006f["params"][0]["type"] == "variable") { $v58b61e02bc = $v6cd9d4006f["params"][0]["referenced_value"]; $v9a52216fbf = $v6cd9d4006f["params"][0]["referenced_type"]; } else { $v58b61e02bc = $v6cd9d4006f["params"][0]["value"]; $v9a52216fbf = $v6cd9d4006f["params"][0]["type"]; } if ($v6cd9d4006f["params"][1]["type"] == "variable") { $v67db1bd535 = $v6cd9d4006f["params"][1]["referenced_value"]; $pc3e857ed = $v6cd9d4006f["params"][1]["referenced_type"]; } else { $v67db1bd535 = $v6cd9d4006f["params"][1]["value"]; $pc3e857ed = $v6cd9d4006f["params"][1]["type"]; } $v9b391a5b1f[] = array( "match" => $v6cd9d4006f["match"], "class_obj" => $v6cd9d4006f["class_obj"], "param" => $v58b61e02bc, "param_type" => $v9a52216fbf, "value" => $v67db1bd535, "value_type" => $pc3e857ed, "line" => $v6cd9d4006f["line"], ); } } } return $v9b391a5b1f; } public static function getFileBlockParams($pf3dc0762) { return self::getBlockParams( self::getFileContents($pf3dc0762) ); } public static function getBlockParams($v6490ea3a15) { $v9b391a5b1f = array(); if ($v6490ea3a15) { self::f0dbc620630($v6490ea3a15); preg_match_all('/\$block_local_variables(\s*)\[([^\]]*)\]/iu', $v6490ea3a15, $pbae7526c, PREG_PATTERN_ORDER); $v9fb2eada1a = $pbae7526c[0] ? $pbae7526c[0] : array(); $v514eddb30d = $pbae7526c[2] ? $pbae7526c[2] : array(); $pc37695cb = count($v9fb2eada1a); for ($v43dd7d0051 = 0; $v43dd7d0051 < $pc37695cb; $v43dd7d0051++) { $v58b61e02bc = trim($v514eddb30d[$v43dd7d0051]); $v9a52216fbf = self::getArgumentType($v58b61e02bc); $v58b61e02bc = self::prepareArgument($v58b61e02bc, $v9a52216fbf); $v9b391a5b1f[] = array( "param" => $v58b61e02bc, "param_type" => $v9a52216fbf, ); } } return $v9b391a5b1f; } public static function getFileRegionBlockParamsValues($pf3dc0762) { return self::getRegionBlockParamsValues( self::getFileContents($pf3dc0762) ); } public static function getRegionBlockParamsValues($v6490ea3a15) { $v9b391a5b1f = array(); if ($v6490ea3a15) { self::f0dbc620630($v6490ea3a15); preg_match_all('/\$region_block_local_variables(\s*)\[([^\]]*)\](\s*)\[([^\]]*)\](\s*)\[([^\]]*)\](\s*)=(\s*)([^;]+);/iu', $v6490ea3a15, $pbae7526c, PREG_OFFSET_CAPTURE); $v9fb2eada1a = $pbae7526c[0] ? $pbae7526c[0] : array(); if ($v9fb2eada1a) { $v5eba9166ac = $pbae7526c[2] ? $pbae7526c[2] : array(); $pc91cbd5a = $pbae7526c[4] ? $pbae7526c[4] : array(); $v514eddb30d = $pbae7526c[6] ? $pbae7526c[6] : array(); $pb68aa01b = $pbae7526c[9] ? $pbae7526c[9] : array(); $pf2e4821f = self::getRegionsBlocks($v6490ea3a15); $pc37695cb = count($v9fb2eada1a); for ($v43dd7d0051 = 0; $v43dd7d0051 < $pc37695cb; $v43dd7d0051++) { $v9b9b8653bc = trim($v5eba9166ac[$v43dd7d0051][0]); $v3017a9dd59 = self::getArgumentType($v9b9b8653bc); $v9b9b8653bc = self::prepareArgument($v9b9b8653bc, $v3017a9dd59); $peebaaf55 = trim($pc91cbd5a[$v43dd7d0051][0]); $pa7fd620a = self::getArgumentType($peebaaf55); $peebaaf55 = self::prepareArgument($peebaaf55, $pa7fd620a); $v58b61e02bc = trim($v514eddb30d[$v43dd7d0051][0]); $v9a52216fbf = self::getArgumentType($v58b61e02bc); $v58b61e02bc = self::prepareArgument($v58b61e02bc, $v9a52216fbf); $v67db1bd535 = trim($pb68aa01b[$v43dd7d0051][0]); $pc3e857ed = self::getArgumentType($v67db1bd535); $v67db1bd535 = self::prepareArgument($v67db1bd535, $pc3e857ed); $v259d35fa15 = self::mf618223d31a9($v6490ea3a15, $v9fb2eada1a[$v43dd7d0051][1]); $v8a4df75785 = self::mb44c4fa1d7b4($pf2e4821f, $v9b9b8653bc, $v3017a9dd59, $peebaaf55, $pa7fd620a, $v259d35fa15); $v9b391a5b1f[] = array( "match" => $v9fb2eada1a[$v43dd7d0051][0], "region" => $v9b9b8653bc, "region_type" => $v3017a9dd59, "block" => $peebaaf55, "block_type" => $pa7fd620a, "param" => $v58b61e02bc, "param_type" => $v9a52216fbf, "value" => $v67db1bd535, "value_type" => $pc3e857ed, "region_block_index" => $v8a4df75785, "line" => $v259d35fa15, ); } } } return $v9b391a5b1f; } public static function setFileBlockSettingsPropertyValue($pf3dc0762, $v9947e6e9ec, $v1d88a54df5) { $v6490ea3a15 = self::getFileContents($pf3dc0762); $v5c1c342594 = self::setBlockSettingsPropertyValue($v6490ea3a15, $v9947e6e9ec, $v1d88a54df5); if ($v5c1c342594 && file_put_contents($pf3dc0762, $v6490ea3a15) === false) $v5c1c342594 = false; return $v5c1c342594; } public static function setBlockSettingsPropertyValue(&$v6490ea3a15, $v9947e6e9ec, $v1d88a54df5) { return self::setMethodParamsFromContent($v6490ea3a15, $v9947e6e9ec, $v1d88a54df5, "createBlock", false, 0, 2, -1); } public static function getFileCreateBlockParams($pf3dc0762, $pacfef7d5 = false, $v08a1062039 = 0, $pf9851a9c = -1) { return self::getCreateBlockParams( self::getFileContents($pf3dc0762), $pacfef7d5, $v08a1062039, $pf9851a9c); } public static function getCreateBlockParams($v6490ea3a15, $pacfef7d5 = false, $v08a1062039 = 0, $pf9851a9c = -1) { $v9b391a5b1f = array(); self::f0dbc620630($v6490ea3a15); $v0b196f001b = $pacfef7d5 && substr($pacfef7d5, 0, 1) != '$' ? '$' . $pacfef7d5 : $pacfef7d5; $pedde3449 = self::f9312178574($v6490ea3a15, "createBlock", $v0b196f001b, $v08a1062039, $pf9851a9c); foreach ($pedde3449 as $v6cd9d4006f) { if (!$v6cd9d4006f["static"]) { if ($v6cd9d4006f["params"][0]["type"] == "variable") { $pc8b88eb4 = $v6cd9d4006f["params"][0]["referenced_value"]; $v3ee11d6af6 = $v6cd9d4006f["params"][0]["referenced_type"]; } else { $pc8b88eb4 = $v6cd9d4006f["params"][0]["value"]; $v3ee11d6af6 = $v6cd9d4006f["params"][0]["type"]; } if ($v6cd9d4006f["params"][1]["type"] == "variable") { $peebaaf55 = $v6cd9d4006f["params"][1]["referenced_value"]; $pa7fd620a = $v6cd9d4006f["params"][1]["referenced_type"]; } else { $peebaaf55 = $v6cd9d4006f["params"][1]["value"]; $pa7fd620a = $v6cd9d4006f["params"][1]["type"]; } if ($v6cd9d4006f["params"][2]["type"] == "variable") { $pc01d97db = $v6cd9d4006f["params"][2]["referenced_value"]; $pedd4e25d = $v6cd9d4006f["params"][2]["referenced_type"]; } else { $pc01d97db = $v6cd9d4006f["params"][2]["value"]; $pedd4e25d = $v6cd9d4006f["params"][2]["type"]; } $v9b391a5b1f[] = array( "match" => $v6cd9d4006f["match"], "class_obj" => $v6cd9d4006f["class_obj"], "module" => $pc8b88eb4, "module_type" => $v3ee11d6af6, "block" => $peebaaf55, "block_type" => $pa7fd620a, "block_settings" => $pc01d97db, "block_settings_type" => $pedd4e25d, "line" => $v6cd9d4006f["line"], ); } } return $v9b391a5b1f; } public static function getFileIncludeJoinPoints($pf3dc0762, $pacfef7d5 = false, $v08a1062039 = 0, $pf9851a9c = -1) { return self::getIncludeJoinPoints( self::getFileContents($pf3dc0762), $pacfef7d5, $v08a1062039, $pf9851a9c); } public static function getIncludeJoinPoints($v6490ea3a15, $pacfef7d5 = false, $v08a1062039 = 0, $pf9851a9c = -1) { $pf615c15a = array(); self::f0dbc620630($v6490ea3a15); $v0b196f001b = $pacfef7d5 && substr($pacfef7d5, 0, 1) != '$' ? '$' . $pacfef7d5 : $pacfef7d5; $pedde3449 = self::f9312178574($v6490ea3a15, array("includeJoinPoint", "includeStatusJoinPoint"), $v0b196f001b, $v08a1062039, $pf9851a9c); foreach ($pedde3449 as $v6cd9d4006f) { if (!$v6cd9d4006f["static"]) { if ($v6cd9d4006f["params"][0]["type"] == "variable") { $v34bca6a112 = $v6cd9d4006f["params"][0]["referenced_value"]; $v50e99cdef4 = $v6cd9d4006f["params"][0]["referenced_type"]; } else { $v34bca6a112 = $v6cd9d4006f["params"][0]["value"]; $v50e99cdef4 = $v6cd9d4006f["params"][0]["type"]; } if ($v6cd9d4006f["params"][1]["type"] == "variable") { $v77784c4ecd = $v6cd9d4006f["params"][1]["referenced_value"]; $v09f1e60981 = $v6cd9d4006f["params"][1]["referenced_type"]; } else { $v77784c4ecd = $v6cd9d4006f["params"][1]["value"]; $v09f1e60981 = $v6cd9d4006f["params"][1]["type"]; } if ($v6cd9d4006f["params"][2]["type"] == "variable") { $v53c74ba347 = $v6cd9d4006f["params"][2]["referenced_value"]; $v1b806aaa51 = $v6cd9d4006f["params"][2]["referenced_type"]; } else { $v53c74ba347 = $v6cd9d4006f["params"][2]["value"]; $v1b806aaa51 = $v6cd9d4006f["params"][2]["type"]; } $pf615c15a[] = array( "match" => $v6cd9d4006f["match"], "class_obj" => $v6cd9d4006f["class_obj"], "method" => $v6cd9d4006f["method"], "method_type" => "string", "join_point_name" => $v34bca6a112, "join_point_name_type" => $v50e99cdef4, "join_point_settings" => $v77784c4ecd, "join_point_settings_type" => $v09f1e60981, "join_point_description" => $v53c74ba347, "join_point_description_type" => $v1b806aaa51, "line" => $v6cd9d4006f["line"], ); } } return $pf615c15a; } public static function getFileAddBlockJoinPoints($pf3dc0762, $pacfef7d5 = false, $v08a1062039 = 0, $pf9851a9c = -1) { return self::getAddBlockJoinPoints( self::getFileContents($pf3dc0762), $pacfef7d5, $v08a1062039, $pf9851a9c); } public static function getAddBlockJoinPoints($v6490ea3a15, $pacfef7d5 = false, $v08a1062039 = 0, $pf9851a9c = -1) { $pf615c15a = array(); self::f0dbc620630($v6490ea3a15); $v0b196f001b = $pacfef7d5 && substr($pacfef7d5, 0, 1) != '$' ? '$' . $pacfef7d5 : $pacfef7d5; $pedde3449 = self::f9312178574($v6490ea3a15, "addBlockJoinPoint", $v0b196f001b, $v08a1062039, $pf9851a9c); foreach ($pedde3449 as $v6cd9d4006f) { if (!$v6cd9d4006f["static"]) { if ($v6cd9d4006f["params"][0]["type"] == "variable") { $peebaaf55 = $v6cd9d4006f["params"][0]["referenced_value"]; $pa7fd620a = $v6cd9d4006f["params"][0]["referenced_type"]; } else { $peebaaf55 = $v6cd9d4006f["params"][0]["value"]; $pa7fd620a = $v6cd9d4006f["params"][0]["type"]; } if ($v6cd9d4006f["params"][1]["type"] == "variable") { $v34bca6a112 = $v6cd9d4006f["params"][1]["referenced_value"]; $v50e99cdef4 = $v6cd9d4006f["params"][1]["referenced_type"]; } else { $v34bca6a112 = $v6cd9d4006f["params"][1]["value"]; $v50e99cdef4 = $v6cd9d4006f["params"][1]["type"]; } if ($v6cd9d4006f["params"][2]["type"] == "variable") { $v77784c4ecd = $v6cd9d4006f["params"][2]["referenced_value"]; $v09f1e60981 = $v6cd9d4006f["params"][2]["referenced_type"]; } else { $v77784c4ecd = $v6cd9d4006f["params"][2]["value"]; $v09f1e60981 = $v6cd9d4006f["params"][2]["type"]; } $pf615c15a[] = array( "match" => $v6cd9d4006f["match"], "class_obj" => $v6cd9d4006f["class_obj"], "method" => $v6cd9d4006f["method"], "method_type" => "string", "block" => $peebaaf55, "block_type" => $pa7fd620a, "join_point_name" => $v34bca6a112, "join_point_name_type" => $v50e99cdef4, "join_point_settings" => $v77784c4ecd, "join_point_settings_type" => $v09f1e60981, "line" => $v6cd9d4006f["line"], ); } } return $pf615c15a; } public static function getFileAddRegionBlockJoinPoints($pf3dc0762, $pacfef7d5 = false, $v08a1062039 = 0, $pf9851a9c = -1) { return self::getAddRegionBlockJoinPoints( self::getFileContents($pf3dc0762), $pacfef7d5, $v08a1062039, $pf9851a9c); } public static function getAddRegionBlockJoinPoints($v6490ea3a15, $pacfef7d5 = false, $v08a1062039 = 0, $pf9851a9c = -1) { $pf615c15a = array(); self::f0dbc620630($v6490ea3a15); $v0b196f001b = $pacfef7d5 && substr($pacfef7d5, 0, 1) != '$' ? '$' . $pacfef7d5 : $pacfef7d5; $pedde3449 = self::f9312178574($v6490ea3a15, "addRegionBlockJoinPoint", $v0b196f001b, $v08a1062039, $pf9851a9c); if ($pedde3449) { $pf2e4821f = self::getRegionsBlocks($v6490ea3a15); foreach ($pedde3449 as $v6cd9d4006f) { if (!$v6cd9d4006f["static"]) { if ($v6cd9d4006f["params"][0]["type"] == "variable") { $v9b9b8653bc = $v6cd9d4006f["params"][0]["referenced_value"]; $v3017a9dd59 = $v6cd9d4006f["params"][0]["referenced_type"]; } else { $v9b9b8653bc = $v6cd9d4006f["params"][0]["value"]; $v3017a9dd59 = $v6cd9d4006f["params"][0]["type"]; } if ($v6cd9d4006f["params"][1]["type"] == "variable") { $peebaaf55 = $v6cd9d4006f["params"][1]["referenced_value"]; $pa7fd620a = $v6cd9d4006f["params"][1]["referenced_type"]; } else { $peebaaf55 = $v6cd9d4006f["params"][1]["value"]; $pa7fd620a = $v6cd9d4006f["params"][1]["type"]; } if ($v6cd9d4006f["params"][2]["type"] == "variable") { $v34bca6a112 = $v6cd9d4006f["params"][2]["referenced_value"]; $v50e99cdef4 = $v6cd9d4006f["params"][2]["referenced_type"]; } else { $v34bca6a112 = $v6cd9d4006f["params"][2]["value"]; $v50e99cdef4 = $v6cd9d4006f["params"][2]["type"]; } if ($v6cd9d4006f["params"][3]["type"] == "variable") { $v77784c4ecd = $v6cd9d4006f["params"][3]["referenced_value"]; $v09f1e60981 = $v6cd9d4006f["params"][3]["referenced_type"]; } else { $v77784c4ecd = $v6cd9d4006f["params"][3]["value"]; $v09f1e60981 = $v6cd9d4006f["params"][3]["type"]; } $v8a4df75785 = self::mb44c4fa1d7b4($pf2e4821f, $v9b9b8653bc, $v3017a9dd59, $peebaaf55, $pa7fd620a, $v6cd9d4006f["line"]); $pf615c15a[] = array( "match" => $v6cd9d4006f["match"], "class_obj" => $v6cd9d4006f["class_obj"], "method" => $v6cd9d4006f["method"], "method_type" => "string", "region" => $v9b9b8653bc, "region_type" => $v3017a9dd59, "block" => $peebaaf55, "block_type" => $pa7fd620a, "join_point_name" => $v34bca6a112, "join_point_name_type" => $v50e99cdef4, "join_point_settings" => $v77784c4ecd, "join_point_settings_type" => $v09f1e60981, "region_block_index" => $v8a4df75785, "line" => $v6cd9d4006f["line"], ); } } } return $pf615c15a; } public static function getFileBlockLocalJoinPoints($pf3dc0762) { return self::getBlockLocalJoinPoints( self::getFileContents($pf3dc0762) ); } public static function getBlockLocalJoinPoints($v6490ea3a15) { $pf615c15a = array(); if ($v6490ea3a15) { self::f0dbc620630($v6490ea3a15); preg_match_all('/\$block_local_join_points(\s*)\[([^\]]*)\](\s*)\[([^\]]*)\]/iu', $v6490ea3a15, $pbae7526c, PREG_OFFSET_CAPTURE); $v9fb2eada1a = $pbae7526c[0] ? $pbae7526c[0] : array(); $v9158f5ed68 = $pbae7526c[2] ? $pbae7526c[2] : array(); $pd162e32e = $pbae7526c[4] ? $pbae7526c[4] : array(); $pc37695cb = count($v9fb2eada1a); for ($v43dd7d0051 = 0; $v43dd7d0051 < $pc37695cb; $v43dd7d0051++) { $peebaaf55 = trim($v9158f5ed68[$v43dd7d0051][0]); $pa7fd620a = self::getArgumentType($peebaaf55); $peebaaf55 = self::prepareArgument($peebaaf55, $pa7fd620a); self::f9bfd754e94($v6490ea3a15, $peebaaf55, $pa7fd620a, $v9158f5ed68[$v43dd7d0051][1]); $v34bca6a112 = trim($pd162e32e[$v43dd7d0051][0]); $v50e99cdef4 = self::getArgumentType($v34bca6a112); $v34bca6a112 = self::prepareArgument($v34bca6a112, $v50e99cdef4); $pf615c15a[] = array( "block" => $peebaaf55, "block_type" => $pa7fd620a, "join_point_name" => $v34bca6a112, "join_point_name_type" => $v50e99cdef4, ); } } return $pf615c15a; } private static function f0dbc620630(&$v6490ea3a15) { $v6490ea3a15 = PHPCodePrintingHandler::getCodeWithoutComments($v6490ea3a15); } private static function mb44c4fa1d7b4($pf2e4821f, $v9b9b8653bc, $v3017a9dd59, $peebaaf55, $pa7fd620a, $v259d35fa15) { $v8a4df75785 = 0; if ($pf2e4821f) foreach ($pf2e4821f as $pd06bdde3) { if ($pd06bdde3["region"] == $v9b9b8653bc && $pd06bdde3["region_type"] == $v3017a9dd59 && $pd06bdde3["block"] == $peebaaf55 && $pd06bdde3["block_type"] == $pa7fd620a) { if ($pd06bdde3["line"] > $v259d35fa15) return $v8a4df75785; $v8a4df75785++; } } return $v8a4df75785; } private static function mf618223d31a9($v6490ea3a15, $pac65f06f) { $v259d35fa15 = 1; $pbd1bc7b0 = -1; do { $pbd1bc7b0 = strpos($v6490ea3a15, "\n", $pbd1bc7b0 + 1); if ($pbd1bc7b0 > $pac65f06f) break; $v259d35fa15++; } while ($pbd1bc7b0 !== false); return $v259d35fa15; } public static function setMethodParamsFromContent(&$v6490ea3a15, $v9947e6e9ec, $v1d88a54df5, $v28b9855350, $v0b196f001b = false, $pb0ae70c0 = 0, $v578470a077 = 0, $pf9851a9c = -1) { $v5c1c342594 = false; $v9947e6e9ec = preg_replace("/\/+/", "/", $v9947e6e9ec); $v9947e6e9ec = preg_replace("/^[\s\/]*/", "", $v9947e6e9ec); $v9947e6e9ec = preg_replace("/[\s\/]*$/", "", $v9947e6e9ec); if ($v9947e6e9ec) { $v74411a89da = '<? $aux = ' . var_export($v1d88a54df5, true) . '; ?>'; $v04a43f9b8a = self::f45be6a1435($v74411a89da); $v643b49a734 = $v04a43f9b8a && $v04a43f9b8a[0] && strtolower($v04a43f9b8a[0]->getType()) == "expr_assign" && $v04a43f9b8a[0]->var ? $v04a43f9b8a[0]->expr : null; if (is_object($v643b49a734)) { $v6306fea85d = explode("/", $v9947e6e9ec); $v793f92423d = self::f45be6a1435($v6490ea3a15); $v052656e632 = new PHPParserPrettyPrinter(); $v5c1c342594 = self::f997aaa8caa($v052656e632, $v793f92423d, $v6306fea85d, $v643b49a734, "createBlock", false, 0, 2, -1); if ($v5c1c342594) { $pb3fbfea9 = new PhpParser\PrettyPrinter\Standard(); $v6f3e16f956 = $pb3fbfea9->prettyPrint($v793f92423d); if (substr(trim($v6490ea3a15), 0, 2) == "<?" && substr(trim($v6f3e16f956), 0, 2) != "<?") $v6f3e16f956 = "<?php\n" . $v6f3e16f956; if (substr(trim($v6490ea3a15), -2) == "?>" && substr(trim($v6f3e16f956), -2) != "?>") $v6f3e16f956 = trim($v6f3e16f956) . "\n?>"; $pbfc9d574 = new PHPCodeBeautifier(); $v6f3e16f956 = $pbfc9d574->beautifyCode($v6f3e16f956); $v6f3e16f956 = TextSanitizer::replaceEscapedEndLinesInsideOfPHPDoubleQuotesInHtmlCode($v6f3e16f956); $v6490ea3a15 = $v6f3e16f956; } } } return $v5c1c342594; } private static function f9312178574($v6490ea3a15, $v28b9855350, $v0b196f001b = false, $v08a1062039 = 0, $pf9851a9c = -1) { $v793f92423d = self::f45be6a1435($v6490ea3a15); $v052656e632 = new PHPParserPrettyPrinter(); $v9b391a5b1f = self::f2fd3edac74($v052656e632, $v793f92423d, $v28b9855350, $v0b196f001b, $v08a1062039, $pf9851a9c); return $v9b391a5b1f; } private static function f45be6a1435($v6490ea3a15) { $pf1d2e1d9 = new PhpParser\Parser\Php5(new PhpParser\Lexer\Emulative); $v3c085bda5f = new PhpParser\Parser\Php7(new PhpParser\Lexer\Emulative); $v5f04ef1cc1 = new PhpParser\Parser\Multiple(array($pf1d2e1d9, $v3c085bda5f)); $v6490ea3a15 = TextSanitizer::replaceIfNotEscaped('\n', '\\\n', $v6490ea3a15); $v793f92423d = $v5f04ef1cc1->parse($v6490ea3a15); return $v793f92423d; } private static function f2fd3edac74($v052656e632, $v793f92423d, $v28b9855350, $v0b196f001b = false, $v08a1062039 = 0, $pf9851a9c = -1, $v54d2a63d3d = null) { $pedde3449 = array(); $v28b9855350 = is_array($v28b9855350) ? $v28b9855350 : array($v28b9855350); foreach ($v28b9855350 as $pd69fb7d0 => $v603bd47baf) $v28b9855350[$pd69fb7d0] = strtolower($v603bd47baf); $v244867fd7e = $v793f92423d ? count($v793f92423d) : 0; $v54d2a63d3d = $v54d2a63d3d ? $v54d2a63d3d : array(); for ($v43dd7d0051 = 0; $v43dd7d0051 < $v244867fd7e; $v43dd7d0051++) { $v5faa4b8a01 = $v793f92423d[$v43dd7d0051]; $pe83cda0c = strtolower($v5faa4b8a01->getType()); if ($pe83cda0c == "expr_assign") { $v9b35c85277 = $v052656e632->prettyPrintExpr($v5faa4b8a01->var); $v1b1754dafa = self::getArgumentType($v9b35c85277); if ($v1b1754dafa == "variable") $v54d2a63d3d[] = $v5faa4b8a01; } } for ($v43dd7d0051 = 0; $v43dd7d0051 < $v244867fd7e; $v43dd7d0051++) { $v5faa4b8a01 = $v793f92423d[$v43dd7d0051]; $pe83cda0c = strtolower($v5faa4b8a01->getType()); if ($pe83cda0c == "expr_assign" || $pe83cda0c == "expr_assignop_concat" || $pe83cda0c == "expr_assignop_plus" || $pe83cda0c == "expr_assignop_minus") { $v5faa4b8a01 = $v5faa4b8a01->expr; $pe83cda0c = strtolower($v5faa4b8a01->getType()); } else if ($pe83cda0c == "stmt_echo") { $v5faa4b8a01 = $v5faa4b8a01->exprs[0]; $pe83cda0c = strtolower($v5faa4b8a01->getType()); } if ($pe83cda0c == "expr_methodcall" || $pe83cda0c == "expr_staticcall" || $pe83cda0c == "expr_funccall") { $v24b0e52635 = self::f539c98cd94($v052656e632, $v5faa4b8a01); if ($v24b0e52635 && is_string($v24b0e52635) && in_array(strtolower($v24b0e52635), $v28b9855350)) { $v972f1a5c2b = null; if ($v5faa4b8a01->var) $v972f1a5c2b = $v052656e632->prettyPrintExpr($v5faa4b8a01->var); else $v972f1a5c2b = self::f539c98cd94($v052656e632, $v5faa4b8a01->class); if (!$v0b196f001b || $v0b196f001b == $v972f1a5c2b) { $pe896c6c8 = $v5faa4b8a01->args; $v9b391a5b1f = array(); if (is_array($pe896c6c8)) { foreach ($pe896c6c8 as $pd69fb7d0 => $v0f24a53653) { $pa6f25fee = strtolower($v0f24a53653->value->getType()); $v1cfba8c105 = $pa44c1d0e = $pe8072d24 = null; if ($pa6f25fee == "expr_assign" || $pa6f25fee == "expr_assignop_concat" || $pa6f25fee == "expr_assignop_plus" || $pa6f25fee == "expr_assignop_minus") { $v1cfba8c105 = $v0f24a53653->value->var->name; $v0f24a53653->value = $v0f24a53653->value->expr; } if ($v0f24a53653->value->items) { $v67db1bd535 = self::mb2dd5458eea8($v052656e632, $v0f24a53653->value->items); $pc3e857ed = "array"; } else { $v67db1bd535 = $v052656e632->pArg($v0f24a53653); $pc3e857ed = self::getArgumentType($v67db1bd535); $v67db1bd535 = self::prepareArgument($v67db1bd535, $pc3e857ed); if ($pc3e857ed == "variable") { $pa44c1d0e = $v67db1bd535; $pe8072d24 = $pc3e857ed; self::f9f76fee7ea($v052656e632, $v54d2a63d3d, $pa44c1d0e, $pe8072d24); } } $v58b61e02bc = array( "value" => $v67db1bd535, "type" => $pc3e857ed, ); if (isset($pa44c1d0e)) { $v58b61e02bc["referenced_value"] = $pa44c1d0e; $v58b61e02bc["referenced_type"] = $pe8072d24; } if ($v1cfba8c105) $v58b61e02bc["var"] = $v1cfba8c105; $v9b391a5b1f[] = $v58b61e02bc; } } } $v6cd9d4006f = array( "match" => $v052656e632->prettyPrintExpr($v5faa4b8a01), "method" => $v24b0e52635, "params" => $v9b391a5b1f, "line" => $v5faa4b8a01->getAttribute("startLine"), ); if ($v972f1a5c2b) { $v6cd9d4006f["class_obj"] = $v972f1a5c2b; $v6cd9d4006f["static"] = $pe83cda0c == "expr_staticcall"; } $pedde3449[] = $v6cd9d4006f; } } if ($v08a1062039 > 0 && $v08a1062039 <= count($pedde3449)) break; else if ($pf9851a9c <= -1 || $pf9851a9c > 0) { $pcc8d256f = $v5faa4b8a01->stmts ? array($v5faa4b8a01) : array(); if ($pe83cda0c == "stmt_if") { if ($v5faa4b8a01->elseifs) $pcc8d256f = array_merge($pcc8d256f, $v5faa4b8a01->elseifs); if ($v5faa4b8a01->else->stmts) $pcc8d256f[] = $v5faa4b8a01->else; } else if ($pe83cda0c == "stmt_switch" && $v5faa4b8a01->cases) $pcc8d256f = array_merge($pcc8d256f, $v5faa4b8a01->cases); else if ($pe83cda0c == "stmt_trycatch" && $v5faa4b8a01->catches) $pcc8d256f = array_merge($pcc8d256f, $v5faa4b8a01->catches); else if ($pe83cda0c == "expr_binaryop_concat" && ($v5faa4b8a01->left || $v5faa4b8a01->right)) { $v5faa4b8a01->stmts = array(); if ($v5faa4b8a01->left) $v5faa4b8a01->stmts[] = $v5faa4b8a01->left; if ($v5faa4b8a01->right) $v5faa4b8a01->stmts[] = $v5faa4b8a01->right; $pcc8d256f[] = $v5faa4b8a01; } else if ($pe83cda0c == "expr_methodcall" || $pe83cda0c == "expr_staticcall" || $pe83cda0c == "expr_funccall") { $v24b0e52635 = self::f539c98cd94($v052656e632, $v5faa4b8a01); if ($v24b0e52635 && is_string($v24b0e52635) && !in_array(strtolower($v24b0e52635), $v28b9855350) && $v5faa4b8a01->args) { $v5faa4b8a01->stmts = array(); foreach ($v5faa4b8a01->args as $pea70e132) if ($pea70e132->value) $v5faa4b8a01->stmts[] = $pea70e132->value; $pcc8d256f[] = $v5faa4b8a01; } } if ($pcc8d256f) { $pd062707d = $v08a1062039 > 0 ? $v08a1062039 - count($pedde3449) : 0; $v286f5d635f = $pf9851a9c > 0 ? $pf9851a9c - 1 : $pf9851a9c; $pc37695cb = count($pcc8d256f); for ($v9d27441e80 = 0; $v9d27441e80 < $pc37695cb; $v9d27441e80++) if ($pcc8d256f[$v9d27441e80]->stmts) { $pf72c1d58 = self::f2fd3edac74($v052656e632, $pcc8d256f[$v9d27441e80]->stmts, $v28b9855350, $v0b196f001b, $pd062707d, $v286f5d635f, $v54d2a63d3d); $pedde3449 = array_merge($pedde3449, $pf72c1d58); $pd062707d = $v08a1062039 > 0 ? $pd062707d - count($pf72c1d58) : 0; if ($v08a1062039 > 0 && $pd062707d <= 0) break; } } } } return $pedde3449; } private static function f997aaa8caa($v052656e632, $v793f92423d, $v6306fea85d, $v643b49a734, $v28b9855350, $v0b196f001b = false, $pb0ae70c0 = 0, $v578470a077 = 0, $pf9851a9c = -1, $v54d2a63d3d = null, $v6beeaf88e6 = false) { $v5c1c342594 = false; $v28b9855350 = is_array($v28b9855350) ? $v28b9855350 : array($v28b9855350); foreach ($v28b9855350 as $pd69fb7d0 => $v603bd47baf) $v28b9855350[$pd69fb7d0] = strtolower($v603bd47baf); $v244867fd7e = $v793f92423d ? count($v793f92423d) : 0; $v54d2a63d3d = $v54d2a63d3d ? $v54d2a63d3d : array(); for ($v43dd7d0051 = 0; $v43dd7d0051 < $v244867fd7e; $v43dd7d0051++) { $v5faa4b8a01 = &$v793f92423d[$v43dd7d0051]; $pe83cda0c = strtolower($v5faa4b8a01->getType()); if ($pe83cda0c == "expr_assign") { $v9b35c85277 = $v052656e632->prettyPrintExpr($v5faa4b8a01->var); $v1b1754dafa = self::getArgumentType($v9b35c85277); if ($v1b1754dafa == "variable") $v54d2a63d3d[] = $v5faa4b8a01; } } for ($v43dd7d0051 = 0; $v43dd7d0051 < $v244867fd7e; $v43dd7d0051++) { $v5faa4b8a01 = &$v793f92423d[$v43dd7d0051]; $pe83cda0c = strtolower($v5faa4b8a01->getType()); if ($pe83cda0c == "expr_assign" || $pe83cda0c == "expr_assignop_concat" || $pe83cda0c == "expr_assignop_plus" || $pe83cda0c == "expr_assignop_minus") { $v5faa4b8a01 = &$v5faa4b8a01->expr; $pe83cda0c = strtolower($v5faa4b8a01->getType()); } else if ($pe83cda0c == "stmt_echo") { $v5faa4b8a01 = &$v5faa4b8a01->exprs[0]; $pe83cda0c = strtolower($v5faa4b8a01->getType()); } if ($pe83cda0c == "expr_methodcall" || $pe83cda0c == "expr_staticcall" || $pe83cda0c == "expr_funccall") { $v24b0e52635 = self::f539c98cd94($v052656e632, $v5faa4b8a01); if ($v24b0e52635 && is_string($v24b0e52635) && in_array(strtolower($v24b0e52635), $v28b9855350)) { $v972f1a5c2b = null; if ($v5faa4b8a01->var) $v972f1a5c2b = $v052656e632->prettyPrintExpr($v5faa4b8a01->var); else $v972f1a5c2b = self::f539c98cd94($v052656e632, $v5faa4b8a01->class); if (!$v0b196f001b || $v0b196f001b == $v972f1a5c2b) { if ($pb0ae70c0 <= 0) { $v6beeaf88e6 = true; $pe896c6c8 = $v5faa4b8a01->args; if (is_array($pe896c6c8)) { $v0f24a53653 = $pe896c6c8[$v578470a077]; if ($v0f24a53653) { $pa6f25fee = strtolower($v0f24a53653->value->getType()); $v1cfba8c105 = $pa44c1d0e = $pe8072d24 = null; if ($pa6f25fee == "expr_assign" || $pa6f25fee == "expr_assignop_concat" || $pa6f25fee == "expr_assignop_plus" || $pa6f25fee == "expr_assignop_minus") { $v5c1c342594 = self::f33bd26cab1($v052656e632, $v54d2a63d3d, $v6306fea85d, $v643b49a734, $v0f24a53653->value->expr); } else { $v5c1c342594 = self::f33bd26cab1($v052656e632, $v54d2a63d3d, $v6306fea85d, $v643b49a734, $v0f24a53653->value); } if ($v5c1c342594) $v5faa4b8a01->args[$v578470a077] = $v0f24a53653; } } break; } $pb0ae70c0--; } } } if ($v6beeaf88e6) break; else if ($pf9851a9c <= -1 || $pf9851a9c > 0) { $pcc8d256f = $v5faa4b8a01->stmts ? array($v5faa4b8a01) : array(); if ($pe83cda0c == "stmt_if") { if ($v5faa4b8a01->elseifs) { foreach ($v5faa4b8a01->elseifs as $pd69fb7d0 => $v7c627adb6d) $pcc8d256f[] = &$v5faa4b8a01->elseifs[$pd69fb7d0]; } if ($v5faa4b8a01->else->stmts) $pcc8d256f[] = &$v5faa4b8a01->else; } else if ($pe83cda0c == "stmt_switch" && $v5faa4b8a01->cases) { foreach ($v5faa4b8a01->cases as $pd69fb7d0 => $v7c627adb6d) $pcc8d256f[] = &$v5faa4b8a01->cases[$pd69fb7d0]; } else if ($pe83cda0c == "stmt_trycatch" && $v5faa4b8a01->catches) { foreach ($v5faa4b8a01->catches as $pd69fb7d0 => $v7c627adb6d) $pcc8d256f[] = &$v5faa4b8a01->catches[$pd69fb7d0]; } else if ($pe83cda0c == "expr_binaryop_concat" && ($v5faa4b8a01->left || $v5faa4b8a01->right)) { $v28e481ecbc = new stdClass(); $v28e481ecbc->stmts = array(); if ($v28e481ecbc->left) $v28e481ecbc->stmts[] = &$v5faa4b8a01->left; if ($v28e481ecbc->right) $v28e481ecbc->stmts[] = &$v5faa4b8a01->right; $pcc8d256f[] = $v28e481ecbc; } else if ($pe83cda0c == "expr_methodcall" || $pe83cda0c == "expr_staticcall" || $pe83cda0c == "expr_funccall") { $v24b0e52635 = self::f539c98cd94($v052656e632, $v5faa4b8a01); if ($v24b0e52635 && is_string($v24b0e52635) && !in_array(strtolower($v24b0e52635), $v28b9855350) && $v5faa4b8a01->args) { $v28e481ecbc = new stdClass(); $v28e481ecbc->stmts = array(); foreach ($v5faa4b8a01->args as $pea70e132) if ($pea70e132->value) $v28e481ecbc->stmts[] = &$pea70e132->value; $pcc8d256f[] = $v28e481ecbc; } } if ($pcc8d256f) { $v286f5d635f = $pf9851a9c > 0 ? $pf9851a9c - 1 : $pf9851a9c; $pc37695cb = count($pcc8d256f); for ($v9d27441e80 = 0; $v9d27441e80 < $pc37695cb; $v9d27441e80++) if ($pcc8d256f[$v9d27441e80]->stmts) { $v5c1c342594 = self::f997aaa8caa($v052656e632, $pcc8d256f[$v9d27441e80]->stmts, $v6306fea85d, $v643b49a734, $v28b9855350, $v0b196f001b, $pb0ae70c0, $v578470a077, $v286f5d635f, $v54d2a63d3d, $v6beeaf88e6); if ($v6beeaf88e6) break; } } } } return $v5c1c342594; } private static function f33bd26cab1($v052656e632, &$v54d2a63d3d, $v6306fea85d, $v643b49a734, &$v3d0905c10c) { $v5c1c342594 = false; $v67db1bd535 = $v052656e632->prettyPrintExpr($v3d0905c10c); $pc3e857ed = self::getArgumentType($v67db1bd535); $v67db1bd535 = self::prepareArgument($v67db1bd535, $pc3e857ed); if ($v3d0905c10c->items) { $v5c1c342594 = self::mff8fad625e0e($v052656e632, $v3d0905c10c->items, $v6306fea85d, $v643b49a734); } else if ($pc3e857ed == "variable") { $v5c1c342594 = self::f0a961fb1f4($v052656e632, $v54d2a63d3d, $v6306fea85d, $v643b49a734, $v67db1bd535, $pc3e857ed); } else if (count($v6306fea85d) == 1 && empty(strlen($v6306fea85d[0]))) { $pec9beadb = $v3d0905c10c->getAttributes(); $v3d0905c10c = $v643b49a734; if ($pec9beadb) foreach ($pec9beadb as $pe5c5e2fe => $v956913c90f) $v3d0905c10c->setAttribute($pe5c5e2fe, $v956913c90f); $v5c1c342594 = true; } return $v5c1c342594; } private static function f539c98cd94($v052656e632, $v6694236c2c) { if (is_object($v6694236c2c)) { if (is_object($v6694236c2c->name) && strtolower($v6694236c2c->name->getType()) == "name") return $v052656e632->pName($v6694236c2c->name); if (is_array($v6694236c2c->parts)) return $v052656e632->pName($v6694236c2c); return $v6694236c2c->name; } return $v6694236c2c; } private static function f9f76fee7ea($v052656e632, $v793f92423d, &$v847e7d0a83, &$v7f2aac9119) { if ($v7f2aac9119 == "variable") { $pc37695cb = count($v793f92423d); for ($v43dd7d0051 = 0; $v43dd7d0051 < $pc37695cb; $v43dd7d0051++) { $v5faa4b8a01 = $v793f92423d[$v43dd7d0051]; if (strtolower($v5faa4b8a01->getType()) == "expr_assign" && $v5faa4b8a01->var) { $v956913c90f = $v052656e632->prettyPrintExpr($v5faa4b8a01->var); if ($v956913c90f == '$' . $v847e7d0a83) { if ($v5faa4b8a01->expr->items) { $v847e7d0a83 = self::mb2dd5458eea8($v052656e632, $v5faa4b8a01->expr->items); $v7f2aac9119 = "array"; } else { $v847e7d0a83 = $v052656e632->prettyPrintExpr($v5faa4b8a01->expr); $v7f2aac9119 = self::getArgumentType($v847e7d0a83); $v847e7d0a83 = self::prepareArgument($v847e7d0a83, $v7f2aac9119); } break; } } } } } private static function f0a961fb1f4($v052656e632, &$v793f92423d, $v6306fea85d, $v643b49a734, $v847e7d0a83, $v7f2aac9119) { $v5c1c342594 = false; if ($v7f2aac9119 == "variable") { $pc37695cb = count($v793f92423d); for ($v43dd7d0051 = 0; $v43dd7d0051 < $pc37695cb; $v43dd7d0051++) { $v5faa4b8a01 = $v793f92423d[$v43dd7d0051]; if (strtolower($v5faa4b8a01->getType()) == "expr_assign" && $v5faa4b8a01->var) { $v956913c90f = $v052656e632->prettyPrintExpr($v5faa4b8a01->var); if ($v956913c90f == '$' . $v847e7d0a83) { $v67db1bd535 = $v5faa4b8a01->expr; if (count($v6306fea85d) == 1 && empty(strlen($v6306fea85d[0]))) { $pec9beadb = $v67db1bd535->getAttributes(); $v67db1bd535 = $v643b49a734; if ($pec9beadb) foreach ($pec9beadb as $pe5c5e2fe => $v956913c90f) $v67db1bd535->setAttribute($pe5c5e2fe, $v956913c90f); $v5c1c342594 = true; } else if ($v67db1bd535->items && self::mff8fad625e0e($v052656e632, $v67db1bd535->items, $v6306fea85d, $v643b49a734)) $v5c1c342594 = true; if ($v5c1c342594) $v793f92423d[$v43dd7d0051]->expr = $v67db1bd535; break; } } } } return $v5c1c342594; } private static function f9bfd754e94($v6490ea3a15, &$v847e7d0a83, &$v7f2aac9119, $pd69fb7d0 = null) { if ($v7f2aac9119 == "variable") { if ($pd69fb7d0) $v6490ea3a15 = substr($v6490ea3a15, 0, $pd69fb7d0); preg_match_all('/\$' . $v847e7d0a83 . '(\s*)=/u', $v6490ea3a15, $pbae7526c, PREG_OFFSET_CAPTURE); $pbae7526c = $pbae7526c[0]; $pbae7526c = $pbae7526c[ count($pbae7526c) - 1 ]; $v327f72fb62 = $pbae7526c[0]; $pbd1bc7b0 = $pbae7526c[1] + strlen($v327f72fb62); $pc37695cb = strlen($v6490ea3a15); if ($v327f72fb62 && $pbd1bc7b0 < $pc37695cb) { $v8f85090cce = $v365d20463c = false; $v67db1bd535 = ""; for ($v43dd7d0051 = $pbd1bc7b0; $v43dd7d0051 < $pc37695cb; $v43dd7d0051++) { $pc288256e = $v6490ea3a15[$v43dd7d0051]; if ($pc288256e == "'" && !$v365d20463c && !TextSanitizer::isCharEscaped($v6490ea3a15, $v43dd7d0051)) $v8f85090cce = !$v8f85090cce; else if ($pc288256e == '"' && !$v8f85090cce && !TextSanitizer::isCharEscaped($v6490ea3a15, $v43dd7d0051)) $v365d20463c = !$v365d20463c; if (!$v8f85090cce && !$v365d20463c && $pc288256e == ";") break; $v67db1bd535 .= $pc288256e; } $v847e7d0a83 = trim($v67db1bd535); $v7f2aac9119 = self::getArgumentType($v847e7d0a83); $v847e7d0a83 = self::prepareArgument($v847e7d0a83, $v7f2aac9119); } } } private static function mb2dd5458eea8($v052656e632, $pf72c1d58) { $v9073377656 = array(); $pc37695cb = $pf72c1d58 ? count($pf72c1d58) : 0; for ($v43dd7d0051 = 0; $v43dd7d0051 < $pc37695cb; $v43dd7d0051++) { $v342a134247 = $pf72c1d58[$v43dd7d0051]; $pbfa01ed1 = $v342a134247->key; $v67db1bd535 = $v342a134247->value; $v1491940c54 = is_object($pbfa01ed1) ? strtolower($pbfa01ed1->getType()) : null; $pc3e857ed = is_object($v67db1bd535) ? strtolower($v67db1bd535->getType()) : null; if ($v1491940c54) { $pbfa01ed1 = $v052656e632->prettyPrintExpr($pbfa01ed1); $pbfa01ed1 = self::getStmtValueAccordingWithType($pbfa01ed1, $v1491940c54); $v1491940c54 = strtolower($v342a134247->key->getType()); $v1491940c54 = $v1491940c54 == "scalar_string" || $v1491940c54 == "scalar_encapsed" ? "string" : ( $v1491940c54 == "expr_variable" ? "variable" : ( $v1491940c54 == "expr_funccall" ? "function" : ( $v1491940c54 == "expr_methodcall" || $v1491940c54 == "expr_staticcall" ? "method" : ( $v1491940c54 == "expr_array" ? "array" : "" )))); } else $pbfa01ed1 = null; if ($pc3e857ed) { if ($pc3e857ed == "expr_array") $v67db1bd535 = self::mb2dd5458eea8($v052656e632, $v67db1bd535->items); else { $v67db1bd535 = $v052656e632->prettyPrintExpr($v67db1bd535); $v67db1bd535 = self::getStmtValueAccordingWithType($v67db1bd535, $pc3e857ed); } $pc3e857ed = strtolower($pc3e857ed); $pc3e857ed = $pc3e857ed == "scalar_string" || $pc3e857ed == "scalar_encapsed" ? "string" : ( $pc3e857ed == "expr_variable" ? "variable" : ( $pc3e857ed == "expr_funccall" ? "function" : ( $pc3e857ed == "expr_methodcall" || $pc3e857ed == "expr_staticcall" ? "method" : ( $pc3e857ed == "expr_array" ? "array" : "" )))); } else $v67db1bd535 = null; $pb4a546a4 = array( "key" => $pbfa01ed1, "key_type" => isset($pbfa01ed1) ? $v1491940c54 : "null" ); if (is_array($v67db1bd535)) $pb4a546a4["items"] = $v67db1bd535; else { $pb4a546a4["value"] = $v67db1bd535; $pb4a546a4["value_type"] = isset($v67db1bd535) ? $pc3e857ed : "null"; } $v9073377656[] = $pb4a546a4; } return $v9073377656; } private static function mff8fad625e0e($v052656e632, &$pf72c1d58, $v6306fea85d, $v643b49a734) { $v5c1c342594 = false; $pc37695cb = $pf72c1d58 ? count($pf72c1d58) : 0; for ($v43dd7d0051 = 0; $v43dd7d0051 < $pc37695cb; $v43dd7d0051++) { $v342a134247 = $pf72c1d58[$v43dd7d0051]; $pbfa01ed1 = $v342a134247->key; $v67db1bd535 = $v342a134247->value; $v1491940c54 = is_object($pbfa01ed1) ? strtolower($pbfa01ed1->getType()) : null; $pc3e857ed = is_object($v67db1bd535) ? strtolower($v67db1bd535->getType()) : null; if ($v1491940c54) { $pbfa01ed1 = $v052656e632->prettyPrintExpr($pbfa01ed1); $pbfa01ed1 = self::getStmtValueAccordingWithType($pbfa01ed1, $v1491940c54); $v1491940c54 = strtolower($v342a134247->key->getType()); } else $pbfa01ed1 = null; $pc8464eca = false; if ($pbfa01ed1 && ($v1491940c54 == "scalar_string" || $v1491940c54 == "scalar_encapsed") && $pbfa01ed1 == $v6306fea85d[0]) $pc8464eca = true; else if (empty($pbfa01ed1) && $v43dd7d0051 == $v6306fea85d[0]) $pc8464eca = true; if ($pc8464eca && $pc3e857ed) { if (count($v6306fea85d) == 1) { $pec9beadb = $v67db1bd535->getAttributes(); $v67db1bd535 = $v643b49a734; if ($pec9beadb) foreach ($pec9beadb as $pe5c5e2fe => $v956913c90f) $v67db1bd535->setAttribute($pe5c5e2fe, $v956913c90f); $v5c1c342594 = true; } else if ($pc3e857ed == "expr_array") { array_shift($v6306fea85d); if (self::mff8fad625e0e($v052656e632, $v67db1bd535->items, $v6306fea85d, $v643b49a734)) $v5c1c342594 = true; } if ($v5c1c342594) $pf72c1d58[$v43dd7d0051]->value = $v67db1bd535; break; } } return $v5c1c342594; } public static function getStmtValueAccordingWithType($v67db1bd535, $pc3e857ed) { if ($pc3e857ed == "scalar_string" || $pc3e857ed == "scalar_encapsed") { $v34f0a629d3 = substr($v67db1bd535, 0, 1); $v67db1bd535 = substr($v67db1bd535, 1, -1); $v67db1bd535 = TextSanitizer::stripCSlashes($v67db1bd535, $v34f0a629d3); $v67db1bd535 = TextSanitizer::replaceIfNotEscaped('\n', "\n", $v67db1bd535); $v67db1bd535 = TextSanitizer::replaceIfNotEscaped('\t', "\t", $v67db1bd535); if ($v34f0a629d3 == "'") $v67db1bd535 = str_replace('$', '\\$', $v67db1bd535); $v67db1bd535 = preg_replace('/(|[^\\\\])\\\\(\${?[^\w])/u', '$1$2', $v67db1bd535); } else if ($pc3e857ed == "expr_binaryop_concat") { $v4b02eb37e3 = TextSanitizer::mbStrSplit($v67db1bd535); $pc37695cb = count($v4b02eb37e3); $pa456327a = ""; for ($v43dd7d0051 = 0; $v43dd7d0051 < $pc37695cb; $v43dd7d0051++) { $pc288256e = $v4b02eb37e3[$v43dd7d0051]; if (($pc288256e == '"' || $pc288256e == "'") && !TextSanitizer::isMBCharEscaped($v67db1bd535, $v43dd7d0051, $v4b02eb37e3)) { for ($v9d27441e80 = $v43dd7d0051 + 1; $v9d27441e80 < $pc37695cb; $v9d27441e80++) if ($v4b02eb37e3[$v9d27441e80] == $pc288256e && !TextSanitizer::isMBCharEscaped($v67db1bd535, $v9d27441e80, $v4b02eb37e3)) break; $v08d1f6acf0 = implode("", array_slice($v4b02eb37e3, $v43dd7d0051, ($v9d27441e80 + 1) - $v43dd7d0051)); $v08d1f6acf0 = TextSanitizer::replaceIfNotEscaped('\n', "\n", $v08d1f6acf0); $v08d1f6acf0 = TextSanitizer::replaceIfNotEscaped('\t', "\t", $v08d1f6acf0); if ($pc288256e == '"') $v08d1f6acf0 = preg_replace('/(|[^\\\\])\\\\(\${?[^\w])/u', '$1$2', $v08d1f6acf0); $pa456327a .= $v08d1f6acf0; $v43dd7d0051 = $v9d27441e80; } else $pa456327a .= $pc288256e; } $v67db1bd535 = $pa456327a; } return $v67db1bd535; } private static function f7eb9d895e6($v67db1bd535, $pc3e857ed) { if ($pc3e857ed == "scalar_string" || $pc3e857ed == "scalar_encapsed") { $v34f0a629d3 = substr($v67db1bd535, 0, 1); $v67db1bd535 = substr($v67db1bd535, 1, -1); $v67db1bd535 = TextSanitizer::replaceIfNotEscaped('\n', "\n", $v67db1bd535); $v67db1bd535 = TextSanitizer::replaceIfNotEscaped('\t', "\t", $v67db1bd535); $v67db1bd535 = stripslashes($v67db1bd535); $v67db1bd535 = str_replace('$', '\$', $v67db1bd535); if ($v34f0a629d3 == '"') $v67db1bd535 = str_replace('{\$', '{$', $v67db1bd535); } return $v67db1bd535; } public static function getArgumentType($pea70e132) { if (empty($pea70e132) && $pea70e132 !== 0) return ""; $pea70e132 = trim($pea70e132); if (strtolower($pea70e132) == "null" || is_numeric($pea70e132)) return ""; preg_match_all('/^(\$[\w\[\]\$]+)$/u', $pea70e132, $pbae7526c, PREG_PATTERN_ORDER); if ($pbae7526c[0][0] == $pea70e132) return "variable"; $v34f0a629d3 = substr($pea70e132, 0, 1); if (($v34f0a629d3 == '"' || $v34f0a629d3 == "'") && substr($pea70e132, -1) == $v34f0a629d3) { $pea70e132 = substr($pea70e132, 1, -1); $v7e4b517c18 = 0; do { $pbd1bc7b0 = strpos($pea70e132, $v34f0a629d3, $v7e4b517c18); $v7e4b517c18 = $pbd1bc7b0 + 1; if ($pbd1bc7b0 !== false && !TextSanitizer::isCharEscaped($pea70e132, $pbd1bc7b0)) return ""; } while ($pbd1bc7b0 !== false); return "string"; } return ""; } public static function prepareArgument($pea70e132, $v9439b47442) { if ($v9439b47442 == "string") return self::getStmtValueAccordingWithType($pea70e132, "scalar_string"); return $v9439b47442 == "variable" ? substr($pea70e132, 1) : (!$v9439b47442 && strtolower($pea70e132) == "null" ? null : $pea70e132); } public static function getFileContents($pf3dc0762) { return $pf3dc0762 && file_exists($pf3dc0762) ? file_get_contents($pf3dc0762) : ""; } public static function getVariableValueCode($v498f441296, $v3fb9f41470 = null) { if (!isset($v498f441296)) return $v3fb9f41470 == "string" || $v3fb9f41470 == "date" ? "''" : (!$v3fb9f41470 ? "null" : ""); return $v3fb9f41470 == "variable" && $v498f441296 ? ((substr(trim($v498f441296), 0, 1) != '$' ? '$' : '') . trim($v498f441296)) : ($v3fb9f41470 == "string" || $v3fb9f41470 == "date" ? "\"" . addcslashes($v498f441296, '"') . "\"" : (!$v3fb9f41470 && strlen(trim($v498f441296)) == 0 ? "null" : trim($v498f441296)) ); } } ?>
