<?php
/*
 * Copyright (c) 2007 PHPMyFrameWork - Joao Pinto
 * AUTHOR: Joao Paulo Lopes Pinto -- http://jplpinto.com
 * 
 * The use of this code must be allowed first by the creator Joao Pinto, since this is a private and proprietary code.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS 
 * OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY 
 * AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR 
 * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL 
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, 
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER 
 * IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT 
 * OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. IN NO EVENT SHALL 
 * THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN 
 * AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE 
 * OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */
include_once get_lib("org.phpframework.layer.presentation.cms.CMSLayer"); class CMSViewLayer { private $v874d5d2d79; private $pad5cfe31; private $pd19bd5aa; private $pa6b6ed6e; private $v03f58f6d04; private $v7f3956f135; public function __construct(CMSLayer $v874d5d2d79) { $this->v874d5d2d79 = $v874d5d2d79; $this->pad5cfe31 = array(); $this->pd19bd5aa = null; $this->pa6b6ed6e = array(); $this->v03f58f6d04 = false; $this->v7f3956f135 = array(); } public function createViewHtml($v88274d1ace, $pf8ed4912) { if ($this->isViewExecutionValid($v88274d1ace)) { $this->pd19bd5aa = $v88274d1ace; $this->pad5cfe31[$v88274d1ace] = $pf8ed4912; } } public function getCurrentViewId() { return $this->pd19bd5aa; } public function getViews() { return $this->pad5cfe31; } public function getView($v88274d1ace) { return isset($this->pad5cfe31[$v88274d1ace]) ? $this->pad5cfe31[$v88274d1ace] : null; } public function existsView($v88274d1ace) { return $this->pad5cfe31 && array_key_exists($v88274d1ace, $this->pad5cfe31); } public function getCurrentView() { $v88274d1ace = $this->getCurrentViewId(); return $v88274d1ace && isset($this->pad5cfe31[$v88274d1ace]) ? $this->pad5cfe31[$v88274d1ace] : null; } public function getViewIdFromFilePath($pf3dc0762, $v4eca125fbe = false) { $pf3dc0762 = normalize_windows_path_to_linux($pf3dc0762); if ($v4eca125fbe) $v88274d1ace = str_replace($this->v874d5d2d79->getEVC()->getViewsPath($v4eca125fbe), "", $pf3dc0762); else { $v9ab35f1f0d = $this->v874d5d2d79->getEVC()->getPresentationLayer(); $paf0420d3 = $v9ab35f1f0d->getSelectedPresentationId(); $v4eca125fbe = str_replace($v9ab35f1f0d->getLayerPathSetting(), "", $pf3dc0762); $pbd1bc7b0 = strpos($v4eca125fbe, "/src/"); $v4eca125fbe = substr($v4eca125fbe, 0, $pbd1bc7b0); if ($v4eca125fbe != $paf0420d3) $v88274d1ace = $v4eca125fbe . "/" . str_replace($this->v874d5d2d79->getEVC()->getViewsPath($v4eca125fbe), "", $pf3dc0762); else $v88274d1ace = str_replace($this->v874d5d2d79->getEVC()->getViewsPath($paf0420d3), "", $pf3dc0762); } $v6bfcc44e7b = pathinfo($v88274d1ace, PATHINFO_EXTENSION); if ($v6bfcc44e7b) $v88274d1ace = str_replace("." . $v6bfcc44e7b, "", $v88274d1ace); return $v88274d1ace; } public function stopAllViews() { $this->v03f58f6d04 = true; } public function startAllViews() { $this->v03f58f6d04 = false; } public function stopView($v88274d1ace) { if ($v88274d1ace) $this->v7f3956f135[$v88274d1ace] = true; } public function startView($v88274d1ace) { if ($v88274d1ace) $this->v7f3956f135[$v88274d1ace] = false; } public function stopViewRegions($v88274d1ace) { $this->stopView($v88274d1ace); if ($v88274d1ace && !empty($this->pa6b6ed6e[$v88274d1ace])) { $v597a5a0497 = $this->v874d5d2d79->getCMSTemplateLayer(); foreach ($this->pa6b6ed6e[$v88274d1ace] as $v9f2c84d2ad => $v02a69d4e0f) $v597a5a0497->stopRegion($v9f2c84d2ad); } } public function startViewRegions($v88274d1ace) { $this->startView($v88274d1ace); if ($v88274d1ace && !empty($this->pa6b6ed6e[$v88274d1ace])) { $v597a5a0497 = $this->v874d5d2d79->getCMSTemplateLayer(); foreach ($this->pa6b6ed6e[$v88274d1ace] as $v9f2c84d2ad => $v02a69d4e0f) $v597a5a0497->startRegion($v9f2c84d2ad); } } public function stopCurrentView() { $v88274d1ace = $this->getCurrentViewId(); $this->stopView($this->view_id); } public function startCurrentView() { $v88274d1ace = $this->getCurrentViewId(); $this->startView($this->view_id); } public function stopCurrentViewRegions() { $v88274d1ace = $this->getCurrentViewId(); $this->stopViewRegions($this->view_id); } public function startCurrentViewRegions() { $v88274d1ace = $this->getCurrentViewId(); $this->startViewRegions($this->view_id); } public function isAllViewsExecutionValid() { return !$this->v03f58f6d04; } public function isViewRegionsExecutionValid($v88274d1ace) { if ($v88274d1ace) { if (!empty($this->pa6b6ed6e[$v88274d1ace])) { $pd0cb8ced = $this->v874d5d2d79->getCMSTemplateLayer(); foreach ($this->pa6b6ed6e[$v88274d1ace] as $v9f2c84d2ad => $v02a69d4e0f) if ($pd0cb8ced->isRegionExecutionValid($v9f2c84d2ad)) return true; return false; } return true; } return false; } public function isViewExecutionValid($v88274d1ace) { return $this->isAllViewsExecutionValid() && $v88274d1ace && empty($this->v7f3956f135[$v88274d1ace]) && $this->isViewRegionsExecutionValid($v88274d1ace); } public function isCurrentViewExecutionValid() { $v88274d1ace = $this->getCurrentViewId(); return $this->isViewExecutionValid($this->view_id); } public function addViewRegion($v88274d1ace, $v9f2c84d2ad) { if ($v88274d1ace && $v9f2c84d2ad) $this->pa6b6ed6e[$v88274d1ace][$v9f2c84d2ad] = true; } } ?>
