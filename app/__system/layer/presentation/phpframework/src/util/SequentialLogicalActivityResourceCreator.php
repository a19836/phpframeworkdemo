<?php
/*
 * Copyright (c) 2007 PHPMyFrameWork - Joao Pinto
 * AUTHOR: Joao Paulo Lopes Pinto -- http://jplpinto.com
 * 
 * The use of this code must be allowed first by the creator Joao Pinto, since this is a private and proprietary code.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS 
 * OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY 
 * AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR 
 * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL 
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, 
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER 
 * IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT 
 * OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. IN NO EVENT SHALL 
 * THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN 
 * AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE 
 * OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

include_once $EVC->getUtilPath("CMSPresentationUIAutomaticFilesHandler"); include_once $EVC->getUtilPath("WorkFlowTasksFileHandler"); include_once $EVC->getUtilPath("SequentialLogicalActivityCodeConverter"); include_once $EVC->getUtilPath("CMSPresentationFormSettingsUIHandler"); class SequentialLogicalActivityResourceCreator { private $v08d9602741; private $v188b4f5fa6; private $pdf77ee66; private $pdb9e96e6; private $v4bf8d90f04; private $pfce4d1b3; private $v3d55458bcd; private $v5039a77f9d; private $peb014cfd; private $pb154d332; private $v8ffce2a791; private $pa0462a8e; private $pa32be502; private $pab752e34; private $v872f5b4dbb; private $v6cc00e79ac; private $v9d7547e4d6; private $pe77f177a; private $pd3623f40; private $v8b13fa2358; private $pd81959c6; private $v7a0994a134; private $v204e8c8e33; private $pac4bc40a; private $pecad7cca; public function __construct($v08d9602741, $v188b4f5fa6, $pdf77ee66, $pdb9e96e6, $v4bf8d90f04, $pfce4d1b3, $v3d55458bcd, $v5039a77f9d, $peb014cfd, $pb154d332, $v8ffce2a791, $pa0462a8e, $pa32be502, $pab752e34, $v872f5b4dbb, $v6cc00e79ac, $v9d7547e4d6) { $this->v08d9602741 = $v08d9602741; $this->v188b4f5fa6 = $v188b4f5fa6; $this->pdf77ee66 = $pdf77ee66; $this->pdb9e96e6 = $pdb9e96e6; $this->v4bf8d90f04 = $v4bf8d90f04; $this->pfce4d1b3 = $pfce4d1b3; $this->v3d55458bcd = $v3d55458bcd; $this->v5039a77f9d = $v5039a77f9d; $this->peb014cfd = $peb014cfd; $this->pb154d332 = $pb154d332; $this->v8ffce2a791 = $v8ffce2a791; $this->pa0462a8e = $pa0462a8e; $this->pa32be502 = $pa32be502; $this->pab752e34 = $pab752e34; $this->v872f5b4dbb = $v872f5b4dbb; $this->v6cc00e79ac = $v6cc00e79ac; $this->v9d7547e4d6 = $v9d7547e4d6; $this->pe77f177a = $v08d9602741->getPresentationLayer()->getPHPFrameWork()->getObject("UserCacheHandler"); $this->pd3623f40 = $v188b4f5fa6->getPresentationLayer(); $pc4223ce1 = $this->pd3623f40->getBrokers(); $this->v8b13fa2358 = $v872f5b4dbb != $GLOBALS["default_db_driver"]; $pf8e8a658 = array(); $v624f2a2845 = array(); if ($this->pb154d332) { if (!$this->pdf77ee66->searchLayoutTypes(array("name" => $this->pb154d332, "type_id" => UserAuthenticationHandler::$LAYOUTS_TYPE_FROM_PROJECT_ID))) $this->pb154d332 = null; else $this->pdf77ee66->loadLayoutPermissions($this->pb154d332, UserAuthenticationHandler::$LAYOUTS_TYPE_FROM_PROJECT_ID); } if ($this->pb154d332) { $v8fc05368c0 = WorkFlowBeansFileHandler::getLayerObjFolderName($this->pd3623f40); $this->v204e8c8e33 = substr($this->pb154d332, strlen($v8fc05368c0) + 1) . "/"; } foreach ($pc4223ce1 as $v2b2cf4c0eb => $pd922c2f7) { $pf8e8a658[$v2b2cf4c0eb] = true; if ($this->v204e8c8e33 && (is_a($pd922c2f7, "IBusinessLogicBrokerClient") || is_a($pd922c2f7, "IDataAccessBrokerClient"))) $v624f2a2845[$v2b2cf4c0eb] = $this->v204e8c8e33; } $this->pd81959c6 = $this->f65c3947327($pf8e8a658, $v624f2a2845); $this->v7a0994a134 = WorkFlowBeansFileHandler::getLayerBrokersSettings($v3d55458bcd, $v5039a77f9d, $pc4223ce1, '$EVC->getBroker'); $this->pac4bc40a = $this->f6fd1a4c6c2(); $v64e98269be = array("callbusinesslogic", "callibatisquery", "callhibernatemethod", "getquerydata", "setquerydata", "dbdaoaction"); $this->pecad7cca = new WorkFlowTaskHandler($v4bf8d90f04, $pfce4d1b3); $this->pecad7cca->setCacheRootPath(LAYER_CACHE_PATH); $this->pecad7cca->setAllowedTaskTags($v64e98269be); $this->pecad7cca->initWorkFlowTasks(); } public function getUtilFileId() { return "resource/" . $this->getUtilClassName(); } public function getUtilFilePath() { return $this->v188b4f5fa6->getUtilPath( $this->getUtilFileId() ); } public function getUtilClassName() { return self::mbe3c4fe09eee($this->v9d7547e4d6) . "ResourceUtil"; } public function getUtilMethodName($v256e3a39a7) { return self::f38ffbf7279($v256e3a39a7); } public function getSLAResourceActions($v256e3a39a7, $v69013e2fd6, $v78108bc88f = null, $pef34936b = null) { $v1335217393 = $this->getUtilClassName(); $v603bd47baf = $this->getUtilMethodName($v256e3a39a7); $pbee67690 = $this->getUtilFileId(); $ped197e8a = array(); $v58f9236561 = '\\$_GET["resource"] == "' . $v69013e2fd6 . '"'; $v187644de4a = ""; $v5cdf85b559 = false; $pa2d9cda9 = $v78108bc88f && is_array($v78108bc88f["conditions"]); switch ($v256e3a39a7) { case "insert": $ped197e8a = array( array("value" => '$EVC', "type" => ""), array("value" => '$_POST["attributes"]', "type" => "") ); $v58f9236561 .= ' && \\$_POST'; $v187644de4a = "Insert data into table: " . $this->v9d7547e4d6 . "."; $v5cdf85b559 = true; break; case "update": $ped197e8a = array( array("value" => '$EVC', "type" => ""), array("value" => '$_POST["attributes"]', "type" => ""), array("value" => '$_POST["conditions"]', "type" => ""), ); $v58f9236561 .= ' && \\$_POST'; $v187644de4a = "Update data from table: " . $this->v9d7547e4d6 . "."; $v5cdf85b559 = true; break; case "update_attribute": $ped197e8a = array( array("value" => '$EVC', "type" => ""), array("value" => '$_POST["attributes"]', "type" => ""), array("value" => '$_POST["conditions"]', "type" => ""), ); $v58f9236561 .= ' && \\$_POST'; $v187644de4a = "Update an attribute from table: " . $this->v9d7547e4d6 . "."; $v5cdf85b559 = true; break; case "multiple_save": $ped197e8a = array( array("value" => '$EVC', "type" => ""), array("value" => '$_POST["attributes"]', "type" => ""), array("value" => '$_POST["conditions"]', "type" => ""), ); $v58f9236561 .= ' && \\$_POST'; $v187644de4a = "Update multiple records at once from table: " . $this->v9d7547e4d6 . "."; $v5cdf85b559 = true; break; case "delete": $ped197e8a = array( array("value" => '$EVC', "type" => ""), array("value" => '$_POST["conditions"]', "type" => ""), ); $v58f9236561 .= ' && \\$_POST'; $v187644de4a = "Delete record from table: " . $this->v9d7547e4d6 . "."; $v5cdf85b559 = true; break; case "multiple_delete": $ped197e8a = array( array("value" => '$EVC', "type" => ""), array("value" => '$_POST["conditions"]', "type" => ""), ); $v58f9236561 .= ' && \\$_POST'; $v187644de4a = "Delete multiple records at once from table: " . $this->v9d7547e4d6 . "."; $v5cdf85b559 = true; break; case "get": $ped197e8a = array( array("value" => '$EVC', "type" => ""), array("value" => $pa2d9cda9 ? '#conditions#' : '$_GET["search_attrs"]', "type" => $pa2d9cda9 ? "string" : ""), ); $v187644de4a = "Get a record from table: " . $this->v9d7547e4d6 . "."; break; case "get_all": $ped197e8a = array( array("value" => '$EVC', "type" => ""), array("value" => '$_GET["items_limit_per_page"]', "type" => ""), array("value" => '$_GET["page_items_start"]', "type" => ""), array("value" => $pa2d9cda9 ? '#conditions#' : '$_GET["search_attrs"]', "type" => $pa2d9cda9 ? "string" : ""), array("value" => '$_GET["search_types"]', "type" => ""), array("value" => $pa2d9cda9 ? ($v78108bc88f["conditions_join"] ? '#conditions_join#' : '') : '$_GET["search_operator"]', "type" => $pa2d9cda9 ? "string" : ""), array("value" => '$_GET["sort_attrs"]', "type" => "") ); $v187644de4a = "Get records from table: " . $this->v9d7547e4d6 . "."; break; case "count": $ped197e8a = array( array("value" => '$EVC', "type" => ""), array("value" => $pa2d9cda9 ? '#conditions#' : '$_GET["search_attrs"]', "type" => $pa2d9cda9 ? "string" : ""), array("value" => '$_GET["search_types"]', "type" => ""), array("value" => $pa2d9cda9 ? ($v78108bc88f["conditions_join"] ? '#conditions_join#' : '') : '$_GET["search_operator"]', "type" => $pa2d9cda9 ? "string" : "") ); $v187644de4a = "Count records from table: " . $this->v9d7547e4d6 . "."; break; case "get_options": $ped197e8a = array( array("value" => '$EVC', "type" => "") ); $v187644de4a = "Get key-value pair list from table: " . $this->v9d7547e4d6 . ", where the key is the table primary key and the value is the table attribute label."; break; } $pd0361d43 = array( "result_var_name" => $v69013e2fd6 . "_group", "action_type" => "group", "condition_type" => "execute_if_condition", "condition_value" => $v58f9236561, "action_description" => $v187644de4a, "action_value" => array( "group_name" => "", "actions" => array() ) ); $v2196bde3fa = false; if ($pef34936b) { $v9ddaebbf03 = CMSPresentationUIAutomaticFilesHandler::getActivityIdByName($this->v188b4f5fa6, "access"); $v22fcc5754f = $v9ddaebbf03 ? self::f429ff68f21($pef34936b) : null; $v364b2f8ed9 = self::f30561a4102($pef34936b); if ($v22fcc5754f) { $v2196bde3fa = true; $v6b389bbbe4 = array(); foreach ($v22fcc5754f as $v6bbd1726b0) $v6b389bbbe4[] = array( "user_type_id" => $v6bbd1726b0, "activity_id" => $v9ddaebbf03, ); $pd0361d43["action_value"]["actions"][] = array( "result_var_name" => "allowed", "action_type" => "check_logged_user_permissions", "condition_type" => "execute_always", "condition_value" => "", "action_value" => array( "all_permissions_checked" => 0, "entity_path" => '$entity_path', "logged_user_id" => '$GLOBALS["logged_user_id"]', "users_perms" => $v6b389bbbe4, ) ); } if ($v364b2f8ed9) { $v2196bde3fa = true; $pd0361d43["action_value"]["actions"][] = array( "result_var_name" => "allowed", "action_type" => "string", "condition_type" => "execute_if_condition", "condition_value" => ($v22fcc5754f ? '\\$allowed && ' : "") . '\\$' . implode(' && \\$', $v364b2f8ed9) . '', "action_value" => '1' ); } } if ($pa2d9cda9) { $pd0361d43["action_value"]["actions"][] = array( "result_var_name" => "conditions", "action_type" => "array", "condition_type" => "execute_always", "condition_value" => "", "action_value" => CMSPresentationFormSettingsUIHandler::convertFormSettingsArrayToJavascriptSettings($v78108bc88f["conditions"]) ); if ($v78108bc88f["conditions_join"]) $pd0361d43["action_value"]["actions"][] = array( "result_var_name" => "conditions_join", "action_type" => "string", "condition_type" => "execute_always", "condition_value" => "", "action_value" => $v78108bc88f["conditions_join"] ); } $pd0361d43["action_value"]["actions"][] = array( "result_var_name" => $v69013e2fd6, "action_type" => "callobjectmethod", "condition_type" => $v2196bde3fa ? "execute_if_var" : "execute_always", "condition_value" => $v2196bde3fa ? "allowed" : "", "action_value" => array( "method_obj" => $v1335217393, "method_name" => $v603bd47baf, "method_static" => true, "method_args" => $ped197e8a, "include_file_path" => '$EVC->getUtilPath("' . $pbee67690 . '")', "include_once" => true, ) ); if ($v5cdf85b559) $pd0361d43["action_value"]["actions"][] = array( "result_var_name" => $v69013e2fd6 . "_unsuccessfully", "action_type" => "string", "condition_type" => "execute_if_not_var", "condition_value" => $v69013e2fd6, "action_value" => 1 ); $v55bd236ac1 = array($pd0361d43); return $v55bd236ac1; } public function createUtilMethod($v256e3a39a7, $v78108bc88f, &$pef612b9d) { $v1335217393 = $this->getUtilClassName(); $pf3dc0762 = $this->getUtilFilePath(); $v7e5f67574c = file_exists($pf3dc0762) && PHPCodePrintingHandler::getClassFromFile($pf3dc0762, $v1335217393); $pbb803615 = false; if (!$v7e5f67574c) $v7e5f67574c = PHPCodePrintingHandler::addClassToFile($pf3dc0762, array( "name" => $v1335217393 )); if (!$v7e5f67574c) $pef612b9d = "Error trying to create file '" . substr($pf3dc0762, strlen($pa2bba2ac)) . "'!"; else { $v603bd47baf = $this->getUtilMethodName($v256e3a39a7); $pbb803615 = PHPCodePrintingHandler::getFunctionFromFile($pf3dc0762, $v603bd47baf, $v1335217393); if (!$pbb803615) switch ($v256e3a39a7) { case "insert": $pbb803615 = $this->f56a6303328($v256e3a39a7, $v78108bc88f, $v1335217393, $pf3dc0762, $pef612b9d); break; case "update": $pbb803615 = $this->f2a57cf98d8($v256e3a39a7, $v78108bc88f, $v1335217393, $pf3dc0762, $pef612b9d); break; case "update_attribute": $pbb803615 = $this->f4a3f203401($v256e3a39a7, $v78108bc88f, $v1335217393, $pf3dc0762, $pef612b9d); break; case "multiple_save": $pbb803615 = $this->mb7c6f3b999f2($v256e3a39a7, $v78108bc88f, $v1335217393, $pf3dc0762, $pef612b9d); break; case "delete": $pbb803615 = $this->f2fb83474d9($v256e3a39a7, $v78108bc88f, $v1335217393, $pf3dc0762, $pef612b9d); break; case "multiple_delete": $pbb803615 = $this->me88a630493bf($v256e3a39a7, $v78108bc88f, $v1335217393, $pf3dc0762, $pef612b9d); break; case "get": $pbb803615 = $this->mdfa5bbc5993c($v256e3a39a7, $v78108bc88f, $v1335217393, $pf3dc0762, $pef612b9d); break; case "get_all": $pbb803615 = $this->f095047f6c0($v256e3a39a7, $v78108bc88f, $v1335217393, $pf3dc0762, $pef612b9d); break; case "count": $pbb803615 = $this->me27b4f4503b0($v256e3a39a7, $v78108bc88f, $v1335217393, $pf3dc0762, $pef612b9d); break; case "get_options": $pbb803615 = $this->f74776f4140($v256e3a39a7, $v78108bc88f, $v1335217393, $pf3dc0762, $pef612b9d); break; } } return $pbb803615; } private function f56a6303328($v256e3a39a7, $v78108bc88f, $v1335217393, $pf3dc0762, &$pef612b9d) { $v7f5911d32d = $this->mca39b99bd775("insert"); if (!$v7f5911d32d) $pef612b9d = "Error: Couldn't find any service for $v256e3a39a7 action."; else { $v7f5911d32d = $this->me176db5dc7d0($v7f5911d32d); $v7f5911d32d = $this->f1c48bf15e3($v7f5911d32d, '$attributes'); $v7f5911d32d = $this->f0cddec28ef($v7f5911d32d); $pc839a6ca = $this->mf8451bbed9de($v7f5911d32d); $v575c44b71f = $this->f13f8d8d24f($v256e3a39a7, $v7f5911d32d, $pc839a6ca, "\t"); $ped0a6251 = WorkFlowDBHandler::getTableFromTables($this->pac4bc40a, $this->v9d7547e4d6); if ($ped0a6251) { $v325ffa1d87 = array_keys($ped0a6251); $pe54f8a0f = array(); foreach ($ped0a6251 as $v5e45ec9bb9 => $v1b0cfa478b) if ($v1b0cfa478b["primary_key"] && WorkFlowDataAccessHandler::isAutoIncrementedAttribute($v1b0cfa478b)) $pe54f8a0f[] = $v5e45ec9bb9; $pa9786ba1 = self::f0dec7450c7($this->pac4bc40a, $this->v9d7547e4d6, $v325ffa1d87, $v7f5911d32d, $this->pecad7cca, $pc839a6ca, '$attributes'); $pa9786ba1 = str_replace("\n", "\n\t", $pa9786ba1); $v9207e4bc1a = self::mcfcf1f6200e9($pe54f8a0f, $v7f5911d32d, $this->pecad7cca, $pc839a6ca, '$result'); $v9207e4bc1a = str_replace("\n", "\n\t", $v9207e4bc1a); $v067674f4e4 = 'if ($attributes) {
	' . $pa9786ba1 . '
	$result = ' . $v575c44b71f . ';
	' . $v9207e4bc1a . '
	
	return $result;
}'; $pf677bde0 = array('EVC' => null, 'attributes' => null, 'no_cache' => 'true'); return $this->f78c42374a8($pf3dc0762, array( "name" => "insert", "static" => true, "arguments" => $pf677bde0, "code" => $v067674f4e4, ), $v1335217393); } } return false; } private function f2a57cf98d8($v256e3a39a7, $v78108bc88f, $v1335217393, $pf3dc0762, &$pef612b9d) { $v5a86787070 = $this->mca39b99bd775("update"); $pbd51c5c7 = $this->mca39b99bd775("update_pks"); $v0ebdd76a23 = $this->mca39b99bd775("get"); if (!$v5a86787070 || !$pbd51c5c7 || !$v0ebdd76a23) $pef612b9d = "Error: Couldn't find any service for $v256e3a39a7 action."; else { $v5a86787070 = $this->me176db5dc7d0($v5a86787070); $v5a86787070 = $this->f1c48bf15e3($v5a86787070, '$data'); $v5a86787070 = $this->f0cddec28ef($v5a86787070); $pd2db287c = $this->mf8451bbed9de($v5a86787070); $v20a4e49ecc = $this->f13f8d8d24f($v256e3a39a7, $v5a86787070, $pd2db287c, "\t\t\t\t"); $pbd51c5c7 = $this->me176db5dc7d0($pbd51c5c7); $pbd51c5c7 = $this->f1c48bf15e3($pbd51c5c7, '$filtered_pks'); $pbd51c5c7 = $this->f0cddec28ef($pbd51c5c7); $v0319a321c7 = $this->mf8451bbed9de($pbd51c5c7); $v1600539658 = $this->f13f8d8d24f($v256e3a39a7, $pbd51c5c7, $v0319a321c7, "\t\t\t\t"); $v0ebdd76a23 = $this->me176db5dc7d0($v0ebdd76a23); $v0ebdd76a23 = $this->f1c48bf15e3($v0ebdd76a23, '$filtered_attributes'); $v0ebdd76a23 = $this->f0cddec28ef($v0ebdd76a23); $v0370df69e9 = $this->mf8451bbed9de($v0ebdd76a23); $v11f5fae15d = $this->f13f8d8d24f($v256e3a39a7, $v0ebdd76a23, $v0370df69e9, "\t\t\t\t"); $ped0a6251 = WorkFlowDBHandler::getTableFromTables($this->pac4bc40a, $this->v9d7547e4d6); if ($ped0a6251) { $v325ffa1d87 = array_keys($ped0a6251); $pd253e918 = array(); foreach ($ped0a6251 as $v5e45ec9bb9 => $v1b0cfa478b) if ($v1b0cfa478b["primary_key"]) $pd253e918[] = $v5e45ec9bb9; $pa7c11132 = self::f8494219158($this->pac4bc40a, $this->v9d7547e4d6, $v325ffa1d87, $v5a86787070, $this->pecad7cca, $pd2db287c, '$attributes'); $pa7c11132 = str_replace("\n", "\n\t", $pa7c11132); $v0d13f6b70b = self::f8494219158($this->pac4bc40a, $this->v9d7547e4d6, $pd253e918, $v5a86787070, $this->pecad7cca, $pd2db287c, '$pks'); $v0d13f6b70b = str_replace("\n", "\n\t", $v0d13f6b70b); $v067674f4e4 = 'if ($attributes && $pks) {
	$status = true;
	
	' . $pa7c11132 . '
	' . $v0d13f6b70b . '
	
	if ($status) {
		//get new pks from $attributes and get $attributes without pks
		$filtered_pks = array();
		$filtered_attributes = array();
		
		foreach ($attributes as $attribute_name => $attribute_value) {
			if (array_key_exists($attribute_name, $pks)) {
				if ($attribute_value != $pks[$attribute_name])
					$filtered_pks["new_" . $attribute_name] = $attribute_value;
			}
			else
				$filtered_attributes[$attribute_name] = $attribute_value;
		}
		
		$status = $filtered_pks || $filtered_attributes;
		
		if ($status) {
			foreach ($pks as $pk_name => $pk_value) {
				if ($filtered_pks)
					$filtered_pks["old_" . $pk_name] = $pk_value;
				
				if ($filtered_attributes)
					$filtered_attributes[$pk_name] = $pk_value;
			}
			
			if ($filtered_attributes) {
				//get the record from DB bc the $attributes may only have a few attributes, so we need to populate the other ones in order to call the broker->update method.
				$data = ' . $v11f5fae15d . ';'; if ($v0ebdd76a23["item_type"] == "ibatis" || $v0ebdd76a23["item_type"] == "db") $v067674f4e4 .= '
				$data = $data ? $data[0] : null;'; $v067674f4e4 .= '
				
				if (!$data || !is_array($data))
					return false;
				
				foreach ($filtered_attributes as $attr_name => $attr_value)
					$data[$attr_name] = $attr_value;
				
				$status = ' . $v20a4e49ecc . ';
			}
			
			if ($status && $filtered_pks)
				$status = ' . $v1600539658 . ';
		}
	}
	
	return $status;
}'; $pf677bde0 = array('EVC' => null, 'attributes' => null, 'pks' => null, 'no_cache' => 'true'); return $this->f78c42374a8($pf3dc0762, array( "name" => "update", "static" => true, "arguments" => $pf677bde0, "code" => $v067674f4e4, ), $v1335217393); } } return false; } private function f4a3f203401($v256e3a39a7, $v78108bc88f, $v1335217393, $pf3dc0762, &$pef612b9d) { $v0ebdd76a23 = $this->mca39b99bd775("get"); $v5a86787070 = $this->mca39b99bd775("update"); if (!$v0ebdd76a23 || !$v5a86787070) $pef612b9d = "Error: Couldn't find any service for $v256e3a39a7 action."; else { $v0ebdd76a23 = $this->me176db5dc7d0($v0ebdd76a23); $v0ebdd76a23 = $this->f1c48bf15e3($v0ebdd76a23, '$pks'); $v0ebdd76a23 = $this->f0cddec28ef($v0ebdd76a23); $v0370df69e9 = $this->mf8451bbed9de($v0ebdd76a23); $v11f5fae15d = $this->f13f8d8d24f($v256e3a39a7, $v0ebdd76a23, $v0370df69e9, "\t\t"); $v5a86787070 = $this->me176db5dc7d0($v5a86787070); $v5a86787070 = $this->f1c48bf15e3($v5a86787070, '$data'); $v5a86787070 = $this->f0cddec28ef($v5a86787070); $pd2db287c = $this->mf8451bbed9de($v5a86787070); $v20a4e49ecc = $this->f13f8d8d24f($v256e3a39a7, $v5a86787070, $pd2db287c, "\t\t"); $ped0a6251 = WorkFlowDBHandler::getTableFromTables($this->pac4bc40a, $this->v9d7547e4d6); if ($ped0a6251) { $v325ffa1d87 = array_keys($ped0a6251); $pd253e918 = array(); foreach ($ped0a6251 as $v5e45ec9bb9 => $v1b0cfa478b) if ($v1b0cfa478b["primary_key"]) $pd253e918[] = $v5e45ec9bb9; $pa7c11132 = self::f8494219158($this->pac4bc40a, $this->v9d7547e4d6, $v325ffa1d87, $v5a86787070, $this->pecad7cca, $pd2db287c, '$attributes'); $pa7c11132 = str_replace("\n", "\n\t", $pa7c11132); $v0d13f6b70b = self::f8494219158($this->pac4bc40a, $this->v9d7547e4d6, $pd253e918, $v5a86787070, $this->pecad7cca, $pd2db287c, '$pks'); $v0d13f6b70b = str_replace("\n", "\n\t", $v0d13f6b70b); $v067674f4e4 = 'if ($attributes && $pks) {
	$status = true;
	
	' . $pa7c11132 . '
	' . $v0d13f6b70b . '
	
	if ($status) {
		$data = ' . $v11f5fae15d . ';'; if ($v0ebdd76a23["item_type"] == "ibatis" || $v0ebdd76a23["item_type"] == "db") $v067674f4e4 .= '
		$data = $data ? $data[0] : null;'; $v067674f4e4 .= '
	
		if (!$data || !is_array($data))
			return false;
		
		foreach ($attributes as $attribute_name => $attribute_value)
			$data[$attribute_name] = $attribute_value;
	
		$status = ' . $v20a4e49ecc . ';
	}
	
	return $status;
}'; $pf677bde0 = array('EVC' => null, 'attributes' => null, 'pks' => null, 'no_cache' => 'true'); return $this->f78c42374a8($pf3dc0762, array( "name" => "updateAttribute", "static" => true, "arguments" => $pf677bde0, "code" => $v067674f4e4, ), $v1335217393); } } return false; } private function mb7c6f3b999f2($v256e3a39a7, $v78108bc88f, $v1335217393, $pf3dc0762, &$pef612b9d) { $v55dffd6ac4 = PHPCodePrintingHandler::getFunctionFromFile($pf3dc0762, "insert", $v1335217393); $pb2504a38 = PHPCodePrintingHandler::getFunctionFromFile($pf3dc0762, "update", $v1335217393); if (!$v55dffd6ac4) $v55dffd6ac4 = $this->f56a6303328($v256e3a39a7, $v78108bc88f, $v1335217393, $pf3dc0762, $pef612b9d); if (!$pb2504a38) $pb2504a38 = $this->f2a57cf98d8($v256e3a39a7, $v78108bc88f, $v1335217393, $pf3dc0762, $pef612b9d); if (!$v55dffd6ac4 || !$pb2504a38) $pef612b9d = "Error: Couldn't find any service for $v256e3a39a7 action."; else { $v067674f4e4 = '$status = true;

if ($attributes)
	for ($i = 0, $t = count($attributes); $i < $t; $i++) {
		$item_attributes = $attributes[$i];
		$item_pks = $pks[$i];
		$is_insert = empty($item_pks);
		
		if ($is_insert && !self::insert($EVC, $item_attributes, $no_cache))
			$status = false;
		else if (!$is_insert && !self::update($EVC, $item_attributes, $item_pks, $no_cache))
			$status = false;
	}

return $status;'; $pf677bde0 = array('EVC' => null, 'attributes' => null, 'pks' => null, 'no_cache' => 'true'); return $this->f78c42374a8($pf3dc0762, array( "name" => "multipleSave", "static" => true, "arguments" => $pf677bde0, "code" => $v067674f4e4, ), $v1335217393); } return false; } private function f2fb83474d9($v256e3a39a7, $v78108bc88f, $v1335217393, $pf3dc0762, &$pef612b9d) { $v7f5911d32d = $this->mca39b99bd775("delete"); if (!$v7f5911d32d) $pef612b9d = "Error: Couldn't find any service for $v256e3a39a7 action."; else { $v7f5911d32d = $this->me176db5dc7d0($v7f5911d32d); $v7f5911d32d = $this->f1c48bf15e3($v7f5911d32d, '$pks'); $v7f5911d32d = $this->f0cddec28ef($v7f5911d32d); $pc839a6ca = $this->mf8451bbed9de($v7f5911d32d); $v575c44b71f = $this->f13f8d8d24f($v256e3a39a7, $v7f5911d32d, $pc839a6ca, "\t\t"); $ped0a6251 = WorkFlowDBHandler::getTableFromTables($this->pac4bc40a, $this->v9d7547e4d6); if ($ped0a6251) { $pd253e918 = array(); foreach ($ped0a6251 as $v5e45ec9bb9 => $v1b0cfa478b) if ($v1b0cfa478b["primary_key"]) $pd253e918[] = $v5e45ec9bb9; $v0d13f6b70b = self::f8494219158($this->pac4bc40a, $this->v9d7547e4d6, $pd253e918, $v7f5911d32d, $this->pecad7cca, $pc839a6ca, '$pks'); $v0d13f6b70b = str_replace("\n", "\n\t", $v0d13f6b70b); $v067674f4e4 = 'if ($pks) {
	$status = true;
	
	' . $v0d13f6b70b . '
	
	if ($status) {
		$status = ' . $v575c44b71f . ';
	}
	
	return $status;
}'; $pf677bde0 = array('EVC' => null, 'pks' => null, 'no_cache' => 'true'); return $this->f78c42374a8($pf3dc0762, array( "name" => "delete", "static" => true, "arguments" => $pf677bde0, "code" => $v067674f4e4, ), $v1335217393); } } return false; } private function me88a630493bf($v256e3a39a7, $v78108bc88f, $v1335217393, $pf3dc0762, &$pef612b9d) { $v213792fb2e = PHPCodePrintingHandler::getFunctionFromFile($pf3dc0762, "delete", $v1335217393); if (!$v213792fb2e) $v213792fb2e = $this->f2fb83474d9($v256e3a39a7, $v78108bc88f, $v1335217393, $pf3dc0762, $pef612b9d); if (!$v213792fb2e) $pef612b9d = "Error: Couldn't find any service for $v256e3a39a7 action."; else { $v067674f4e4 = '$status = true;

if ($pks)
	for ($i = 0, $t = count($pks); $i < $t; $i++)
		if (!self::delete($EVC, $pks[$i], $no_cache))
			$status = false;

return $status;'; $pf677bde0 = array('EVC' => null, 'pks' => null, 'no_cache' => 'true'); return $this->f78c42374a8($pf3dc0762, array( "name" => "multipleDelete", "static" => true, "arguments" => $pf677bde0, "code" => $v067674f4e4, ), $v1335217393); } return false; } private function mdfa5bbc5993c($v256e3a39a7, $v78108bc88f, $v1335217393, $pf3dc0762, &$pef612b9d) { $v7f5911d32d = $this->mca39b99bd775("get"); if (!$v7f5911d32d) $pef612b9d = "Error: Couldn't find any service for $v256e3a39a7 action."; else { $v7f5911d32d = $this->me176db5dc7d0($v7f5911d32d); $v7f5911d32d = $this->f1c48bf15e3($v7f5911d32d, '$pks'); $v7f5911d32d = $this->f0cddec28ef($v7f5911d32d); $pc839a6ca = $this->mf8451bbed9de($v7f5911d32d); $v575c44b71f = $this->f13f8d8d24f($v256e3a39a7, $v7f5911d32d, $pc839a6ca); $v067674f4e4 = '$result = ' . $v575c44b71f . ';
'; if ($v7f5911d32d["item_type"] == "ibatis" || $v7f5911d32d["item_type"] == "db") $v067674f4e4 .= '
$result = $result[0];'; else if ($v7f5911d32d["item_type"] == "hibernate") $v067674f4e4 .= self::mc08d0548215f('$result'); $v9207e4bc1a = self::mec94a53cc185($this->pac4bc40a, $this->v9d7547e4d6, '$result'); $v067674f4e4 .= $v9207e4bc1a ? '

' . trim($v9207e4bc1a) : ''; $v067674f4e4 .= '
return $result;'; $pf677bde0 = array('EVC' => null, 'pks' => null, 'no_cache' => 'false'); return $this->f78c42374a8($pf3dc0762, array( "name" => "get", "static" => true, "arguments" => $pf677bde0, "code" => $v067674f4e4, ), $v1335217393); } return false; } private function f095047f6c0($v256e3a39a7, $v78108bc88f, $v1335217393, $pf3dc0762, &$pef612b9d) { $v7f5911d32d = $this->mca39b99bd775("get_all"); if (!$v7f5911d32d) $pef612b9d = "Error: Couldn't find any service for $v256e3a39a7 action."; else { $v7f5911d32d = $this->f113a7331a6($v7f5911d32d); $v7f5911d32d = $this->mf40bb6b42dc9($v7f5911d32d); $v7f5911d32d = $this->f3b97005c4d($v7f5911d32d); $v7f5911d32d = $this->f0cddec28ef($v7f5911d32d); $pc839a6ca = $this->mf8451bbed9de($v7f5911d32d); $v575c44b71f = $this->f13f8d8d24f($v256e3a39a7, $v7f5911d32d, $pc839a6ca); $v067674f4e4 = $this->f23e499c06b($v7f5911d32d); $v067674f4e4 .= '$result = ' . $v575c44b71f . ';'; if ($v7f5911d32d["item_type"] == "hibernate") $v067674f4e4 .= self::f58aba253ab('$result'); $v9207e4bc1a = self::f1a0f95fcd7($this->pac4bc40a, $this->v9d7547e4d6, '$result'); $v067674f4e4 .= $v9207e4bc1a ? '

' . $v9207e4bc1a : ''; $v067674f4e4 .= '
return $result;'; $pf677bde0 = array('EVC' => null, 'limit' => 'false', 'start' => 'false', 'conditions' => 'false', 'conditions_type' => 'false', 'conditions_join' => 'false', 'sort' => 'false', 'no_cache' => 'false'); return $this->f78c42374a8($pf3dc0762, array( "name" => "getAll", "static" => true, "arguments" => $pf677bde0, "code" => $v067674f4e4, ), $v1335217393); } return false; } private function me27b4f4503b0($v256e3a39a7, $v78108bc88f, $v1335217393, $pf3dc0762, &$pef612b9d) { $v7f5911d32d = $this->mca39b99bd775("count"); if (!$v7f5911d32d) $pef612b9d = "Error: Couldn't find any service for $v256e3a39a7 action."; else { $v7f5911d32d = $this->f113a7331a6($v7f5911d32d); $v7f5911d32d = $this->f0cddec28ef($v7f5911d32d); $pc839a6ca = $this->mf8451bbed9de($v7f5911d32d); $v575c44b71f = $this->f13f8d8d24f($v256e3a39a7, $v7f5911d32d, $pc839a6ca); $v067674f4e4 = $this->f23e499c06b($v7f5911d32d); $v067674f4e4 .= '$result = ' . $v575c44b71f . ';
'; if ($v7f5911d32d["item_type"] == "ibatis" || $v7f5911d32d["item_type"] == "db") $v067674f4e4 .= '
return $result[0]["total"];'; else $v067674f4e4 .= '
return $result;'; $pf677bde0 = array('EVC' => null, 'conditions' => 'false', 'conditions_type' => 'false', 'conditions_join' => 'false', 'no_cache' => 'false'); return $this->f78c42374a8($pf3dc0762, array( "name" => "count", "static" => true, "arguments" => $pf677bde0, "code" => $v067674f4e4, ), $v1335217393); } return false; } private function f74776f4140($v256e3a39a7, $v78108bc88f, $v1335217393, $pf3dc0762, &$pef612b9d) { $v7f5911d32d = $this->mca39b99bd775("get_all"); if (!$v7f5911d32d) $pef612b9d = "Error: Couldn't find any service for $v256e3a39a7 action."; else { $v7f5911d32d = $this->f0cddec28ef($v7f5911d32d); $pc839a6ca = $this->mf8451bbed9de($v7f5911d32d); $v575c44b71f = $this->f13f8d8d24f($v256e3a39a7, $v7f5911d32d, $pc839a6ca); $pfa973d42 = self::f5716ef881e($this->v9d7547e4d6, $this->pac4bc40a, $v78108bc88f); if (!$pfa973d42) $pef612b9d = "Error: No primary attribute name when trying to create the getOptions method."; else { $v9994512d98 = $pfa973d42["keys"]; $v76b0aa2076 = $pfa973d42["values"]; $v067674f4e4 = '$result = ' . $v575c44b71f . ';
'; if ($v7f5911d32d["item_type"] == "hibernate") $v067674f4e4 .= self::f58aba253ab('$result'); $v067674f4e4 .= '
$options = array();

if ($result) 
	for ($i = 0, $t = count($result); $i < $t; $i++) {
		$item = $result[$i];
		$key = '; for ($v43dd7d0051 = 0, $pc37695cb = count($v9994512d98); $v43dd7d0051 < $pc37695cb; $v43dd7d0051++) $v067674f4e4 .= ($v43dd7d0051 > 0 ? ' . "_" . ' : "") . '$item["' . $v9994512d98[$v43dd7d0051] . '"]'; $v067674f4e4 .= ';
		$value = '; for ($v43dd7d0051 = 0, $pc37695cb = count($v76b0aa2076); $v43dd7d0051 < $pc37695cb; $v43dd7d0051++) $v067674f4e4 .= ($v43dd7d0051 > 0 ? ' . "_" . ' : "") . '$item["' . $v76b0aa2076[$v43dd7d0051] . '"]'; $v067674f4e4 .= ';
		$options[$key] = $value;
	}

return $options;'; $pf677bde0 = array('EVC' => null, 'no_cache' => 'false'); return $this->f78c42374a8($pf3dc0762, array( "name" => "getOptions", "static" => true, "arguments" => $pf677bde0, "code" => $v067674f4e4, ), $v1335217393); } } return false; } private function f78c42374a8($pf3dc0762, $v036170882a, $v1335217393) { $pbb803615 = PHPCodePrintingHandler::getFunctionFromFile($pf3dc0762, $v036170882a["name"], $v1335217393); if (!$pbb803615) return PHPCodePrintingHandler::addFunctionToFile($pf3dc0762, $v036170882a, $v1335217393); return true; } private function f65c3947327($pf8e8a658, $v624f2a2845 = array(), $v543a4abeae = false) { $this->pe77f177a->config(60 * 60, true); $pcc09eb12 = "tables_ui_props/" . md5($this->v8ffce2a791 . "_" . $this->pa0462a8e . "_" . $this->pa32be502 . "_" . $this->pab752e34 . "_" . $this->v872f5b4dbb . "_" . $this->v6cc00e79ac . "_" . $this->v9d7547e4d6 . "_" . json_encode($pf8e8a658) . "_" . json_encode($v624f2a2845)); if (!$v543a4abeae && $this->pe77f177a->isValid($pcc09eb12)) { $pd81959c6 = $this->pe77f177a->read($pcc09eb12); if ($pd81959c6) return $pd81959c6; } $pf8e8a658 = is_array($pf8e8a658) ? $pf8e8a658 : array(); $v624f2a2845 = is_array($v624f2a2845) ? $v624f2a2845 : array(); $v9b98e0e818 = WorkFlowBeansFileHandler::getLayerDBDrivers($this->v3d55458bcd, $this->v5039a77f9d, $this->pd3623f40, true); $v340232a6d9 = $v9b98e0e818[$this->v872f5b4dbb]; if ($v340232a6d9) { $v2895a50b4e = $v340232a6d9[2]; $v9ac2ae8b4d = $v340232a6d9[1]; } $pea5fed5d = LayoutTypeProjectUIHandler::getFilterByLayoutURLQuery($this->pb154d332); $v9d0e752b7c = $this->peb014cfd . "phpframework/presentation/get_presentation_tables_ui_props_automatically?bean_name=" . $this->v8ffce2a791 . "&bean_file_name=" . $this->pa0462a8e . "$pea5fed5d&path=" . $this->pa32be502 . "&db_layer=" . $this->db_layer . "&db_layer_file=$v9ac2ae8b4d&db_driver=" . $this->v872f5b4dbb . "&include_db_driver=" . $this->v8b13fa2358 . "&type=" . $this->v6cc00e79ac; $pd65a9318 = array( "ab" => $pf8e8a658, "abf" => $v624f2a2845, "st" => array($this->v9d7547e4d6), "sta" => array() ); $pd81959c6 = $this->pdf77ee66->getURLContent($v9d0e752b7c, $pd65a9318); $pd81959c6 = json_decode($pd81959c6, true); $this->pe77f177a->write($pcc09eb12, $pd81959c6); return $pd81959c6; } private function f6fd1a4c6c2() { $this->pe77f177a->config(60 * 60, true); $pcc09eb12 = "tables_props/" . md5($this->v6cc00e79ac . "_" . $this->v872f5b4dbb); if ($this->pe77f177a->isValid($pcc09eb12)) { $pac4bc40a = $this->pe77f177a->read($pcc09eb12); if ($pac4bc40a) return $pac4bc40a; } $v094d1a2778 = new WorkFlowDataAccessHandler(); if ($this->v6cc00e79ac == "diagram") { $v5e053dece2 = WorkFlowTasksFileHandler::getDBDiagramTaskFilePath($this->pdb9e96e6, "db_diagram", $this->v872f5b4dbb); $v094d1a2778->setTasksFilePath($v5e053dece2); } else { $v9b98e0e818 = WorkFlowBeansFileHandler::getLayerDBDrivers($this->v3d55458bcd, $this->v5039a77f9d, $this->pd3623f40, true); $pa9b2090f = $v9b98e0e818[$this->v872f5b4dbb]; $v9ac8782c3f = $pa9b2090f[1]; $v831632c60d = $pa9b2090f[2] ? $pa9b2090f[2] : $this->v872f5b4dbb; if ($v9ac8782c3f && $v831632c60d) { $v660b5296f8 = new WorkFlowDBHandler($this->v5039a77f9d, $this->v3d55458bcd); $v1d696dbd12 = $v660b5296f8->getUpdateTaskDBDiagram($v9ac8782c3f, $v831632c60d); $v094d1a2778->setTasks($v1d696dbd12); } } $pac4bc40a = $v094d1a2778->getTasksAsTables(); $this->pe77f177a->write($pcc09eb12, $pac4bc40a); return $pac4bc40a; } private function mca39b99bd775($pf77f1f5c) { if ($this->v9d7547e4d6 && $this->pd81959c6 && $this->v7a0994a134) { $v6e9af47944 = $this->v7a0994a134["business_logic_brokers"]; $pf864769c = $this->v7a0994a134["ibatis_brokers"]; $paf75a67c = $this->v7a0994a134["hibernate_brokers"]; $v5483bfa973 = $this->v7a0994a134["db_brokers"]; $v7a4c0ba9ac = array( "businesslogic" => $v6e9af47944, "ibatis" => $pf864769c, "hibernate" => $paf75a67c, "db" => $v5483bfa973, ); $pa32be502 = $this->v204e8c8e33 ? $this->v204e8c8e33 : "resource/" . $this->v872f5b4dbb . "/"; foreach ($v7a4c0ba9ac as $v8773b3a63a => $pa33ce33b) if ($pa33ce33b) { for ($v43dd7d0051 = 0, $pc37695cb = count($pa33ce33b); $v43dd7d0051 < $pc37695cb; $v43dd7d0051++) { $v7aeaf992f5 = $pa33ce33b[$v43dd7d0051]; $v2b2cf4c0eb = $v7aeaf992f5[0]; $pf2073d1f = $v7aeaf992f5[1]; $pef1b7ad7 = $v7aeaf992f5[2]; $v95eeadc9e9 = $this->pd81959c6["tables"][$this->v9d7547e4d6][$v2b2cf4c0eb][$pf77f1f5c]; if ($v95eeadc9e9) { $v7f5911d32d = array( "broker_name" => $v2b2cf4c0eb, "bean_name" => $pef1b7ad7, "bean_file_name" => $pf2073d1f, "item_type" => $v8773b3a63a, "service" => $v95eeadc9e9, ); self::f9e1b56b7f9($v7f5911d32d, $this->pac4bc40a); return $v7f5911d32d; } } for ($v43dd7d0051 = 0, $pc37695cb = count($pa33ce33b); $v43dd7d0051 < $pc37695cb; $v43dd7d0051++) { $v7aeaf992f5 = $pa33ce33b[$v43dd7d0051]; $v2b2cf4c0eb = $v7aeaf992f5[0]; $pf2073d1f = $v7aeaf992f5[1]; $pef1b7ad7 = $v7aeaf992f5[2]; $v5c1c342594 = $this->me99affeb6dc5($pf2073d1f, $pef1b7ad7, $pa32be502, $pf77f1f5c); if ($v5c1c342594) { $pf8e8a658 = array($v2b2cf4c0eb => true); $v624f2a2845 = array($v2b2cf4c0eb => $pa32be502); $v8652348c62 = $this->f65c3947327($pf8e8a658, $v624f2a2845, true); $v95eeadc9e9 = $v8652348c62["tables"][$this->v9d7547e4d6][$v2b2cf4c0eb][$pf77f1f5c]; if ($v95eeadc9e9) { $this->pd81959c6["tables"][$this->v9d7547e4d6][$v2b2cf4c0eb][$pf77f1f5c] = $v95eeadc9e9; $v7f5911d32d = array( "broker_name" => $v2b2cf4c0eb, "bean_name" => $pef1b7ad7, "bean_file_name" => $pf2073d1f, "item_type" => $v8773b3a63a, "service" => $v95eeadc9e9, ); self::f9e1b56b7f9($v7f5911d32d, $this->pac4bc40a); return $v7f5911d32d; } } } } } return null; } private function me99affeb6dc5($pa0462a8e, $v8ffce2a791, $pa32be502, $pf77f1f5c) { $pb512d021 = new WorkFlowBeansFileHandler($this->v5039a77f9d . $pa0462a8e, $this->v3d55458bcd); $v972f1a5c2b = $pb512d021->getBeanObject($v8ffce2a791); if ($v972f1a5c2b) { $pea5fed5d = LayoutTypeProjectUIHandler::getFilterByLayoutURLQuery($this->pb154d332); $v603bd47baf = self::f38ffbf7279($pf77f1f5c); $v71571534b0 = str_replace(array(" ", "."), "_", strtolower($this->v9d7547e4d6)); $pe8775f42 = $pf77f1f5c . "_" . $v71571534b0; $pc221318a = $pf77f1f5c; if ($pf77f1f5c == "update_pks") { $pe8775f42 = "update_" . $v71571534b0 . "_primary_keys"; $pc221318a = "update"; } else if ($pf77f1f5c == "get_all") { $pe8775f42 = "get_" . $v71571534b0 . "_items"; $pc221318a = "select"; } else if ($pf77f1f5c == "count") { $pe8775f42 = "count_" . $v71571534b0 . "_items"; $pc221318a = "select"; } else if ($pf77f1f5c == "get") $pc221318a = "select"; if (is_a($v972f1a5c2b, "BusinessLogicLayer")) { $v1335217393 = self::mbe3c4fe09eee($this->v9d7547e4d6) . "Service"; $pff532685 = $v1335217393 . ".php"; $v8bdbb4d778 = $v972f1a5c2b->getLayerPathSetting() . $pa32be502 . $pff532685; $v8f3ba6c949 = !$this->pb154d332 || $this->pdf77ee66->isLayoutInnerFilePermissionAllowed(dirname($v8bdbb4d778), $this->pb154d332, "layer", UserAuthenticationHandler::$PERMISSION_BELONG_NAME, false, false); if (!$v8f3ba6c949) return false; if (file_exists($v8bdbb4d778)) { $v036170882a = PHPCodePrintingHandler::getFunctionFromFile($v8bdbb4d778, $v603bd47baf, $v1335217393); if ($v036170882a) return true; } $v6f3a2700dd = $this->peb014cfd . "phpframework/businesslogic/create_business_logic_objs_automatically?bean_name=$v8ffce2a791&bean_file_name=$pa0462a8e$pea5fed5d&path=$pa32be502"; $v7a0994a134 = WorkFlowBeansFileHandler::getLayerBrokersSettings($this->v3d55458bcd, $this->v5039a77f9d, $v972f1a5c2b->getBrokers(), ''); $v5483bfa973 = $v7a0994a134["db_brokers"]; $pf864769c = $v7a0994a134["ibatis_brokers"]; $paf75a67c = $v7a0994a134["hibernate_brokers"]; $v7a4c0ba9ac = array( "db" => $v5483bfa973, "ibatis" => $pf864769c, "hibernate" => $paf75a67c, ); foreach ($v7a4c0ba9ac as $v8773b3a63a => $pa33ce33b) { for ($v43dd7d0051 = 0, $pc37695cb = count($pa33ce33b); $v43dd7d0051 < $pc37695cb; $v43dd7d0051++) { $v7aeaf992f5 = $pa33ce33b[$v43dd7d0051]; $v2b2cf4c0eb = $v7aeaf992f5[0]; $pf2073d1f = $v7aeaf992f5[1]; $pef1b7ad7 = $v7aeaf992f5[2]; $v6ee393d9fb = array( $this->v9d7547e4d6 => array( "all" => $v2b2cf4c0eb ) ); $v70210c15fa = array( $this->v9d7547e4d6 => array( "all" => "" ) ); if ($v8773b3a63a == "ibatis") { $pf58af8a1 = WorkFlowBeansFileHandler::getLayerBeanFolderName($this->v5039a77f9d . $pf2073d1f, $pef1b7ad7, $this->v3d55458bcd); $v7dffdb5a5b = $pa32be502 . "$v71571534b0.xml"; $v5cd52475a5 = LAYER_PATH . $pf58af8a1 . "/$v7dffdb5a5b"; $v24dd418042 = file_exists($v5cd52475a5) ? WorkFlowDataAccessHandler::getXmlQueryOrMapData($v5cd52475a5, $pe8775f42, array($pc221318a)) : null; $v9f035b70b2 = !file_exists($v5cd52475a5) || !$v24dd418042; if ($v9f035b70b2) { $this->me99affeb6dc5($pf2073d1f, $pef1b7ad7, $pa32be502, $pf77f1f5c); clearstatcache(); } if (!file_exists($v5cd52475a5)) $v6ee393d9fb = null; else { $v6ee393d9fb = array( $v7dffdb5a5b => array( "all" => $v2b2cf4c0eb ) ); $v70210c15fa = array( $v7dffdb5a5b => array( "all" => "" ) ); } } else if ($v8773b3a63a == "hibernate") { $pf58af8a1 = WorkFlowBeansFileHandler::getLayerBeanFolderName($this->v5039a77f9d . $pf2073d1f, $pef1b7ad7, $this->v3d55458bcd); $v7dffdb5a5b = $pa32be502 . "$v71571534b0.xml"; $v5cd52475a5 = LAYER_PATH . $pf58af8a1 . "/$v7dffdb5a5b"; if (!file_exists($v5cd52475a5)) { $this->me99affeb6dc5($pf2073d1f, $pef1b7ad7, $pa32be502, $pf77f1f5c); clearstatcache(); } if (!file_exists($v5cd52475a5)) $v6ee393d9fb = null; } if ($v6ee393d9fb) { $pd65a9318 = array( "db_driver" => $this->v872f5b4dbb, "type" => $this->v6cc00e79ac, "files" => $v6ee393d9fb, "aliases" => $v70210c15fa, "step_1" => true, "include_db_driver" => $this->v8b13fa2358, "overwrite" => false, "json" => true, ); $v806a006822 = $this->pdf77ee66->getURLContent($v6f3a2700dd, $pd65a9318); $v806a006822 = $v806a006822 ? json_decode($v806a006822, true) : $v806a006822; if ($v806a006822) { $v342a134247 = $v806a006822[0]; $pc45f4981 = $v342a134247[0]; $v7d733caff4 = $v972f1a5c2b->getLayerPathSetting() . $pc45f4981; if (file_exists($v7d733caff4)) { $v1335217393 = pathinfo($pc45f4981, PATHINFO_FILENAME); $v036170882a = PHPCodePrintingHandler::getFunctionFromFile($v7d733caff4, $v603bd47baf, $v1335217393); $pbb803615 = !empty($v036170882a); if ($pbb803615) { $v7d733caff4 = str_replace("//", "/", $v7d733caff4); if ($v7d733caff4 == $v8bdbb4d778) $v5c1c342594 = true; else if (file_exists($v8bdbb4d778)) { $v036170882a["code"] = PHPCodePrintingHandler::getFunctionCodeFromFile($v7d733caff4, $v036170882a["name"], $v1335217393); $pcc2fe66c = is_array($v036170882a["comments"]) ? trim(implode("\n", $v036170882a["comments"])) : ""; $pcc2fe66c .= is_array($v036170882a["doc_comments"]) ? ($pcc2fe66c ? "\n" : "") . trim(implode("\n", $v036170882a["doc_comments"])) : ""; $v036170882a["comments"] = str_replace("\n\t", "\n", $pcc2fe66c); $v4c704b9c94 = PHPCodePrintingHandler::getClassOfFile($v8bdbb4d778); $v5c1c342594 = PHPCodePrintingHandler::addFunctionToFile($v8bdbb4d778, $v036170882a, $v4c704b9c94["name"]); @unlink($v7d733caff4); } else { $v5c1c342594 = rename($v7d733caff4, $v8bdbb4d778); if ($v5c1c342594) { $v4c704b9c94 = PHPCodePrintingHandler::getClassOfFile($v7d733caff4); $v1f7d5360db = PHPCodePrintingHandler::prepareClassNameWithNameSpace($v4c704b9c94["name"], $v4c704b9c94["namespace"]); $v4f8cf73e03 = PHPCodePrintingHandler::prepareClassNameWithNameSpace(pathinfo($v7d733caff4, PATHINFO_FILENAME), $v4c704b9c94["namespace"]); $v5c1c342594 = PHPCodePrintingHandler::renameClassFromFile($v7d733caff4, $v1f7d5360db, $v4f8cf73e03); if (!$v5c1c342594) @unlink($v8bdbb4d778); } else @unlink($v7d733caff4); } if ($v5c1c342594) return true; } else if ($v7d733caff4 != $v8bdbb4d778) @unlink($v7d733caff4); } } } } } } else if (is_a($v972f1a5c2b, "IbatisDataAccessLayer")) { $pff532685 = $v71571534b0 . ".xml"; $v8bdbb4d778 = $v972f1a5c2b->getLayerPathSetting() . $pa32be502 . $pff532685; $v8f3ba6c949 = !$this->pb154d332 || $this->pdf77ee66->isLayoutInnerFilePermissionAllowed(dirname($v8bdbb4d778), $this->pb154d332, "layer", UserAuthenticationHandler::$PERMISSION_BELONG_NAME, false, false); if (!$v8f3ba6c949) return false; if (file_exists($v8bdbb4d778)) { $v24dd418042 = WorkFlowDataAccessHandler::getXmlQueryOrMapData($v8bdbb4d778, $pe8775f42, array($pc221318a)); if ($v24dd418042) return true; } $v6f3a2700dd = $this->peb014cfd . "phpframework/dataaccess/create_data_access_objs_automatically?bean_name=$v8ffce2a791&bean_file_name=$pa0462a8e$pea5fed5d&path=$pa32be502&item_type=ibatis"; $pd65a9318 = array( "db_broker" => $this->pab752e34, "db_driver" => $this->v872f5b4dbb, "type" => $this->v6cc00e79ac, "st" => array($this->v9d7547e4d6), "sta" => array($this->v9d7547e4d6 => ""), "step_2" => true, "overwrite" => false, "with_maps" => false, "json" => true, ); $v806a006822 = $this->pdf77ee66->getURLContent($v6f3a2700dd, $pd65a9318); $v806a006822 = $v806a006822 ? json_decode($v806a006822, true) : $v806a006822; if ($v806a006822) { $v342a134247 = $v806a006822[0]; $pc45f4981 = $v342a134247[0]; $v7d733caff4 = $v972f1a5c2b->getLayerPathSetting() . $pc45f4981; if (file_exists($v7d733caff4)) { $v24dd418042 = WorkFlowDataAccessHandler::getXmlQueryOrMapData($v7d733caff4, $pe8775f42, array($pc221318a)); $pdb37983e = !empty($v24dd418042); if ($pdb37983e) { $v7d733caff4 = str_replace("//", "/", $v7d733caff4); if ($v7d733caff4 == $v8bdbb4d778) $v5c1c342594 = true; else if (file_exists($v8bdbb4d778)) { $v4948cc5869 = array( "queries" => array( array( "name" => "queries", "childs" => array( $pc221318a => array( array( "name" => $pc221318a, "@" => array( "id" => $v24dd418042["@"]["id"] ), "value" => $v3c76382d93 = XMLFileParser::getValue($v24dd418042) ) ) ) ) ) ); $v094d1a2778 = new WorkFlowDataAccessHandler(); $v5c1c342594 = $v094d1a2778->createTableQueriesFromObjectData($v8bdbb4d778, $v4948cc5869); $v972f1a5c2b->getSQLClient()->getSQLMapClientCache()->deleteCachedXMLElm($v8bdbb4d778); @unlink($v7d733caff4); } else { $v5c1c342594 = rename($v7d733caff4, $v8bdbb4d778); if (!$v5c1c342594) @unlink($v7d733caff4); } if ($v5c1c342594) return true; } else if ($v7d733caff4 != $v8bdbb4d778) @unlink($v7d733caff4); } } } else if (is_a($v972f1a5c2b, "HibernateDataAccessLayer")) { $pff532685 = $v71571534b0 . ".xml"; $v8bdbb4d778 = $v972f1a5c2b->getLayerPathSetting() . $pa32be502 . $pff532685; $v8f3ba6c949 = !$this->pb154d332 || $this->pdf77ee66->isLayoutInnerFilePermissionAllowed(dirname($v8bdbb4d778), $this->pb154d332, "layer", UserAuthenticationHandler::$PERMISSION_BELONG_NAME, false, false); if (!$v8f3ba6c949) return false; if (file_exists($v8bdbb4d778)) return true; else { $v6f3a2700dd = $this->peb014cfd . "phpframework/dataaccess/create_data_access_objs_automatically?bean_name=$v8ffce2a791&bean_file_name=$pa0462a8e$pea5fed5d&path=$pa32be502&item_type=hibernate"; $pd65a9318 = array( "db_broker" => $this->pab752e34, "db_driver" => $this->v872f5b4dbb, "type" => $this->v6cc00e79ac, "st" => array($this->v9d7547e4d6), "sta" => array($this->v9d7547e4d6 => ""), "step_2" => true, "overwrite" => false, "with_maps" => false, "json" => true, ); $v806a006822 = $this->pdf77ee66->getURLContent($v6f3a2700dd, $pd65a9318); $v806a006822 = $v806a006822 ? json_decode($v806a006822, true) : $v806a006822; if ($v806a006822) { $v342a134247 = $v806a006822[0]; $pc45f4981 = $v342a134247[0]; $v7d733caff4 = $v972f1a5c2b->getLayerPathSetting() . $pc45f4981; if ($v7d733caff4 == $v8bdbb4d778) return true; } } } } } private function me176db5dc7d0($v7f5911d32d) { $v2b2cf4c0eb = $v7f5911d32d["broker_name"]; $pef1b7ad7 = $v7f5911d32d["bean_name"]; $pf2073d1f = $v7f5911d32d["bean_file_name"]; $v8773b3a63a = $v7f5911d32d["item_type"]; $v95eeadc9e9 = $v7f5911d32d["service"]; $v9d21f98a2c = $this->peb014cfd . "phpframework/businesslogic/get_business_logic_properties?bean_name=#bean_name#&bean_file_name=#bean_file_name#&path=#path#&service=#service#"; $pa0c6ce9a = $this->peb014cfd . "phpframework/dataaccess/get_query_properties?bean_name=#bean_name#&bean_file_name=#bean_file_name#&db_driver=#db_driver#&db_type=#db_type#&path=#path#&query_type=#query_type#&query=#query#&obj=#obj#&relationship_type=#relationship_type#"; $v6f3a2700dd = null; switch ($v8773b3a63a) { case "businesslogic": $v6f3a2700dd = $v9d21f98a2c; $v6f3a2700dd = str_replace("#bean_name#", $pef1b7ad7, $v6f3a2700dd); $v6f3a2700dd = str_replace("#bean_file_name#", $pf2073d1f, $v6f3a2700dd); $v6f3a2700dd = str_replace("#path#", $v95eeadc9e9["path"], $v6f3a2700dd); $v6f3a2700dd = str_replace("#service#", $v95eeadc9e9["service_id"], $v6f3a2700dd); break; case "ibatis": $v6f3a2700dd = $pa0c6ce9a; $v6f3a2700dd = str_replace("#bean_name#", $pef1b7ad7, $v6f3a2700dd); $v6f3a2700dd = str_replace("#bean_file_name#", $pf2073d1f, $v6f3a2700dd); $v6f3a2700dd = str_replace("#path#", $v95eeadc9e9["path"], $v6f3a2700dd); $v6f3a2700dd = str_replace("#db_driver#", $this->v872f5b4dbb, $v6f3a2700dd); $v6f3a2700dd = str_replace("#db_type#", $this->v6cc00e79ac, $v6f3a2700dd); $v6f3a2700dd = str_replace("#query_type#", $v95eeadc9e9["service_type"], $v6f3a2700dd); $v6f3a2700dd = str_replace("#query#", $v95eeadc9e9["service_id"], $v6f3a2700dd); $v6f3a2700dd = str_replace("#obj#", "", $v6f3a2700dd); $v6f3a2700dd = str_replace("#relationship_type#", "queries", $v6f3a2700dd); break; case "hibernate": $v6cd9d4006f = $v95eeadc9e9["service_method"]; $v05e3431fe2 = ""; $pc221318a = ""; $v79a6a00493 = array("insert", "insertAll", "update", "updateAll", "insertOrUpdate", "insertOrUpdateAll", "updatePrimaryKeys", "delete", "deleteAll", "findById", "find", "count"); $v7428330095 = array("findRelationships", "findRelationship", "countRelationships", "countRelationship"); $v83221819c2 = array("callInsertSQL", "callInsert", "callUpdateSQL", "callUpdate", "callDeleteSQL", "callDelete", "callSelectSQL", "callSelect", "callProcedureSQL", "callProcedure"); if (in_array($v6cd9d4006f, $v79a6a00493)) $v05e3431fe2 = "native"; else if (in_array($v6cd9d4006f, $v7428330095)) { $v6cd9d4006f = $v95eeadc9e9["sma_rel_name"]; $v05e3431fe2 = "relationships"; } else if (in_array($v6cd9d4006f, $v83221819c2)) { $v05e3431fe2 = "queries"; switch ($v6cd9d4006f) { case "callInsertSQL": case "callInsert": $pc221318a = "insert"; break; case "callUpdateSQL": case "callUpdate": $pc221318a = "update"; break; case "callDeleteSQL": case "callDelete": $pc221318a = "delete"; break; case "callSelectSQL": case "callSelect": $pc221318a = "select"; break; case "callProcedureSQL": case "callProcedure": $pc221318a = "procedure"; break; } } $v6f3a2700dd = $pa0c6ce9a; $v6f3a2700dd = str_replace("#bean_name#", $pef1b7ad7, $v6f3a2700dd); $v6f3a2700dd = str_replace("#bean_file_name#", $pf2073d1f, $v6f3a2700dd); $v6f3a2700dd = str_replace("#path#", $v95eeadc9e9["path"], $v6f3a2700dd); $v6f3a2700dd = str_replace("#db_driver#", $this->v872f5b4dbb, $v6f3a2700dd); $v6f3a2700dd = str_replace("#db_type#", $this->v6cc00e79ac, $v6f3a2700dd); $v6f3a2700dd = str_replace("#query_type#", $pc221318a, $v6f3a2700dd); $v6f3a2700dd = str_replace("#query#", $v6cd9d4006f, $v6f3a2700dd); $v6f3a2700dd = str_replace("#obj#", $v95eeadc9e9["service_id"], $v6f3a2700dd); $v6f3a2700dd = str_replace("#relationship_type#", $v05e3431fe2, $v6f3a2700dd); break; } if ($v6f3a2700dd) { $v9b391a5b1f = $this->pdf77ee66->getURLContent($v6f3a2700dd); $v9b391a5b1f = json_decode($v9b391a5b1f, true); if ($v9b391a5b1f) { $v90f6a96b61 = array(); foreach ($v9b391a5b1f as $v67ccb03f4c => $v9a52216fbf) $v90f6a96b61[] = array( "key" => $v67ccb03f4c, "key_type" => "string", "value" => "", "value_type" => $v9a52216fbf ); $pe9543d36 = "parameters"; if ($v8773b3a63a == "hibernate") { $v7428330095 = array("findRelationships", "findRelationship", "countRelationships", "countRelationship"); $pe9543d36 = "sma_data"; if (in_array($v95eeadc9e9["service_method"], $v7428330095)) $pe9543d36 = "sma_parent_ids"; } $v95eeadc9e9[$pe9543d36 . "_type"] = "array"; $v95eeadc9e9[$pe9543d36] = $v90f6a96b61; $v7f5911d32d["service"] = $v95eeadc9e9; } } return $v7f5911d32d; } private function f1c48bf15e3($v7f5911d32d, $v99242dea8e) { $v8773b3a63a = $v7f5911d32d["item_type"]; $v95eeadc9e9 = $v7f5911d32d["service"]; $v99242dea8e = substr($v99242dea8e, 0, 1) == '$' ? $v99242dea8e : '$' . $v99242dea8e; if ($v8773b3a63a == "db") { $v3c76382d93 = $v95eeadc9e9["sql"]; if ($v3c76382d93) { preg_match_all("/#([^#]+)#/", $v3c76382d93, $pbae7526c, PREG_PATTERN_ORDER); if ($pbae7526c && $pbae7526c[0]) { for ($v43dd7d0051 = 0, $pc37695cb = count($pbae7526c[0]); $v43dd7d0051 < $pc37695cb; $v43dd7d0051++) { $v6107abf109 = $pbae7526c[0][$v43dd7d0051]; $v5e813b295b = str_replace("#", "", $v6107abf109); $v67db1bd535 = '{' . $v99242dea8e . '[\'' . $v5e813b295b . '\']}'; $v3c76382d93 = str_replace($v6107abf109, $v67db1bd535, $v3c76382d93); } } $v95eeadc9e9["sql"] = trim($v3c76382d93); } else if ($v7f5911d32d["is_db_dao_action_task"]) { $pf72c1d58 = array( "attributes" => $v95eeadc9e9["attributes"], "conditions" => $v95eeadc9e9["conditions"] ); foreach ($pf72c1d58 as $v3fb9f41470 => $paaf86679) if (is_array($paaf86679)) { foreach ($paaf86679 as $pd69fb7d0 => $v58b61e02bc) { $v5e813b295b = $v58b61e02bc["key"]; $v67db1bd535 = $v58b61e02bc["value"]; preg_match_all("/#([^#]+)#/", $v67db1bd535, $pbae7526c, PREG_PATTERN_ORDER); if ($pbae7526c && $pbae7526c[0]) { for ($v43dd7d0051 = 0, $pc37695cb = count($pbae7526c[0]); $v43dd7d0051 < $pc37695cb; $v43dd7d0051++) { $v6107abf109 = $pbae7526c[0][$v43dd7d0051]; $v5e813b295b = str_replace("#", "", $v6107abf109); $v956913c90f = '{' . $v99242dea8e . '[\'' . $v5e813b295b . '\']}'; $v67db1bd535 = str_replace($v6107abf109, $v956913c90f, $v67db1bd535); } $v95eeadc9e9[$v3fb9f41470][$pd69fb7d0]["value_type"] = "string"; $v95eeadc9e9[$v3fb9f41470][$pd69fb7d0]["value"] = $v67db1bd535; } } } } } else { $pe9543d36 = "parameters"; if ($v8773b3a63a == "hibernate") { $v7428330095 = array("findRelationships", "findRelationship", "countRelationships", "countRelationship"); $pe9543d36 = "sma_data"; if (in_array($v95eeadc9e9["service_method"], $v7428330095)) $pe9543d36 = "sma_parent_ids"; $v95eeadc9e9["sma_ids"] = "ids"; $v95eeadc9e9["sma_ids_type"] = "variable"; } $pf72c1d58 = $v95eeadc9e9[$pe9543d36]; if (is_array($pf72c1d58)) { foreach ($pf72c1d58 as $pd69fb7d0 => $v58b61e02bc) { $v5e813b295b = $v58b61e02bc["key"]; $pf72c1d58[$pd69fb7d0]["value_type"] = ""; $pf72c1d58[$pd69fb7d0]["value"] = $v99242dea8e . '[\'' . $v5e813b295b . '\']'; } $v95eeadc9e9[$pe9543d36] = $pf72c1d58; } } $v7f5911d32d["service"] = $v95eeadc9e9; return $v7f5911d32d; } private function f113a7331a6($v7f5911d32d) { $v8773b3a63a = $v7f5911d32d["item_type"]; if ($v8773b3a63a == "businesslogic" || $v8773b3a63a == "ibatis") { $v7f5911d32d["service"]["parameters"] = "data"; $v7f5911d32d["service"]["parameters_type"] = "variable"; } else if ($v8773b3a63a == "hibernate") { $v7f5911d32d["service"]["sma_data"] = "data"; $v7f5911d32d["service"]["sma_data_type"] = "variable"; } else if ($v8773b3a63a == "db" && $v7f5911d32d["service"]["sql"] && $v7f5911d32d["service"]["sql_type"] == "string") $v7f5911d32d["service"]["sql"] .= ' WHERE $conds'; else if ($v8773b3a63a == "db" && $v7f5911d32d["is_db_dao_action_task"]) { $v7f5911d32d["service"]["conditions"] = "conditions"; $v7f5911d32d["service"]["conditions_type"] = "variable"; if (($v7f5911d32d["service"]["options_type"] != "variable" || !trim($v7f5911d32d["service"]["options"])) && !is_array($v7f5911d32d["service"]["options"])) $v7f5911d32d["service"]["options"] = array(); if (is_array($v7f5911d32d["service"]["options"])) $v7f5911d32d["service"]["options"][] = array( "key" => "conditions_join", "key_type" => "string", "value" => "conditions_join", "value_type" => "variable", ); } return $v7f5911d32d; } private function mf40bb6b42dc9($v7f5911d32d) { $v8773b3a63a = $v7f5911d32d["item_type"]; $v5d3813882f = $v8773b3a63a == "hibernate" ? $v7f5911d32d["service"]["sma_options"] : $v7f5911d32d["service"]["options"]; $v6f41d73021 = $v8773b3a63a == "hibernate" ? $v7f5911d32d["service"]["sma_options_type"] : $v7f5911d32d["service"]["options_type"]; if (!is_array($v5d3813882f)) { $v5d3813882f = array(); $v6f41d73021 = "array"; } $v5d3813882f[] = array( "key" => "limit", "key_type" => "string", "value" => "limit", "value_type" => "variable", ); $v5d3813882f[] = array( "key" => "start", "key_type" => "string", "value" => "start", "value_type" => "variable", ); if ($v8773b3a63a == "hibernate") { $v7f5911d32d["service"]["sma_options"] = $v5d3813882f; $v7f5911d32d["service"]["sma_options_type"] = $v6f41d73021; } else { $v7f5911d32d["service"]["options"] = $v5d3813882f; $v7f5911d32d["service"]["options_type"] = $v6f41d73021; } return $v7f5911d32d; } private function f3b97005c4d($v7f5911d32d) { $v8773b3a63a = $v7f5911d32d["item_type"]; $v5d3813882f = $v8773b3a63a == "hibernate" ? $v7f5911d32d["service"]["sma_options"] : $v7f5911d32d["service"]["options"]; $v6f41d73021 = $v8773b3a63a == "hibernate" ? $v7f5911d32d["service"]["sma_options_type"] : $v7f5911d32d["service"]["options_type"]; if (!is_array($v5d3813882f)) { $v5d3813882f = array(); $v6f41d73021 = "array"; } $v5d3813882f[] = array( "key" => "sort", "key_type" => "string", "value" => "sort", "value_type" => "variable", ); if ($v8773b3a63a == "hibernate") { $v7f5911d32d["service"]["sma_options"] = $v5d3813882f; $v7f5911d32d["service"]["sma_options_type"] = $v6f41d73021; } else { $v7f5911d32d["service"]["options"] = $v5d3813882f; $v7f5911d32d["service"]["options_type"] = $v6f41d73021; } return $v7f5911d32d; } private function f0cddec28ef($v7f5911d32d) { $v8773b3a63a = $v7f5911d32d["item_type"]; $v5d3813882f = $v8773b3a63a == "hibernate" ? $v7f5911d32d["service"]["sma_options"] : $v7f5911d32d["service"]["options"]; if (is_array($v5d3813882f)) foreach ($v5d3813882f as $pd69fb7d0 => $pe238ca78) if ($pe238ca78["key"] == "no_cache" && $pe238ca78["key_type"] == "string") { $v5d3813882f[$pd69fb7d0]["value"] = "no_cache"; $v5d3813882f[$pd69fb7d0]["value_type"] = "variable"; break; } if ($v8773b3a63a == "hibernate") $v7f5911d32d["service"]["sma_options"] = $v5d3813882f; else $v7f5911d32d["service"]["options"] = $v5d3813882f; return $v7f5911d32d; } private function mf8451bbed9de($v7f5911d32d) { $v2b2cf4c0eb = $v7f5911d32d["broker_name"]; $v8773b3a63a = $v7f5911d32d["item_type"]; switch ($v8773b3a63a) { case "businesslogic": return $this->v7a0994a134["business_logic_brokers_obj"][$v2b2cf4c0eb]; case "ibatis": return $this->v7a0994a134["ibatis_brokers_obj"][$v2b2cf4c0eb]; case "hibernate": return $this->v7a0994a134["hibernate_brokers_obj"][$v2b2cf4c0eb]; case "db": return $this->v7a0994a134["db_brokers_obj"][$v2b2cf4c0eb]; } return null; } private function f23e499c06b($v7f5911d32d) { $v8773b3a63a = $v7f5911d32d["item_type"]; $v067674f4e4 = '//prepare $conditions based in $conditions_type: starts_with or ends_with
if ($conditions && $conditions_type)
	foreach ($conditions as $attribute_name => $attribute_value) {
		$attribute_condition_type = is_array($conditions_type) ? $conditions_type[$attribute_name] : $conditions_type;
		$attribute_operator = $attribute_condition_type == "starts_with" || $attribute_condition_type == "ends_with" || $attribute_condition_type == "contains" ? "like" : $attribute_condition_type;
		
		if ($attribute_operator && $attribute_operator != "=" && $attribute_operator != "equal")
			$conditions[$attribute_name] = array(
				"operator" => $attribute_operator,
				"value" => ($attribute_condition_type == "starts_with" || $attribute_condition_type == "contains" ? "%" : "") . $attribute_value . ($attribute_condition_type == "ends_with" || $attribute_condition_type == "contains" ? "%" : ""),
			);
	}
'; if ($v8773b3a63a == "businesslogic" || $v8773b3a63a == "hibernate") $v067674f4e4 .= '
$data = array(
	"conditions" => $conditions,
	"conditions_join" => $conditions_join
);
'; else if ($v8773b3a63a == "ibatis") $v067674f4e4 .= '
$conds = DB::getSQLConditions($conditions, $conditions_join);
$data = array("conditions" => $conds);
'; else if ($v8773b3a63a == "db") { if ($v7f5911d32d["sql"]) $v067674f4e4 .= '
$conds = DB::getSQLConditions($conditions, $conditions_join);
$conds = $conds ? $conds : "1=1";
'; else if ($v7f5911d32d["is_db_dao_action_task"] && $v7f5911d32d["service"]["options_type"] == "variable" && trim($v7f5911d32d["service"]["options"])) { $v7bcc9f32ad = trim($v7f5911d32d["service"]["options"]); $v7bcc9f32ad = substr($v7bcc9f32ad, 0, 1) == '$' ? $v7bcc9f32ad : '$' . $v7bcc9f32ad; $v067674f4e4 .= '
' . $v7bcc9f32ad . ' = is_array(' . $v7bcc9f32ad . ') ? ' . $v7bcc9f32ad . ' : array();
' . $v7bcc9f32ad . '["conditions_join"] = $conditions_join;
'; } } return $v067674f4e4; } private function f13f8d8d24f($v256e3a39a7, $v7f5911d32d, $pc839a6ca, $pdcf670f6 = "") { $pbc3d57ef = $v7f5911d32d["item_type"] == "db" && $v7f5911d32d["is_db_dao_action_task"] ? "dbdaoaction" : self::mc69510f15f43($v256e3a39a7, $v7f5911d32d["item_type"]); $v575c44b71f = self::f1ed784ed09($this->pecad7cca, $pbc3d57ef, $v7f5911d32d["service"]); if ($v575c44b71f) { if ($pdcf670f6) $v575c44b71f = str_replace("\n", "\n$pdcf670f6", $v575c44b71f); $v067674f4e4 = $pc839a6ca . "->" . trim($v575c44b71f); } return $v067674f4e4; } private static function f38ffbf7279($v256e3a39a7) { $v603bd47baf = self::mbe3c4fe09eee($v256e3a39a7); return strtolower(substr($v603bd47baf, 0, 1)) . substr($v603bd47baf, 1); } private static function mbe3c4fe09eee($v9d7547e4d6) { return str_replace(" ", "", self::f4d6b9d6caa($v9d7547e4d6)); } private static function f4d6b9d6caa($v5e813b295b) { return ucwords(strtolower(str_replace(array("-", "_"), " ", $v5e813b295b))); } private static function md5eeb6f57c24($pfb662071) { return is_array($pfb662071) && array_keys($pfb662071) !== range(0, count($pfb662071) - 1); } private static function f429ff68f21($pef34936b) { $v22fcc5754f = array(); $v02a69d4e0f = null; if ($pef34936b) { if (is_string($pef34936b) || is_numeric($pef34936b) || !self::md5eeb6f57c24(($pef34936b))) $v02a69d4e0f = is_array($pef34936b) ? $pef34936b : array($pef34936b); else if (is_array($pef34936b)) foreach ($pef34936b as $pe5c5e2fe => $v956913c90f) if ($pe5c5e2fe == "access" || $pe5c5e2fe == "view" || $pe5c5e2fe == "show") { if (is_string($v956913c90f) || is_numeric($v956913c90f) || !self::md5eeb6f57c24($v956913c90f)) $v02a69d4e0f = is_array($v956913c90f) ? $v956913c90f : array($v956913c90f); else if (is_array($v956913c90f) && $v956913c90f["user_type_ids"]) $v02a69d4e0f = is_array($v956913c90f["user_type_ids"]) ? $v956913c90f["user_type_ids"] : array($v956913c90f["user_type_ids"]); } } if (is_array($v02a69d4e0f)) foreach ($v02a69d4e0f as $v6bbd1726b0) if (is_numeric($v6bbd1726b0)) $v22fcc5754f[] = $v6bbd1726b0; return $v22fcc5754f; } private static function f30561a4102($pef34936b) { if ($pef34936b) { if (self::md5eeb6f57c24($pef34936b)) foreach ($pef34936b as $pe5c5e2fe => $v956913c90f) if ($pe5c5e2fe == "access" || $pe5c5e2fe == "view" || $pe5c5e2fe == "show") { if (self::md5eeb6f57c24($v956913c90f) && $v956913c90f["resources"]) $pa4b7bec5 = is_array($v956913c90f["resources"]) ? $v956913c90f["resources"] : array($v956913c90f["resources"]); $v04a366a14b = array(); for ($v43dd7d0051 = 0; $v43dd7d0051 < count($pa4b7bec5); $v43dd7d0051++) { $v3c238d643b = $pa4b7bec5[$v43dd7d0051]; $v69013e2fd6 = $v3c238d643b; if (self::md5eeb6f57c24($v3c238d643b)) $v69013e2fd6 = $v3c238d643b["name"]; if ($v69013e2fd6) $v04a366a14b[] = $v3c238d643b; } return $v04a366a14b; } } return null; } private static function me27f08e0aa1a($pecad7cca, $v256e3a39a7, $v7f5911d32d) { $v8773b3a63a = $v7f5911d32d["item_type"]; $v95eeadc9e9 = $v7f5911d32d["service"]; switch ($v8773b3a63a) { case "businesslogic": case "ibatis": if (!empty($v95eeadc9e9["options"])) { $v95eeadc9e9["parameters"] = null; $v95eeadc9e9["parameters_type"] = ""; $pbc3d57ef = self::mc69510f15f43($v256e3a39a7, $v8773b3a63a); $v067674f4e4 = self::f1ed784ed09($pecad7cca, $pbc3d57ef, $v95eeadc9e9); if ($v067674f4e4) { $pbd1bc7b0 = strpos($v067674f4e4, '", null, '); $v5d3813882f = substr($v067674f4e4, $pbd1bc7b0 + 9, -1); } } break; case "hibernate": if (!empty($v95eeadc9e9["sma_options"])) { $pbc3d57ef = self::mc69510f15f43($v256e3a39a7, $v8773b3a63a); $v70bc60625e = self::f1ed784ed09($pecad7cca, $pbc3d57ef, $v95eeadc9e9); $v95eeadc9e9["sma_options"] = null; $v95eeadc9e9["sma_options_type"] = ""; $v308ab1b9a5 = self::f1ed784ed09($pecad7cca, $pbc3d57ef, $v95eeadc9e9); if ($v70bc60625e && $v308ab1b9a5) { $v308ab1b9a5 = substr(trim($v308ab1b9a5), 0, -1); $v70bc60625e = substr(trim($v70bc60625e), 0, -1); $v70bc60625e = trim( str_replace($v308ab1b9a5, "", $v70bc60625e) ); $v70bc60625e = substr($v70bc60625e, 0, 1) == "," ? substr($v70bc60625e, 1) : $v70bc60625e; $v5d3813882f = trim($v70bc60625e); } } break; case "db": if (!empty($v95eeadc9e9["options"])) { $v95eeadc9e9["sql"] = "test"; $v95eeadc9e9["sql_type"] = "variable"; $pbc3d57ef = self::mc69510f15f43($v256e3a39a7, $v8773b3a63a); $v067674f4e4 = self::f1ed784ed09($pecad7cca, $pbc3d57ef, $v95eeadc9e9); if ($v067674f4e4) { $pbd1bc7b0 = strpos($v067674f4e4, '($test, '); $v5d3813882f = substr($v067674f4e4, $pbd1bc7b0 + 8, -1); } } break; } return isset($v5d3813882f) && $v5d3813882f != "null" ? $v5d3813882f : ""; } private static function f1ed784ed09($pecad7cca, $pbc3d57ef, $pe927264a) { $v7f5911d32d = $pecad7cca->getTasksByTag($pbc3d57ef); $v7f5911d32d = $v7f5911d32d[0]; if ($v7f5911d32d) { $v7f5911d32d["properties"] = $pe927264a; $v7f5911d32d["obj"]->data = $v7f5911d32d; $v067674f4e4 = trim( $v7f5911d32d["obj"]->printCode(null, null) ); $v067674f4e4 = substr($v067674f4e4, -1) == ";" ? substr($v067674f4e4, 0, -1) : $v067674f4e4; return $v067674f4e4; } return ""; } private static function mc69510f15f43($v256e3a39a7, $v8773b3a63a) { $v36d0e6b895 = in_array($v256e3a39a7, array("insert", "update", "update_attribute", "multiple_save", "delete", "multiple_delete")); switch ($v8773b3a63a) { case "businesslogic": return "callbusinesslogic"; case "ibatis": return "callibatisquery"; case "hibernate": return "callhibernatemethod"; case "db": return $v36d0e6b895 ? "setquerydata" : "getquerydata"; } return null; } private static function mdc413c65370d($v7f5911d32d) { return in_array($v7f5911d32d["item_type"], array("ibatis", "hibernate", "db")); } private static function f5716ef881e($v9d7547e4d6, $pac4bc40a, $v78108bc88f) { if (!is_array($v78108bc88f)) $v78108bc88f = array(array("table" => $v9d7547e4d6)); else if (array_key_exists("table", $v78108bc88f)) $v78108bc88f = array($v78108bc88f); $v1239d19a31 = WorkFlowDataAccessHandler::getTableAttributeFKTable($v78108bc88f, $pac4bc40a); $pf71bb87b = $v1239d19a31["table"]; $v50bb61a728 = $v1239d19a31["attribute"]; $v65f81ba9af = $pf71bb87b ? WorkFlowDBHandler::getTableFromTables($pac4bc40a, $pf71bb87b) : null; if (!$v50bb61a728 && $v65f81ba9af) { $v50bb61a728 = array(); foreach ($v65f81ba9af as $v5e45ec9bb9 => $v1b0cfa478b) if ($v1b0cfa478b["primary_key"]) $v50bb61a728[] = $v5e45ec9bb9; } if ($v50bb61a728) { $v83030c1a8d = $v65f81ba9af ? WorkFlowDataAccessHandler::getTableAttrTitle($v65f81ba9af, $pf71bb87b) : null; $v83030c1a8d = $v83030c1a8d ? $v83030c1a8d : $v50bb61a728; $v9994512d98 = is_array($v50bb61a728) ? $v50bb61a728 : array($v50bb61a728); $v76b0aa2076 = is_array($v83030c1a8d) ? $v83030c1a8d : array($v83030c1a8d); return array( "keys" => $v9994512d98, "values" => $v76b0aa2076, ); } return null; } private static function f0dec7450c7($pac4bc40a, $v8c5df8072b, $pfdbbc383, $v7f5911d32d, $pecad7cca, $pc839a6ca, $v99242dea8e, $v29a1267fee = true) { $v067674f4e4 = ""; $v99242dea8e = substr($v99242dea8e, 0, 1) == '$' ? $v99242dea8e : '$' . $v99242dea8e; $ped0a6251 = WorkFlowDBHandler::getTableFromTables($pac4bc40a, $v8c5df8072b); $v74d327ce31 = self::mdc413c65370d($v7f5911d32d); foreach ($pfdbbc383 as $v5e45ec9bb9) { $v1b0cfa478b = $ped0a6251[$v5e45ec9bb9]; $v9abfb1e31c = !isset($v1b0cfa478b["null"]) || $v1b0cfa478b["null"]; if ($v29a1267fee && $v1b0cfa478b["primary_key"] && WorkFlowDataAccessHandler::isAutoIncrementedAttribute($v1b0cfa478b)) { $v067674f4e4 .= self::md2839901f6a8($v8c5df8072b, $v5e45ec9bb9, $v1b0cfa478b, $v7f5911d32d, $pecad7cca, $pc839a6ca, $v99242dea8e); } else if ($v9abfb1e31c && (ObjTypeHandler::isDBTypeNumeric($v1b0cfa478b["type"]) || ObjTypeHandler::isPHPTypeNumeric($v1b0cfa478b["type"]) || ObjTypeHandler::isDBTypeDate($v1b0cfa478b["type"]))) { if ($v74d327ce31) $v067674f4e4 .= 'if (array_key_exists("' . $v5e45ec9bb9 . '", ' . $v99242dea8e . ') && !strlen(trim(' . $v99242dea8e . '["' . $v5e45ec9bb9 . '"]))) ' . $v99242dea8e . '["' . $v5e45ec9bb9 . '"] = ' . (strlen($v1b0cfa478b["default"]) ? '"' . $v1b0cfa478b["default"] . '"' : (ObjTypeHandler::isDBTypeDate($v1b0cfa478b["type"]) ? 'null' : '"DEFAULT"')) . ';' . "\n"; else $v067674f4e4 .= 'if (array_key_exists("' . $v5e45ec9bb9 . '", ' . $v99242dea8e . ') && !strlen(trim(' . $v99242dea8e . '["' . $v5e45ec9bb9 . '"]))) ' . $v99242dea8e . '["' . $v5e45ec9bb9 . '"] = null;' . "\n"; } else if ($v74d327ce31 && (ObjTypeHandler::isDBTypeNumeric($v1b0cfa478b["type"]) || ObjTypeHandler::isPHPTypeNumeric($v1b0cfa478b["type"]))) { if ($v1b0cfa478b["primary_key"]) $v067674f4e4 .= 'if (array_key_exists("' . $v5e45ec9bb9 . '", ' . $v99242dea8e . ') && !is_numeric(' . $v99242dea8e . '["' . $v5e45ec9bb9 . '"])) ' . $v99242dea8e . '["' . $v5e45ec9bb9 . '"] = "null";' . "\n"; else $v067674f4e4 .= 'if (array_key_exists("' . $v5e45ec9bb9 . '", ' . $v99242dea8e . ') && !strlen(trim(' . $v99242dea8e . '["' . $v5e45ec9bb9 . '"]))) ' . $v99242dea8e . '["' . $v5e45ec9bb9 . '"] = ' . (strlen($v1b0cfa478b["default"]) ? '"' . $v1b0cfa478b["default"] . '"' : '"DEFAULT"') . ';' . "\n"; } else if ($v7f5911d32d["item_type"] == "businesslogic" && (ObjTypeHandler::isDBTypeNumeric($v1b0cfa478b["type"]) || ObjTypeHandler::isPHPTypeNumeric($v1b0cfa478b["type"]) || ObjTypeHandler::isDBTypeBoolean($v1b0cfa478b["type"]))) { $v067674f4e4 .= 'if (array_key_exists("' . $v5e45ec9bb9 . '", ' . $v99242dea8e . ') && !is_numeric(' . $v99242dea8e . '["' . $v5e45ec9bb9 . '"])) ' . $v99242dea8e . '["' . $v5e45ec9bb9 . '"] = ' . (strlen($v1b0cfa478b["default"]) ? '"' . $v1b0cfa478b["default"] . '"' : 'null') . ';' . "\n"; } } return $v067674f4e4; } private static function md2839901f6a8($v8c5df8072b, $v5e45ec9bb9, $v1b0cfa478b, $v7f5911d32d, $pecad7cca, $pc839a6ca, $v99242dea8e) { $v8773b3a63a = $v7f5911d32d["item_type"]; $v95eeadc9e9 = $v7f5911d32d["service"]; $v539082ff30 = null; $v99242dea8e = substr($v99242dea8e, 0, 1) == '$' ? $v99242dea8e : '$' . $v99242dea8e; if ($v8773b3a63a == "ibatis" && $v95eeadc9e9["service_type"] == "insert") $v539082ff30 = $v95eeadc9e9["parameters"]; else if ($v8773b3a63a == "db") { if ($v95eeadc9e9["sql"]) $v539082ff30 = $v95eeadc9e9["sql"]; else if ($v7f5911d32d["is_db_dao_action_task"]) $v539082ff30 = $v95eeadc9e9["attributes"]; } else if ($v8773b3a63a == "hibernate" && ($v95eeadc9e9["service_method"] == "getData" || $v95eeadc9e9["service_method"] == "setData")) $v539082ff30 = $v95eeadc9e9["sma_sql"]; else if ($v8773b3a63a == "hibernate" && ($v95eeadc9e9["service_method"] == "insert" || $v95eeadc9e9["service_method"] == "callInsert")) $v539082ff30 = $v95eeadc9e9["sma_data"]; else if ($v8773b3a63a == "hibernate" && $v95eeadc9e9["service_method"] == "callQuery" && $v95eeadc9e9["sma_query_type"] == "insert") $v539082ff30 = $v95eeadc9e9["sma_data"]; $v7959970a41 = false; if ($v539082ff30) { if (is_array($v539082ff30)) { foreach ($v539082ff30 as $v342a134247) { if (array_key_exists("value", $v342a134247) && $v342a134247["value_type"] == "string" && ( $v342a134247["value"] == $v99242dea8e . "['$v5e45ec9bb9']" || $v342a134247["value"] == $v99242dea8e . '["' . $v5e45ec9bb9 . '"]' || strpos($v342a134247["value"], '{' . $v99242dea8e . '["' . $v5e45ec9bb9 . '"]}') !== false || strpos($v342a134247["value"], "{" . $v99242dea8e . "['" . $v5e45ec9bb9 . "']}") !== false )) { $v7959970a41 = true; break; } } } else { $pa8db77e3 = DB::convertDefaultSQLToObject($v539082ff30); if ($pa8db77e3["type"] == "insert" && $pa8db77e3["attributes"]) foreach ($pa8db77e3["attributes"] as $v1b0cfa478b) if ($v1b0cfa478b["column"] == $v5e45ec9bb9) { $v7959970a41 = true; break; } } } if ($v7959970a41) { $v5d3813882f = self::me27f08e0aa1a($pecad7cca, "insert", $v7f5911d32d); $v5d3813882f = $v5d3813882f ? str_replace("\n", "\n\t", $v5d3813882f) : "null"; return 'if (!strlen(trim(' . $v99242dea8e . '["' . $v5e45ec9bb9 . '"]))) 
	' . $v99242dea8e . '["' . $v5e45ec9bb9 . '"] = ' . $pc839a6ca . '->findObjectsColumnMax("' . $v8c5df8072b . '", "' . $v5e45ec9bb9 . '", ' . $v5d3813882f . ');' . "\n"; } return ""; } private static function mcfcf1f6200e9($pe54f8a0f, $v7f5911d32d, $pecad7cca, $pc839a6ca, $v99242dea8e) { $v067674f4e4 = ""; $v99242dea8e = substr($v99242dea8e, 0, 1) == '$' ? $v99242dea8e : '$' . $v99242dea8e; if ($pe54f8a0f) { $v8773b3a63a = $v7f5911d32d["item_type"]; $v95eeadc9e9 = $v7f5911d32d["service"]; $v74d327ce31 = self::mdc413c65370d($v7f5911d32d); if ($v8773b3a63a == "hibernate" && $v95eeadc9e9["service_method"] == "insert") { $v0dd1ae6fbd = $v95eeadc9e9["sma_ids"]; $v597dd8d456 = $pe54f8a0f[0]; $v067674f4e4 .= $v99242dea8e . ' = $' . $v0dd1ae6fbd . '["' . $v597dd8d456 . '"];'; } else if ($v74d327ce31 && $pe54f8a0f) { $v5d3813882f = self::me27f08e0aa1a($pecad7cca, "insert", $v7f5911d32d); $v067674f4e4 .= $v99242dea8e . ' = ' . $pc839a6ca . '->getInsertedId(' . $v5d3813882f . ');'; } } if ($v067674f4e4) $v067674f4e4 = '
if (' . $v99242dea8e . ') {
	' . $v067674f4e4 . '
}'; return $v067674f4e4; } private static function f8494219158($pac4bc40a, $v8c5df8072b, $pfdbbc383, $v7f5911d32d, $pecad7cca, $pc839a6ca, $v99242dea8e) { $v067674f4e4 = self::f0dec7450c7($pac4bc40a, $v8c5df8072b, $pfdbbc383, $v7f5911d32d, $pecad7cca, $pc839a6ca, $v99242dea8e, false); $ped0a6251 = WorkFlowDBHandler::getTableFromTables($pac4bc40a, $v8c5df8072b); foreach ($pfdbbc383 as $v5e45ec9bb9) { $v1b0cfa478b = $ped0a6251[$v5e45ec9bb9]; if ($v1b0cfa478b["primary_key"]) { if (ObjTypeHandler::isDBTypeNumeric($v1b0cfa478b["type"]) || ObjTypeHandler::isPHPTypeNumeric($v1b0cfa478b["type"])) $v067674f4e4 .= 'if (array_key_exists("' . $v5e45ec9bb9 . '", ' . $v99242dea8e . ') && !is_numeric(' . $v99242dea8e . '["' . $v5e45ec9bb9 . '"])) $status = false;' . "\n"; else $v067674f4e4 .= 'if (array_key_exists("' . $v5e45ec9bb9 . '", ' . $v99242dea8e . ') && !strlen(trim(' . $v99242dea8e . '["' . $v5e45ec9bb9 . '"]))) $status = false;' . "\n"; } } return $v067674f4e4; } private static function mc08d0548215f($v99242dea8e) { return ""; $v99242dea8e = substr($v99242dea8e, 0, 1) == '$' ? $v99242dea8e : '$' . $v99242dea8e; return '
if (' . $v99242dea8e . ') {
	$hbn_object_name = array_keys(' . $v99242dea8e . ');
	$hbn_object_name = $hbn_object_name[0];
' . $v99242dea8e . ' = ' . $v99242dea8e . '[$hbn_object_name];
}
'; } private static function mec94a53cc185($pac4bc40a, $v8c5df8072b, $v99242dea8e) { $v067674f4e4 = ""; $ped0a6251 = WorkFlowDBHandler::getTableFromTables($pac4bc40a, $v8c5df8072b); $v99242dea8e = substr($v99242dea8e, 0, 1) == '$' ? $v99242dea8e : '$' . $v99242dea8e; foreach ($ped0a6251 as $v5e45ec9bb9 => $v1b0cfa478b) if (ObjTypeHandler::isDBTypeDate($v1b0cfa478b["type"])) $v067674f4e4 .= 'if (' . $v99242dea8e . '["' . $v5e45ec9bb9 . '"] == "0000-00-00 00:00:00" || ' . $v99242dea8e . '["' . $v5e45ec9bb9 . '"] == "0000-00-00") ' . $v99242dea8e . '["' . $v5e45ec9bb9 . '"] = "";' . "\n"; return $v067674f4e4; } private static function f58aba253ab($v99242dea8e) { return ""; $v99242dea8e = substr($v99242dea8e, 0, 1) == '$' ? $v99242dea8e : '$' . $v99242dea8e; return '
if (' . $v99242dea8e . ') {
	$hbn_object_name = array_keys(' . $v99242dea8e . '[0]);
	$hbn_object_name = $hbn_object_name[0];

	$items = array();
	$t = count(' . $v99242dea8e . ');

	for ($i = 0; $i < $t; $i++)
		$items[] = ' . $v99242dea8e . '[$i][$hbn_object_name];

	' . $v99242dea8e . ' = $items;
}
'; } private static function f1a0f95fcd7($pac4bc40a, $v8c5df8072b, $v99242dea8e) { $ped0a6251 = WorkFlowDBHandler::getTableFromTables($pac4bc40a, $v8c5df8072b); $v0f707090f0 = array(); $v99242dea8e = substr($v99242dea8e, 0, 1) == '$' ? $v99242dea8e : '$' . $v99242dea8e; foreach ($ped0a6251 as $v5e45ec9bb9 => $v1b0cfa478b) if (ObjTypeHandler::isDBTypeDate($v1b0cfa478b["type"])) $v0f707090f0[] = $v5e45ec9bb9; if ($v0f707090f0) { $v067674f4e4 = 'if (is_array(' . $v99242dea8e . '))
	foreach (' . $v99242dea8e . ' as $k => &$v) {' . "\n"; foreach ($v0f707090f0 as $v5e45ec9bb9) $v067674f4e4 .= "\t\t" . 'if ($v["' . $v5e45ec9bb9 . '"] == "0000-00-00 00:00:00" || $v["' . $v5e45ec9bb9 . '"] == "0000-00-00") $v["' . $v5e45ec9bb9 . '"] = "";' . "\n"; $v067674f4e4 .= "\t}\n"; return $v067674f4e4; } return null; } private static function f9e1b56b7f9(&$v7f5911d32d, $pac4bc40a) { $v8773b3a63a = $v7f5911d32d["item_type"]; $v95eeadc9e9 = $v7f5911d32d["service"]; if ($v8773b3a63a == "db") { $v539082ff30 = null; $pab9d8506 = "select"; if ($v95eeadc9e9["sql"]) { $v539082ff30 = DB::convertDefaultSQLToObject($v95eeadc9e9["sql"]); $pab9d8506 = $v539082ff30 ? $v539082ff30["type"] : null; } $pf8a51df0 = $pab9d8506 == "insert" || $pab9d8506 == "update" || $pab9d8506 == "delete" || $pab9d8506 == "select"; if ($pf8a51df0) { if ($v539082ff30) { $v539082ff30["main_table"] = $v539082ff30["table"]; $pc6a840f3 = DB::convertObjectToDefaultSQL($v539082ff30); $v65a396e40d = array( "type" => $v539082ff30["type"], "main_table" => $v539082ff30["main_table"], "attributes" => $v539082ff30["attributes"], "conditions" => $v539082ff30["conditions"], "limit" => $v539082ff30["limit"], "start" => $v539082ff30["start"], ); $v7eab668a0b = DB::convertObjectToDefaultSQL($v65a396e40d); $v2311710c25 = $v7eab668a0b == $pc6a840f3 && (!$v539082ff30["limit"] || !$v95eeadc9e9["options"] || is_array($v95eeadc9e9["options"])); if ($v2311710c25) { if ($v539082ff30["type"] == "select" && $v539082ff30["attributes"] && $pac4bc40a[ $v539082ff30["table"] ]) foreach ($v539082ff30["attributes"] as $v1b0cfa478b) if (!$pac4bc40a[ $v539082ff30["table"] ][ $v1b0cfa478b["column"] ]) { $v2311710c25 = false; break; } if ($v539082ff30["type"] == "select" && ($v539082ff30["keys"] || $v539082ff30["groups_by"] || $v539082ff30["sorts"])) $v2311710c25 = false; if ($v539082ff30["conditions"] && ($v539082ff30["type"] == "update" || $v539082ff30["type"] == "delete" || $v539082ff30["type"] == "select")) foreach ($v539082ff30["conditions"] as $v1b0cfa478b) if ($v1b0cfa478b["operator"] && $v1b0cfa478b["operator"] != "=") { $v2311710c25 = false; break; } if ($v2311710c25) { unset($v95eeadc9e9["sql"]); unset($v95eeadc9e9["sql_type"]); if ($v539082ff30["type"] == "insert" && $v539082ff30["attributes"] && $pac4bc40a[ $v539082ff30["table"] ]) foreach ($v539082ff30["attributes"] as $pd69fb7d0 => $v1b0cfa478b) { $v1b0cfa478b = $pac4bc40a[ $v539082ff30["table"] ][ $v1b0cfa478b["column"] ]; if ($v1b0cfa478b && $v1b0cfa478b["primary_key"] && WorkFlowDataAccessHandler::isAutoIncrementedAttribute($v1b0cfa478b)) unset($v539082ff30["attributes"][$pd69fb7d0]); } $v7f5911d32d["is_db_dao_action_task"] = true; $v95eeadc9e9["method_name"] = $v539082ff30["type"] == "insert" ? "insertObject" : ( $v539082ff30["type"] == "update" ? "updateObject" : ( $v539082ff30["type"] == "delete" ? "deleteObject" : "findObjects" ) ); $v95eeadc9e9["table_name"] = $v539082ff30["table"]; $v95eeadc9e9["table_name_type"] = "string"; $v95eeadc9e9["attributes_type"] = "array"; $v95eeadc9e9["attributes"] = array(); if ($v539082ff30["attributes"] && ($v539082ff30["type"] == "insert" || $v539082ff30["type"] == "update")) foreach ($v539082ff30["attributes"] as $pd69fb7d0 => $v1b0cfa478b) $v95eeadc9e9["attributes"][] = array( "key" => $v1b0cfa478b["column"], "key_type" => "string", "value" => $v1b0cfa478b["value"], "value_type" => "string", ); $v95eeadc9e9["conditions_type"] = "array"; $v95eeadc9e9["conditions"] = array(); if ($v539082ff30["conditions"] && ($v539082ff30["type"] == "insert" || $v539082ff30["type"] == "update")) foreach ($v539082ff30["conditions"] as $pd69fb7d0 => $v1b0cfa478b) $v95eeadc9e9["conditions"][] = array( "key" => $v1b0cfa478b["column"], "key_type" => "string", "value" => $v1b0cfa478b["value"], "value_type" => "string", ); $v7f5911d32d["service"] = $v95eeadc9e9; } } if ($v539082ff30["limit"] && (!$v95eeadc9e9["options"] || is_array($v95eeadc9e9["options"]))) { $v552b831ecd = $v539082ff30["limit"]; $v7e4b517c18 = $v539082ff30["start"]; $v95eeadc9e9["options_type"] = "array"; $v95eeadc9e9["options"] = is_array($v95eeadc9e9["options"]) ? $v95eeadc9e9["options"] : array(); $v711aded123 = $v150d54029b = false; if ($v95eeadc9e9["sql"]) { $v90786ceb50 = $v539082ff30; unset($v90786ceb50["limit"]); unset($v90786ceb50["start"]); $v95eeadc9e9["sql"] = DB::convertObjectToDefaultSQL($v90786ceb50); } foreach ($v95eeadc9e9["options"] as $pd69fb7d0 => $v956913c90f) { if ($v956913c90f["key"] == "limit" && $v956913c90f["key_type"] == "string") { $v95eeadc9e9["options"][$pd69fb7d0]["value"] = $v552b831ecd; $v95eeadc9e9["options"][$pd69fb7d0]["value_type"] = "string"; $v711aded123 = true; } else if (strlen("$v7e4b517c18") && $v956913c90f["key"] == "start" && $v956913c90f["key_type"] == "string") { $v95eeadc9e9["options"][$pd69fb7d0]["value"] = $v7e4b517c18; $v95eeadc9e9["options"][$pd69fb7d0]["value_type"] = "string"; $v150d54029b = true; } } if (!$v711aded123) $v95eeadc9e9["options"][] = array( "key" => "limit", "key_type" => "string", "value" => $v552b831ecd, "value_type" => "string", ); if (!$v150d54029b && strlen("$v7e4b517c18")) $v95eeadc9e9["options"][] = array( "key" => "start", "key_type" => "string", "value" => $v7e4b517c18, "value_type" => "string", ); $v7f5911d32d["service"] = $v95eeadc9e9; } } } } } } ?>
