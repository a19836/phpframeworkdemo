<?php
/*
 * Copyright (c) 2007 PHPMyFrameWork - Joao Pinto
 * AUTHOR: Joao Paulo Lopes Pinto -- http://jplpinto.com
 * 
 * The use of this code must be allowed first by the creator Joao Pinto, since this is a private and proprietary code.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS 
 * OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY 
 * AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR 
 * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL 
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, 
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER 
 * IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT 
 * OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. IN NO EVENT SHALL 
 * THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN 
 * AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE 
 * OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */
include_once get_lib("org.phpframework.util.MyArray"); include_once $EVC->getUtilPath("AdminMenuHandler"); include_once $EVC->getUtilPath("CMSPresentationFormSettingsUIHandler"); $UserAuthenticationHandler->checkPresentationFileAuthentication($entity_path, "access"); $bean_name = $_GET["bean_name"]; $bean_file_name = $_GET["bean_file_name"]; $path = $_GET["path"]; $filter_by_layout = $_GET["filter_by_layout"]; $db_layer = $_GET["db_layer"]; $db_layer_file = $_GET["db_layer_file"]; $db_driver = $_GET["db_driver"]; $include_db_driver = $_GET["include_db_driver"]; $type = $_GET["type"]; $selected_tables = $_POST["st"] ? $_POST["st"] : $_GET["st"]; $selected_tables_alias = $_POST["sta"] ? $_POST["sta"] : $_GET["sta"]; $active_brokers = $_POST["ab"] ? $_POST["ab"] : $_GET["ab"]; $active_brokers_folder = $_POST["abf"] ? $_POST["abf"] : $_GET["abf"]; $path = str_replace("../", "", $path);$filter_by_layout = str_replace("../", "", $filter_by_layout); $selected_tables_alias = is_array($selected_tables_alias) ? $selected_tables_alias : (!is_array($selected_tables) && $selected_tables && $selected_tables_alias ? array($selected_tables => $selected_tables_alias) : array()); $selected_tables = is_array($selected_tables) ? $selected_tables : ($selected_tables ? array($selected_tables) : array()); if ($path) { $WorkFlowBeansFileHandler = new WorkFlowBeansFileHandler($user_beans_folder_path . $bean_file_name, $user_global_variables_file_path); $PEVC = $WorkFlowBeansFileHandler->getEVCBeanObject($bean_name, $path); if ($PEVC) { $P = $PEVC->getPresentationLayer(); $user_global_variables_files_path = array($user_global_variables_file_path, $PEVC->getConfigPath("pre_init_config")); $PHPVariablesFileHandler = new PHPVariablesFileHandler($user_global_variables_files_path); $PHPVariablesFileHandler->startUserGlobalVariables(); $WorkFlowDataAccessHandler = new WorkFlowDataAccessHandler(); if ($type == "diagram") { $tasks_file_path = WorkFlowTasksFileHandler::getDBDiagramTaskFilePath($workflow_paths_id, "db_diagram", $db_driver); $WorkFlowDataAccessHandler->setTasksFilePath($tasks_file_path); $tasks = $WorkFlowDataAccessHandler->getTasks(); } else { if (!$db_layer_file) { $db_driver_props = WorkFlowBeansFileHandler::getLayerDBDriverProps($user_global_variables_files_path, $user_beans_folder_path, $P, $db_driver); $db_layer_file = $db_driver_props ? $db_driver_props[1] : null; } $WorkFlowDBHandler = new WorkFlowDBHandler($user_beans_folder_path, $user_global_variables_files_path); $tasks = $db_layer_file ? $WorkFlowDBHandler->getUpdateTaskDBDiagram($db_layer_file, $db_driver) : array(); $WorkFlowDataAccessHandler->setTasks($tasks); $tasks = $WorkFlowDataAccessHandler->getTasks(); } $tasks = $tasks["tasks"]; $foreign_keys = $WorkFlowDataAccessHandler->getForeignKeys(); MyArray::arrKeysToLowerCase($foreign_keys, true); $tables = $WorkFlowDataAccessHandler->getTasksAsTables(); MyArray::arrKeysToLowerCase($tables, true); $brokers = $P->getBrokers(); foreach ($brokers as $broker_name => $broker) if (!$active_brokers[$broker_name]) unset($brokers[$broker_name]); $db_drivers = WorkFlowBeansFileHandler::getBrokersDBDrivers($user_global_variables_files_path, $user_beans_folder_path, $brokers, true); $db_drivers = array_keys($db_drivers); $props = array( "tables" => array(), "brokers" => getPresentationBrokersProps($brokers), ); $layer_brokers_settings = WorkFlowBeansFileHandler::getLayerBrokersSettings($user_global_variables_files_path, $user_beans_folder_path, $brokers); $db_broker = $db_driver && $brokers && count($db_drivers) > 1 ? WorkFlowBeansFileHandler::getBrokersLocalDBBrokerNameForChildBrokerDBDriver($user_global_variables_files_path, $user_beans_folder_path, $brokers, $db_driver) : null; $include_db_broker = $include_db_driver || count($layer_brokers_settings["db_brokers"]) > 1; $t = count($selected_tables); for ($i = 0; $i < $t; $i++) { $table_name = strtolower($selected_tables[$i]); $attrs = WorkFlowDBHandler::getTableFromTables($tables, $table_name); if ($attrs) { $props["tables"][$table_name] = getPresentationTableUIProps($user_global_variables_files_path, $user_beans_folder_path, $table_name, $tables, $foreign_keys, $brokers, $db_broker, count($db_drivers) > 1 ? $db_driver : null, $include_db_broker, $include_db_driver, $selected_tables_alias, $active_brokers_folder, $WorkFlowDataAccessHandler, $UserAuthenticationHandler, $filter_by_layout); } } MyArray::arrKeysToLowerCase($props, true); $PHPVariablesFileHandler->endUserGlobalVariables(); } } function getPresentationBrokersProps($pc4223ce1) { $v9073377656 = array(); foreach ($pc4223ce1 as $v2b2cf4c0eb => $pd922c2f7) { if (is_a($pd922c2f7, "IBusinessLogicBrokerClient")) $v9073377656["business_logic_broker_name"] = $v2b2cf4c0eb; else if (is_a($pd922c2f7, "IHibernateDataAccessBrokerClient")) $v9073377656["hibernate_broker_name"] = $v2b2cf4c0eb; else if (is_a($pd922c2f7, "IIbatisDataAccessBrokerClient")) $v9073377656["ibatis_broker_name"] = $v2b2cf4c0eb; else if (is_a($pd922c2f7, "IDBBrokerClient")) $v9073377656["db_broker_name"] = $v2b2cf4c0eb; } return $v9073377656; } function getPresentationTableUIProps($v3d55458bcd, $v5039a77f9d, $v8c5df8072b, $pac4bc40a, $pba9184cd, $pc4223ce1, $pab752e34, $v872f5b4dbb, $pb09c0b5b, $v8b13fa2358, $v3b6d7c67a8, $v624f2a2845, $v094d1a2778, $pdf77ee66, $pb154d332) { $v9073377656 = array(); $pc661dc6b = WorkFlowDBHandler::getTableFromTables($pac4bc40a, $v8c5df8072b); $v571a648e93 = WorkFlowDBHandler::getTableFromTables($pba9184cd, $v8c5df8072b); if ($pb154d332) { if (!$pdf77ee66->searchLayoutTypes(array("name" => $pb154d332, "type_id" => UserAuthenticationHandler::$LAYOUTS_TYPE_FROM_PROJECT_ID))) $pb154d332 = null; else $pdf77ee66->loadLayoutPermissions($pb154d332, UserAuthenticationHandler::$LAYOUTS_TYPE_FROM_PROJECT_ID); } foreach ($pc4223ce1 as $v2b2cf4c0eb => $pd922c2f7) { $v54307eb686 = WorkFlowBeansFileHandler::getLocalBeanLayerFromBroker($v3d55458bcd, $v5039a77f9d, $pd922c2f7); $v847a7225e0 = $v54307eb686[2]; if ($v847a7225e0 && (is_a($v847a7225e0, "DataAccessLayer") || is_a($v847a7225e0, "BusinessLogicLayer") || is_a($v847a7225e0, "DBLayer"))) { $pd5679809 = $v847a7225e0->getLayerPathSetting(); $pa32be502 = trim($v624f2a2845[$v2b2cf4c0eb]) ? trim($v624f2a2845[$v2b2cf4c0eb]) : ""; if ($pa32be502 && substr($pa32be502, -1) != "/") $pa32be502 .= "/"; $v10eb48c548 = is_a($v847a7225e0, "DBLayer") ? array() : AdminMenuHandler::getBeanLayerObjs($v847a7225e0, $pa32be502, -1); unset($v10eb48c548["aliases"]); unset($v10eb48c548["properties"]); if (is_a($pd922c2f7, "IBusinessLogicBrokerClient")) { $v52b4591032 = parseBeanObjects($v10eb48c548, array("method"), array("cms_module", "cms_program", "cms_resource", "cms_common", "folder", "file", "service"), $pdf77ee66, $pd5679809, $pb154d332); $v9073377656[$v2b2cf4c0eb] = getBusinessLogicProps($v52b4591032, $v8c5df8072b, $pc661dc6b, $v571a648e93, $pab752e34, $v872f5b4dbb, $pb09c0b5b, $v8b13fa2358, $v3b6d7c67a8); } else if (is_a($pd922c2f7, "IHibernateDataAccessBrokerClient")) { $v52b4591032 = parseBeanObjects($v10eb48c548, array("obj", "query", "relationship"), array("cms_module", "cms_program", "cms_resource", "cms_common", "folder", "file", "obj"), $pdf77ee66, $pd5679809, $pb154d332); $v9073377656[$v2b2cf4c0eb] = getHibernateProps($v52b4591032, $v8c5df8072b, $pc661dc6b, $v571a648e93, $pab752e34, $v872f5b4dbb, $pb09c0b5b, $v8b13fa2358, $v3b6d7c67a8); } else if (is_a($pd922c2f7, "IIbatisDataAccessBrokerClient")) { $v52b4591032 = parseBeanObjects($v10eb48c548, array("query"), array("cms_module", "cms_program", "cms_resource", "cms_common", "folder", "file"), $pdf77ee66, $pd5679809, $pb154d332); $v9073377656[$v2b2cf4c0eb] = getIbatisProps($v52b4591032, $v8c5df8072b, $pc661dc6b, $v571a648e93, $pab752e34, $v872f5b4dbb, $pb09c0b5b, $v8b13fa2358, $v3b6d7c67a8); foreach ($v9073377656[$v2b2cf4c0eb] as $v3fb9f41470 => $pb4a546a4) { $v43972b7818 = $v847a7225e0->getSQLClient(); if ($v3fb9f41470 == "relationships" || $v3fb9f41470 == "relationships_count") { foreach ($pb4a546a4 as $pd98df87c => $pb0258e5c) { $v43972b7818->loadXML($v847a7225e0->getLayerPathSetting() . "/" . $pb0258e5c["path"]); $v9d1744e29c = $v43972b7818->getQuery($pb0258e5c["service_type"], $pb0258e5c["service_id"]); if ($v9d1744e29c && $v9d1744e29c["value"]) { $v9073377656[$v2b2cf4c0eb][$v3fb9f41470][$pd98df87c]["sql"] = str_replace(array("\t", "#searching_condition#"), "", $v9d1744e29c["value"]); $v9073377656[$v2b2cf4c0eb][$v3fb9f41470][$pd98df87c]["sql_type"] = "string"; if ($v3fb9f41470 == "relationships_count") $v9073377656[$v2b2cf4c0eb][$v3fb9f41470][$pd98df87c]["sql"] = preg_replace("/\s*WHERE\s*1=1\s*$/", "", $v9073377656[$v2b2cf4c0eb][$v3fb9f41470][$pd98df87c]["sql"]); } } } else { $v43972b7818->loadXML($v847a7225e0->getLayerPathSetting() . "/" . $pb4a546a4["path"]); $v9d1744e29c = $v43972b7818->getQuery($pb4a546a4["service_type"], $pb4a546a4["service_id"]); if ($v9d1744e29c && $v9d1744e29c["value"]) { $v9073377656[$v2b2cf4c0eb][$v3fb9f41470]["sql"] = str_replace(array("\t", "#searching_condition#"), "", $v9d1744e29c["value"]); $v9073377656[$v2b2cf4c0eb][$v3fb9f41470]["sql_type"] = "string"; if ($v3fb9f41470 == "count" || $v3fb9f41470 == "get_all") $v9073377656[$v2b2cf4c0eb][$v3fb9f41470]["sql"] = preg_replace("/\s*WHERE\s*1=1\s*$/", "", $v9073377656[$v2b2cf4c0eb][$v3fb9f41470]["sql"]); } } } } else if (is_a($pd922c2f7, "IDBBrokerClient")) { $v9073377656[$v2b2cf4c0eb] = getDBTableProps($v8c5df8072b, $pc661dc6b, $v571a648e93, $pab752e34, $v872f5b4dbb, $pb09c0b5b, $v8b13fa2358, $v3b6d7c67a8, $v094d1a2778); foreach ($v9073377656[$v2b2cf4c0eb] as $v3fb9f41470 => $pb4a546a4) { if ($v3fb9f41470 == "relationships" || $v3fb9f41470 == "relationships_count") { foreach ($pb4a546a4 as $pd98df87c => $pb0258e5c) { $v9073377656[$v2b2cf4c0eb][$v3fb9f41470][$pd98df87c]["sql"] = str_replace(array("\t", "#searching_condition#"), "", $pb0258e5c["sql"]); if ($v3fb9f41470 == "relationships_count") $v9073377656[$v2b2cf4c0eb][$v3fb9f41470][$pd98df87c]["sql"] = preg_replace("/\s*WHERE\s*1=1\s*$/", "", $v9073377656[$v2b2cf4c0eb][$v3fb9f41470][$pd98df87c]["sql"]); } } else { $v9073377656[$v2b2cf4c0eb][$v3fb9f41470]["sql"] = str_replace(array("\t", "#searching_condition#"), "", $pb4a546a4["sql"]); if ($v3fb9f41470 == "count" || $v3fb9f41470 == "get_all") $v9073377656[$v2b2cf4c0eb][$v3fb9f41470]["sql"] = preg_replace("/\s*WHERE\s*1=1\s*$/", "", $v9073377656[$v2b2cf4c0eb][$v3fb9f41470]["sql"]); } } } } } return $v9073377656; } function getBusinessLogicProps($v52b4591032, $v8c5df8072b, $pc661dc6b, $v571a648e93, $pab752e34, $v872f5b4dbb, $pb09c0b5b, $v8b13fa2358, $v3b6d7c67a8) { $v9073377656 = array(); $v566db8f5a9 = getTableAlias($v8c5df8072b, $v3b6d7c67a8); $v1335217393 = WorkFlowDataAccessHandler::getClassName($v8c5df8072b); $v195ca94b7d = $v566db8f5a9 ? WorkFlowDataAccessHandler::getClassName($v566db8f5a9) : null; $v22c8f149b5 = $v1335217393 . "Service"; $pc7fa99d2 = $v195ca94b7d ? $v195ca94b7d . "Service" : null; $pf3a4e567 = getForeignQueriesName($v571a648e93, $v8c5df8072b, $v3b6d7c67a8); $pae26fa90 = array(); $v90f014c229 = array(); $v84ef4916eb = array(); foreach ($pf3a4e567 as $pe509277e => $v78108fb2bd) { $pea4553dc = getTableAlias($v78108fb2bd, $v3b6d7c67a8); $v0360fd2b00 = WorkFlowDataAccessHandler::getClassName($pe509277e); if (!in_array($v78108fb2bd, $v84ef4916eb)) { $v84ef4916eb[] = $v78108fb2bd; $pd98df87c = WorkFlowDataAccessHandler::getClassName($v78108fb2bd); $pfc3e4570 = $pea4553dc ? WorkFlowDataAccessHandler::getClassName($pea4553dc) : null; $pe0bd8c13 = CMSPresentationFormSettingsUIHandler::getPlural($pd98df87c); $v56f42c687e = $pfc3e4570 ? CMSPresentationFormSettingsUIHandler::getPlural($pfc3e4570) : null; $v6cd9d4006f = "findRelationship" . $pd98df87c; $pae26fa90[$v6cd9d4006f] = $v78108fb2bd; $v90f014c229[str_replace("findRelationship", "countRelationship", $v6cd9d4006f)] = $v78108fb2bd; if ($pfc3e4570) { $v6cd9d4006f = "findRelationship" . $pfc3e4570; $pae26fa90[$v6cd9d4006f] = $v78108fb2bd; $v90f014c229[str_replace("findRelationship", "countRelationship", $v6cd9d4006f)] = $v78108fb2bd; } $v6cd9d4006f = "findRelationship" . $v1335217393 . $pd98df87c; $pae26fa90[$v6cd9d4006f] = $v78108fb2bd; $v90f014c229[str_replace("findRelationship", "countRelationship", $v6cd9d4006f)] = $v78108fb2bd; if ($pfc3e4570) { $v6cd9d4006f = "findRelationship" . $v1335217393 . $pfc3e4570; $pae26fa90[$v6cd9d4006f] = $v78108fb2bd; $v90f014c229[str_replace("findRelationship", "countRelationship", $v6cd9d4006f)] = $v78108fb2bd; } if ($v195ca94b7d) { $v6cd9d4006f = "findRelationship" . $v195ca94b7d . $pd98df87c; $pae26fa90[$v6cd9d4006f] = $v78108fb2bd; $v90f014c229[str_replace("findRelationship", "countRelationship", $v6cd9d4006f)] = $v78108fb2bd; if ($pfc3e4570) { $v6cd9d4006f = "findRelationship" . $v195ca94b7d . $pfc3e4570; $pae26fa90[$v6cd9d4006f] = $v78108fb2bd; $v90f014c229[str_replace("findRelationship", "countRelationship", $v6cd9d4006f)] = $v78108fb2bd; } } $v6cd9d4006f = "findRelationship" . $pe0bd8c13; $pae26fa90[$v6cd9d4006f] = $v78108fb2bd; $v90f014c229[str_replace("findRelationship", "countRelationship", $v6cd9d4006f)] = $v78108fb2bd; if ($v56f42c687e) { $v6cd9d4006f = "findRelationship" . $v56f42c687e; $pae26fa90[$v6cd9d4006f] = $v78108fb2bd; $v90f014c229[str_replace("findRelationship", "countRelationship", $v6cd9d4006f)] = $v78108fb2bd; } $v6cd9d4006f = "findRelationship" . $v1335217393 . $pe0bd8c13; $pae26fa90[$v6cd9d4006f] = $v78108fb2bd; $v90f014c229[str_replace("findRelationship", "countRelationship", $v6cd9d4006f)] = $v78108fb2bd; if ($v195ca94b7d) { $v6cd9d4006f = "findRelationship" . $v195ca94b7d . $pe0bd8c13; $pae26fa90[$v6cd9d4006f] = $v78108fb2bd; $v90f014c229[str_replace("findRelationship", "countRelationship", $v6cd9d4006f)] = $v78108fb2bd; if ($v56f42c687e) { $v6cd9d4006f = "findRelationship" . $v195ca94b7d . $v56f42c687e; $pae26fa90[$v6cd9d4006f] = $v78108fb2bd; $v90f014c229[str_replace("findRelationship", "countRelationship", $v6cd9d4006f)] = $v78108fb2bd; } } } $v6cd9d4006f = stripos($v0360fd2b00, "findrelationship") !== false ? lcfirst($v0360fd2b00) : "findRelationship" . $v0360fd2b00; $pae26fa90[$v6cd9d4006f] = $v78108fb2bd; $v90f014c229[str_replace("findRelationship", "countRelationship", $v6cd9d4006f)] = $v78108fb2bd; $v6cd9d4006f = stripos($v0360fd2b00, "get") !== false || stripos($v0360fd2b00, "select") !== false ? lcfirst($v0360fd2b00) : "get" . $v0360fd2b00; $pae26fa90[$v6cd9d4006f] = $v78108fb2bd; $v90f014c229[str_replace(array("get", "select"), "count", $v6cd9d4006f)] = $v78108fb2bd; $v6cd9d4006f = "count" . ucfirst(str_ireplace(array("numberof", "number", "total", "get", "select"), "", $v6cd9d4006f)); $v90f014c229[$v6cd9d4006f] = $v78108fb2bd; } if ($v52b4591032) { $v8bfe1e14d5 = strtolower($v22c8f149b5); $v0e9ff6fc6a = strtolower($pc7fa99d2); $pc37695cb = count($v52b4591032); for ($v43dd7d0051 = 0; $v43dd7d0051 < $pc37695cb; $v43dd7d0051++) { $v972f1a5c2b = $v52b4591032[$v43dd7d0051]; $pbf277fc7 = strtolower($v972f1a5c2b["service"]); $pf66d8436 = strtolower($v972f1a5c2b["path"]); if (strpos($pbf277fc7, "\\") !== false) $pbf277fc7 = substr($pbf277fc7, strrpos($pbf277fc7, "\\") + 1); $v9e394b2939 = $v972f1a5c2b["item_type"] == "method" && ($pbf277fc7 == $v8bfe1e14d5 || ($v0e9ff6fc6a && $pbf277fc7 == $v0e9ff6fc6a)) && (stripos($pf66d8436, "/{$v8bfe1e14d5}.php") !== false || ($v0e9ff6fc6a && stripos($pf66d8436, "/{$v0e9ff6fc6a}.php") !== false)); if ($v9e394b2939) { $v5e813b295b = $v972f1a5c2b["name"]; $pc790a5a3 = strtolower($v5e813b295b); $pc1c0312b = strtolower($v1335217393); $v735cd4ee95 = strtolower($v195ca94b7d); $v3fb9f41470 = null; if ( $pc790a5a3 == "insert" || $pc790a5a3 == "insert$pc1c0312b" || $pc790a5a3 == "insert$v735cd4ee95" ) $v3fb9f41470 = "insert"; else if ( $pc790a5a3 == "update" || $pc790a5a3 == "update$pc1c0312b" || $pc790a5a3 == "update$v735cd4ee95" ) $v3fb9f41470 = "update"; else if ( $pc790a5a3 == "updateprimarykeys" || $pc790a5a3 == "updatepks" || $pc790a5a3 == "update{$pc1c0312b}primarykeys" || $pc790a5a3 == "update{$v735cd4ee95}primarykeys" || $pc790a5a3 == "update{$pc1c0312b}pks" || $pc790a5a3 == "update{$v735cd4ee95}pks" ) $v3fb9f41470 = "update_pks"; else if ( $pc790a5a3 == "updateall" || $pc790a5a3 == "updates" || $pc790a5a3 == "updateall{$pc1c0312b}" || $pc790a5a3 == "updateall{$v735cd4ee95}" || $pc790a5a3 == "updateall{$pc1c0312b}items" || $pc790a5a3 == "updateall{$v735cd4ee95}items" || $pc790a5a3 == "update{$pc1c0312b}all" || $pc790a5a3 == "update{$v735cd4ee95}all" || $pc790a5a3 == "update{$pc1c0312b}allitems" || $pc790a5a3 == "update{$v735cd4ee95}allitems" || $pc790a5a3 == "update{$pc1c0312b}items" || $pc790a5a3 == "update{$v735cd4ee95}items" ) $v3fb9f41470 = "update_all"; else if ( $pc790a5a3 == "delete" || $pc790a5a3 == "delete$pc1c0312b" || $pc790a5a3 == "delete$v735cd4ee95" ) $v3fb9f41470 = "delete"; else if ( $pc790a5a3 == "deleteall" || $pc790a5a3 == "deletes" || $pc790a5a3 == "deleteall{$pc1c0312b}" || $pc790a5a3 == "deleteall{$v735cd4ee95}" || $pc790a5a3 == "deleteall{$pc1c0312b}items" || $pc790a5a3 == "deleteall{$v735cd4ee95}items" || $pc790a5a3 == "delete{$pc1c0312b}all" || $pc790a5a3 == "delete{$v735cd4ee95}all" || $pc790a5a3 == "delete{$pc1c0312b}allitems" || $pc790a5a3 == "delete{$v735cd4ee95}allitems" || $pc790a5a3 == "delete{$pc1c0312b}items" || $pc790a5a3 == "delete{$v735cd4ee95}items" ) $v3fb9f41470 = "delete_all"; else if ( $pc790a5a3 == "get" || $pc790a5a3 == "get$pc1c0312b" || $pc790a5a3 == "get$v735cd4ee95" || $pc790a5a3 == "findbyid" ) $v3fb9f41470 = "get"; else if ( $pc790a5a3 == "getall" || $pc790a5a3 == "getall{$pc1c0312b}items" || $pc790a5a3 == "getall{$v735cd4ee95}items" || $pc790a5a3 == "get{$pc1c0312b}items" || $pc790a5a3 == "get{$v735cd4ee95}items" || $pc790a5a3 == "get{$pc1c0312b}s" || $pc790a5a3 == "get{$v735cd4ee95}s" || $pc790a5a3 == "getitems" || $pc790a5a3 == "gets" || $pc790a5a3 == "find" ) $v3fb9f41470 = "get_all"; else if ( $pc790a5a3 == "countall" || $pc790a5a3 == "counts" || $pc790a5a3 == "count" || $pc790a5a3 == "countall{$pc1c0312b}items" || $pc790a5a3 == "countall{$v735cd4ee95}items" || $pc790a5a3 == "count{$pc1c0312b}items" || $pc790a5a3 == "count{$v735cd4ee95}items" || $pc790a5a3 == "count{$pc1c0312b}s" || $pc790a5a3 == "count{$v735cd4ee95}s" || $pc790a5a3 == "countitems" ) $v3fb9f41470 = "count"; else if ($pae26fa90[$v5e813b295b]) $v3fb9f41470 = "relationships"; else if ($v90f014c229[$v5e813b295b]) $v3fb9f41470 = "relationships_count"; if ($v3fb9f41470) { $v97a0064bbc = stripos($pf66d8436, "/{$v8bfe1e14d5}.php") !== false ? $v22c8f149b5 : $pc7fa99d2; $pb4a546a4 = array( "path" => $v972f1a5c2b["path"], "module_id" => dirname($v972f1a5c2b["path"]), "module_id_type" => "string", "service_id" => "$v97a0064bbc.$v5e813b295b", "service_id_type" => "string", "obj" => $v97a0064bbc, "method" => $v5e813b295b, "options_type" => "array", "options" => array( array( "key" => "no_cache", "key_type" => "string", "value" => true, "value_type" => "", ) ), ); if ($pab752e34 && $pb09c0b5b) $pb4a546a4["options"][] = array( "key" => "db_broker", "key_type" => "string", "value" => $pab752e34, "value_type" => "string", ); if ($v872f5b4dbb && $v8b13fa2358) $pb4a546a4["options"][] = array( "key" => "db_driver", "key_type" => "string", "value" => $v872f5b4dbb, "value_type" => "string", ); if ($v3fb9f41470 == "relationships") { $pd98df87c = $pae26fa90[$v5e813b295b]; $v9073377656[$v3fb9f41470][$pd98df87c] = $pb4a546a4; } else if ($v3fb9f41470 == "relationships_count") { $pd98df87c = $v90f014c229[$v5e813b295b]; $v9073377656[$v3fb9f41470][$pd98df87c] = $pb4a546a4; } else $v9073377656[$v3fb9f41470] = $pb4a546a4; } } } } return $v9073377656; } function getHibernateProps($v52b4591032, $v8c5df8072b, $pc661dc6b, $v571a648e93, $pab752e34, $v872f5b4dbb, $pb09c0b5b, $v8b13fa2358, $v3b6d7c67a8) { $v9073377656 = array(); $v566db8f5a9 = getTableAlias($v8c5df8072b, $v3b6d7c67a8); $v596ed11fcc = strtolower($v8c5df8072b); $pde7cd1aa = strtolower($v566db8f5a9); $pf3a4e567 = getForeignQueriesName($v571a648e93, $v8c5df8072b, $v3b6d7c67a8); if ($v571a648e93) { $pc37695cb = count($v571a648e93); for ($v43dd7d0051 = 0; $v43dd7d0051 < $pc37695cb; $v43dd7d0051++) { $pa7c14731 = $v571a648e93[$v43dd7d0051]; $v78108fb2bd = strtolower($pa7c14731["child_table"]) == $v596ed11fcc ? $pa7c14731["parent_table"] : $pa7c14731["child_table"]; $pea4553dc = getTableAlias($v78108fb2bd, $v3b6d7c67a8); $v78b1bb0600 = WorkFlowDataAccessHandler::getForeignTableQueryName($v8c5df8072b, $v78108fb2bd, $pa7c14731["type"]); $v78b1bb0600 = $v78b1bb0600 ? substr($v78b1bb0600, strlen("get_")) : $v78b1bb0600; $pf3a4e567[$v78b1bb0600] = $v78108fb2bd; if ($v566db8f5a9) { if ($pea4553dc) { $v78b1bb0600 = WorkFlowDataAccessHandler::getForeignTableQueryName($v566db8f5a9, $pea4553dc, $pa7c14731["type"]); $v78b1bb0600 = $v78b1bb0600 ? substr($v78b1bb0600, strlen("get_")) : $v78b1bb0600; $pf3a4e567[$v78b1bb0600] = $v78108fb2bd; } $v78b1bb0600 = WorkFlowDataAccessHandler::getForeignTableQueryName($v566db8f5a9, $v78108fb2bd, $pa7c14731["type"]); $v78b1bb0600 = $v78b1bb0600 ? substr($v78b1bb0600, strlen("get_")) : $v78b1bb0600; $pf3a4e567[$v78b1bb0600] = $v78108fb2bd; } } } if ($v52b4591032) { $pc37695cb = count($v52b4591032); for ($v43dd7d0051 = 0; $v43dd7d0051 < $pc37695cb; $v43dd7d0051++) { $v972f1a5c2b = $v52b4591032[$v43dd7d0051]; $v971b2e0359 = strtolower($v972f1a5c2b["table"]); $pf66d8436 = strtolower($v972f1a5c2b["path"]); $v9e394b2939 = $v972f1a5c2b["item_type"] == "obj" && ($v971b2e0359 == $v596ed11fcc || ($v566db8f5a9 && $v971b2e0359 == $pde7cd1aa)) && (stripos($pf66d8436, "/{$v596ed11fcc}.xml") !== false || ($v566db8f5a9 && stripos($pf66d8436, "/{$pde7cd1aa}.xml") !== false)); if ($v9e394b2939) { $pb4a546a4 = array( "path" => $v972f1a5c2b["path"], "module_id" => dirname($v972f1a5c2b["path"]), "module_id_type" => "string", "service_id" => $v972f1a5c2b["name"], "service_id_type" => "string", "service_method_type" => "string", "sma_options_type" => "array", "sma_options" => array( array( "key" => "no_cache", "key_type" => "string", "value" => true, "value_type" => "", ) ), ); if ($pab752e34 || $v872f5b4dbb) { $pb4a546a4["options_type"] = "array"; $pb4a546a4["options"] = array(); if ($pab752e34 && $pb09c0b5b) $pb4a546a4["options"][] = array( "key" => "db_broker", "key_type" => "string", "value" => $pab752e34, "value_type" => "string", ); if ($v872f5b4dbb && $v8b13fa2358) $pb4a546a4["options"][] = array( "key" => "db_driver", "key_type" => "string", "value" => $v872f5b4dbb, "value_type" => "string", ); } $v1612a5ddce = $v972f1a5c2b["childs"]; $pda00de76 = getIbatisProps($v1612a5ddce, $v8c5df8072b, $pc661dc6b, $v571a648e93, $pab752e34, $v872f5b4dbb, $pb09c0b5b, $v8b13fa2358, $v3b6d7c67a8); foreach ($pda00de76 as $v3fb9f41470 => $v9acf40c110) { if ($v3fb9f41470 == "relationships" || $v3fb9f41470 == "relationships_count") { foreach ($v9acf40c110 as $pd98df87c => $pb0258e5c) { $pb4a546a4["service_method"] = "call" . ucfirst(strtolower($pb0258e5c["service_type"])); $pb4a546a4["sma_query_id"] = $pb0258e5c["service_id"]; $pb4a546a4["sma_query_id"] = $pb0258e5c["service_id_type"]; $v9073377656[$v3fb9f41470][$pd98df87c] = $pb4a546a4; } } else { $pb4a546a4["service_method"] = "call" . ucfirst(strtolower($v9acf40c110["service_type"])); $pb4a546a4["sma_query_id"] = $v9acf40c110["service_id"]; $pb4a546a4["sma_query_id_type"] = $v9acf40c110["service_id_type"]; $v9073377656[$v3fb9f41470] = $pb4a546a4; } } unset($pb4a546a4["sma_query_id"]); unset($pb4a546a4["sma_query_id_type"]); if ($v1612a5ddce) { $pc37695cb = count($v1612a5ddce); for ($v43dd7d0051 = 0; $v43dd7d0051 < $pc37695cb; $v43dd7d0051++) { $v9d1744e29c = $v1612a5ddce[$v43dd7d0051]; if ($v9d1744e29c["item_type"] == "relationship" && $pf3a4e567[ $v9d1744e29c["name"] ]) { $pb4a546a4["service_method"] = "findRelationship"; $pb4a546a4["sma_rel_name"] = $v9d1744e29c["name"]; $pb4a546a4["sma_rel_name_type"] = "string"; $pd98df87c = $pf3a4e567[ $v9d1744e29c["name"] ]; $v9073377656["relationships"][$pd98df87c] = $pb4a546a4; $pb4a546a4["service_method"] = "countRelationship"; $v9073377656["relationships_count"][$pd98df87c] = $pb4a546a4; } } } unset($pb4a546a4["sma_rel_name"]); unset($pb4a546a4["sma_rel_name_type"]); $pb4a546a4["service_method"] = "insert"; $v9073377656["insert"] = $pb4a546a4; $pb4a546a4["service_method"] = "update"; $v9073377656["update"] = $pb4a546a4; $pb4a546a4["service_method"] = "updatePrimaryKeys"; $v9073377656["update_pks"] = $pb4a546a4; $pb4a546a4["service_method"] = "updateAll"; $v9073377656["update_all"] = $pb4a546a4; $pb4a546a4["service_method"] = "delete"; $v9073377656["delete"] = $pb4a546a4; $pb4a546a4["service_method"] = "deleteAll"; $v9073377656["delete_all"] = $pb4a546a4; $pb4a546a4["service_method"] = "findById"; $v9073377656["get"] = $pb4a546a4; $pb4a546a4["service_method"] = "find"; $v9073377656["get_all"] = $pb4a546a4; $pb4a546a4["service_method"] = "count"; $v9073377656["count"] = $pb4a546a4; } } } return $v9073377656; } function getIbatisProps($v52b4591032, $v8c5df8072b, $pc661dc6b, $v571a648e93, $pab752e34, $v872f5b4dbb, $pb09c0b5b, $v8b13fa2358, $v3b6d7c67a8) { $v9073377656 = array(); $v566db8f5a9 = getTableAlias($v8c5df8072b, $v3b6d7c67a8); $v596ed11fcc = strtolower($v8c5df8072b); $pde7cd1aa = strtolower($v566db8f5a9); $pf3a4e567 = getForeignQueriesName($v571a648e93, $v8c5df8072b, $v3b6d7c67a8); $pad9431ad = getForeignQueriesCountName($v571a648e93, $v8c5df8072b, $v3b6d7c67a8); if ($v52b4591032) { $pc37695cb = count($v52b4591032); for ($v43dd7d0051 = 0; $v43dd7d0051 < $pc37695cb; $v43dd7d0051++) { $v972f1a5c2b = $v52b4591032[$v43dd7d0051]; $pf66d8436 = strtolower($v972f1a5c2b["path"]); $v9e394b2939 = $v972f1a5c2b["item_type"] == "query" && (stripos($pf66d8436, "/{$v596ed11fcc}.xml") !== false || ($v566db8f5a9 && stripos($pf66d8436, "/{$pde7cd1aa}.xml") !== false)); if ($v9e394b2939) { $v5e813b295b = $v972f1a5c2b["name"]; $pc221318a = $v972f1a5c2b["query_type"]; $v3fb9f41470 = getQueryPropType($v8c5df8072b, $v566db8f5a9, $pf3a4e567, $pad9431ad, $pc221318a, $v5e813b295b); if ($v3fb9f41470) { $pb4a546a4 = array( "path" => $v972f1a5c2b["path"], "module_id" => dirname($v972f1a5c2b["path"]), "module_id_type" => "string", "service_type" => $pc221318a, "service_type_type" => "string", "service_id" => $v5e813b295b, "service_id_type" => "string", "options_type" => "array", "options" => array( array( "key" => "no_cache", "key_type" => "string", "value" => true, "value_type" => "", ) ), ); if ($pab752e34 && $pb09c0b5b) $pb4a546a4["options"][] = array( "key" => "db_broker", "key_type" => "string", "value" => $pab752e34, "value_type" => "string", ); if ($v872f5b4dbb && $v8b13fa2358) $pb4a546a4["options"][] = array( "key" => "db_driver", "key_type" => "string", "value" => $v872f5b4dbb, "value_type" => "string", ); if ($v3fb9f41470 == "relationships") { $pd98df87c = $pf3a4e567[$v5e813b295b]; $v9073377656[$v3fb9f41470][$pd98df87c] = $pb4a546a4; } else if ($v3fb9f41470 == "relationships_count") { $pd98df87c = $pad9431ad[$v5e813b295b]; $v9073377656[$v3fb9f41470][$pd98df87c] = $pb4a546a4; } else $v9073377656[$v3fb9f41470] = $pb4a546a4; } } } } return $v9073377656; } function getDBTableProps($v8c5df8072b, $pc661dc6b, $v571a648e93, $pab752e34, $v872f5b4dbb, $pb09c0b5b, $v8b13fa2358, $v3b6d7c67a8, $v094d1a2778) { $v9073377656 = array(); $v566db8f5a9 = getTableAlias($v8c5df8072b, $v3b6d7c67a8); $v596ed11fcc = strtolower($v8c5df8072b); $pde7cd1aa = strtolower($v566db8f5a9); $pf3a4e567 = getForeignQueriesName($v571a648e93, $v8c5df8072b, $v3b6d7c67a8); $pad9431ad = getForeignQueriesCountName($v571a648e93, $v8c5df8072b, $v3b6d7c67a8); $pfb662071 = $v094d1a2778->getQueryObjectsArrayFromDBTaskFlow($v8c5df8072b); if ($pfb662071 && $pfb662071["queries"][0]["childs"]) foreach ($pfb662071["queries"][0]["childs"] as $pc221318a => $v2f0fa339ed) if ($v2f0fa339ed) foreach ($v2f0fa339ed as $v9d1744e29c) { $v5e813b295b = $v9d1744e29c["@"]["id"]; $v3c76382d93 = $v9d1744e29c["value"]; $v3fb9f41470 = getQueryPropType($v8c5df8072b, $v566db8f5a9, $pf3a4e567, $pad9431ad, $pc221318a, $v5e813b295b); if ($v3fb9f41470) { $pb4a546a4 = array( "sql" => $v3c76382d93, "sql_type" => "string", "options_type" => "array", "options" => array( array( "key" => "no_cache", "key_type" => "string", "value" => true, "value_type" => "", ) ), ); if ($pab752e34 && $pb09c0b5b) $pb4a546a4["options"][] = array( "key" => "db_broker", "key_type" => "string", "value" => $pab752e34, "value_type" => "string", ); if ($v872f5b4dbb && $v8b13fa2358) $pb4a546a4["options"][] = array( "key" => "db_driver", "key_type" => "string", "value" => $v872f5b4dbb, "value_type" => "string", ); if ($v3fb9f41470 == "relationships") { $pd98df87c = $pf3a4e567[$v5e813b295b]; $v9073377656[$v3fb9f41470][$pd98df87c] = $pb4a546a4; } else if ($v3fb9f41470 == "relationships_count") { $pd98df87c = $pad9431ad[$v5e813b295b]; $v9073377656[$v3fb9f41470][$pd98df87c] = $pb4a546a4; } else $v9073377656[$v3fb9f41470] = $pb4a546a4; } } return $v9073377656; } function getQueryPropType($v8c5df8072b, $v566db8f5a9, $pf3a4e567, $pad9431ad, $pc221318a, $v61d3466499) { $v3fb9f41470 = null; $pc98a5d7b = CMSPresentationFormSettingsUIHandler::getPlural($v8c5df8072b); $v3bf9c2b8db = $v566db8f5a9 ? CMSPresentationFormSettingsUIHandler::getPlural($v566db8f5a9) : null; $v723b9fc867 = str_replace(".", "_", $v8c5df8072b); $v29f038b7b1 = str_replace(".", "_", $pc98a5d7b); if ( $pc221318a == "insert" && ( $v61d3466499 == "insert_$v8c5df8072b" || $v61d3466499 == "insert_$v723b9fc867" ) ) $v3fb9f41470 = "insert"; else if ( $v566db8f5a9 && $pc221318a == "insert" && $v61d3466499 == "insert_$v566db8f5a9" ) $v3fb9f41470 = "insert"; else if ( $pc221318a == "update" && ( $v61d3466499 == "update_$v8c5df8072b" || $v61d3466499 == "update_$v723b9fc867" ) ) $v3fb9f41470 = "update"; else if ( $v566db8f5a9 && $pc221318a == "update" && $v61d3466499 == "update_$v566db8f5a9" ) $v3fb9f41470 = "update"; else if ( $pc221318a == "update" && ( $v61d3466499 == "update_{$v8c5df8072b}_primary_keys" || $v61d3466499 == "update_{$v8c5df8072b}_pks" || $v61d3466499 == "update_{$v723b9fc867}_primary_keys" || $v61d3466499 == "update_{$v723b9fc867}_pks" ) ) $v3fb9f41470 = "update_pks"; else if ( $v566db8f5a9 && $pc221318a == "update" && ( $v61d3466499 == "update_{$v566db8f5a9}_primary_keys" || $v61d3466499 == "update_{$v566db8f5a9}_pks" ) ) $v3fb9f41470 = "update_pks"; else if ( $pc221318a == "update" && ( $v61d3466499 == "update_all_{$v8c5df8072b}" || $v61d3466499 == "update_{$v8c5df8072b}_all" || $v61d3466499 == "update_all_{$v723b9fc867}" || $v61d3466499 == "update_{$v723b9fc867}_all" || $v61d3466499 == "update_{$v8c5df8072b}_all_items" || $v61d3466499 == "update_{$v723b9fc867}_all_items" || $v61d3466499 == "update_all_{$v8c5df8072b}_items" || $v61d3466499 == "update_all_{$v723b9fc867}_items" ) ) $v3fb9f41470 = "update_all"; else if ( $v566db8f5a9 && $pc221318a == "update" && ( $v61d3466499 == "update_all_{$v566db8f5a9}" || $v61d3466499 == "update_{$v566db8f5a9}_all" || $v61d3466499 == "update_all_{$v566db8f5a9}_items" || $v61d3466499 == "update_{$v566db8f5a9}_all_items" ) ) $v3fb9f41470 = "update_all"; else if ( $pc221318a == "delete" && ( $v61d3466499 == "delete_$v8c5df8072b" || $v61d3466499 == "delete_$v723b9fc867" ) ) $v3fb9f41470 = "delete"; else if ( $v566db8f5a9 && $pc221318a == "delete" && $v61d3466499 == "delete_$v566db8f5a9" ) $v3fb9f41470 = "delete"; else if ( $pc221318a == "delete" && ( $v61d3466499 == "delete_all_{$v8c5df8072b}" || $v61d3466499 == "delete_{$v8c5df8072b}_all" || $v61d3466499 == "delete_all_{$v723b9fc867}" || $v61d3466499 == "delete_{$v723b9fc867}_all" || $v61d3466499 == "delete_{$v8c5df8072b}_all_items" || $v61d3466499 == "delete_{$v723b9fc867}_all_items" || $v61d3466499 == "delete_all_{$v8c5df8072b}_items" || $v61d3466499 == "delete_all_{$v723b9fc867}_items" ) ) $v3fb9f41470 = "delete_all"; else if ( $v566db8f5a9 && $pc221318a == "delete" && ( $v61d3466499 == "delete_all_{$v566db8f5a9}" || $v61d3466499 == "delete_{$v566db8f5a9}_all" || $v61d3466499 == "delete_all_{$v566db8f5a9}_items" || $v61d3466499 == "delete_{$v566db8f5a9}_all_items" ) ) $v3fb9f41470 = "delete_all"; else if ( $pc221318a == "select" && ( $v61d3466499 == "get_$v8c5df8072b" || $v61d3466499 == "get_$v723b9fc867" ) ) $v3fb9f41470 = "get"; else if ( $v566db8f5a9 && $pc221318a == "select" && $v61d3466499 == "get_$v566db8f5a9" ) $v3fb9f41470 = "get"; else if ( $pc221318a == "select" && ( $v61d3466499 == "get_all_{$v8c5df8072b}_items" || $v61d3466499 == "get_{$v8c5df8072b}_items" || $v61d3466499 == "get_{$pc98a5d7b}" || $v61d3466499 == "get_all_{$v723b9fc867}_items" || $v61d3466499 == "get_{$v723b9fc867}_items" || $v61d3466499 == "get_{$v29f038b7b1}" ) ) $v3fb9f41470 = "get_all"; else if ( $v566db8f5a9 && $pc221318a == "select" && ( $v61d3466499 == "get_all_{$v566db8f5a9}_items" || $v61d3466499 == "get_{$v566db8f5a9}_items" || $v61d3466499 == "get_{$v3bf9c2b8db}" ) ) $v3fb9f41470 = "get_all"; else if ( $pc221318a == "select" && ( $v61d3466499 == "count_all_{$v8c5df8072b}_items" || $v61d3466499 == "count_{$v8c5df8072b}_items" || $v61d3466499 == "count_{$pc98a5d7b}" ) ) $v3fb9f41470 = "count"; else if ( $v566db8f5a9 && $pc221318a == "select" && ( $v61d3466499 == "count_all_{$v566db8f5a9}_items" || $v61d3466499 == "count_{$v566db8f5a9}_items" || $v61d3466499 == "count_{$v3bf9c2b8db}" ) ) $v3fb9f41470 = "count"; else if ($pf3a4e567[$v61d3466499] && $pc221318a == "select") $v3fb9f41470 = "relationships"; else if ($pad9431ad[$v61d3466499] && $pc221318a == "select") $v3fb9f41470 = "relationships_count"; return $v3fb9f41470; } function getForeignQueriesName($pba9184cd, $v8c5df8072b, $v3b6d7c67a8) { $v04a366a14b = array(); if ($pba9184cd) { $v566db8f5a9 = getTableAlias($v8c5df8072b, $v3b6d7c67a8); $v2ee72186a7 = strtolower($v8c5df8072b); $pdcad24c1 = $v566db8f5a9 ? strtolower($v566db8f5a9) : null; $v90917a75d0 = str_replace(".", "_", $v2ee72186a7); $pc37695cb = count($pba9184cd); for ($v43dd7d0051 = 0; $v43dd7d0051 < $pc37695cb; $v43dd7d0051++) { $pa7c14731 = $pba9184cd[$v43dd7d0051]; $pbdbd4aa6 = strtolower($pa7c14731["child_table"]); $v78108fb2bd = $pbdbd4aa6 == $v2ee72186a7 ? $pa7c14731["parent_table"] : $pa7c14731["child_table"]; $pea4553dc = getTableAlias($v78108fb2bd, $v3b6d7c67a8); $v7d1891d6f3 = strtolower($v78108fb2bd); $v4fdabee45a = $pea4553dc ? strtolower($pea4553dc) : null; $v5e633ad35b = str_replace(".", "_", $v7d1891d6f3); $pc3ba545b = CMSPresentationFormSettingsUIHandler::getPlural($v7d1891d6f3); $pc9421a7d = $v4fdabee45a ? CMSPresentationFormSettingsUIHandler::getPlural($v4fdabee45a) : null; $v67afa08079 = str_replace(".", "_", $pc3ba545b); $v61d3466499 = WorkFlowDataAccessHandler::getForeignTableQueryName($v8c5df8072b, $v78108fb2bd, $pa7c14731["type"]); $v04a366a14b[$v61d3466499] = $v78108fb2bd; if ($v566db8f5a9) { if ($pea4553dc) { $v61d3466499 = WorkFlowDataAccessHandler::getForeignTableQueryName($v566db8f5a9, $pea4553dc, $pa7c14731["type"]); $v04a366a14b[$v61d3466499] = $v78108fb2bd; } $v61d3466499 = WorkFlowDataAccessHandler::getForeignTableQueryName($v566db8f5a9, $v78108fb2bd, $pa7c14731["type"]); $v04a366a14b[$v61d3466499] = $v78108fb2bd; } $v04a366a14b["get_" . $v7d1891d6f3] = $v78108fb2bd; $v04a366a14b["get_" . $v5e633ad35b] = $v78108fb2bd; if ($v4fdabee45a) $v04a366a14b["get_" . $v4fdabee45a] = $v78108fb2bd; $v04a366a14b["get_" . $v2ee72186a7 . "_" . $v7d1891d6f3] = $v78108fb2bd; $v04a366a14b["get_" . $v90917a75d0 . "_" . $v5e633ad35b] = $v78108fb2bd; $v04a366a14b["get_" . $v90917a75d0 . "_" . $v7d1891d6f3] = $v78108fb2bd; $v04a366a14b["get_" . $v2ee72186a7 . "_" . $v5e633ad35b] = $v78108fb2bd; if ($v4fdabee45a) { $v04a366a14b["get_" . $v2ee72186a7 . "_" . $v4fdabee45a] = $v78108fb2bd; $v04a366a14b["get_" . $v90917a75d0 . "_" . $v4fdabee45a] = $v78108fb2bd; } if ($pdcad24c1) { $v04a366a14b["get_" . $pdcad24c1 . "_" . $v7d1891d6f3] = $v78108fb2bd; $v04a366a14b["get_" . $pdcad24c1 . "_" . $v5e633ad35b] = $v78108fb2bd; if ($v4fdabee45a) $v04a366a14b["get_" . $pdcad24c1 . "_" . $v4fdabee45a] = $v78108fb2bd; } $v04a366a14b["select_" . $v7d1891d6f3] = $v78108fb2bd; $v04a366a14b["select_" . $v5e633ad35b] = $v78108fb2bd; if ($v4fdabee45a) $v04a366a14b["select_" . $v4fdabee45a] = $v78108fb2bd; $v04a366a14b["select_" . $v2ee72186a7 . "_" . $v7d1891d6f3] = $v78108fb2bd; $v04a366a14b["select_" . $v90917a75d0 . "_" . $v5e633ad35b] = $v78108fb2bd; $v04a366a14b["select_" . $v90917a75d0 . "_" . $v7d1891d6f3] = $v78108fb2bd; $v04a366a14b["select_" . $v2ee72186a7 . "_" . $v5e633ad35b] = $v78108fb2bd; if ($v4fdabee45a) { $v04a366a14b["select_" . $v2ee72186a7 . "_" . $v4fdabee45a] = $v78108fb2bd; $v04a366a14b["select_" . $v90917a75d0 . "_" . $v4fdabee45a] = $v78108fb2bd; } if ($pdcad24c1) { $v04a366a14b["select_" . $pdcad24c1 . "_" . $v7d1891d6f3] = $v78108fb2bd; $v04a366a14b["select_" . $pdcad24c1 . "_" . $v5e633ad35b] = $v78108fb2bd; if ($v4fdabee45a) $v04a366a14b["select_" . $pdcad24c1 . "_" . $v4fdabee45a] = $v78108fb2bd; } $v04a366a14b["get_" . $pc3ba545b] = $v78108fb2bd; $v04a366a14b["get_" . $v67afa08079] = $v78108fb2bd; if ($pc9421a7d) $v04a366a14b["get_" . $pc9421a7d] = $v78108fb2bd; $v04a366a14b["get_" . $v2ee72186a7 . "_" . $pc3ba545b] = $v78108fb2bd; $v04a366a14b["get_" . $v90917a75d0 . "_" . $v67afa08079] = $v78108fb2bd; $v04a366a14b["get_" . $v90917a75d0 . "_" . $pc3ba545b] = $v78108fb2bd; $v04a366a14b["get_" . $v2ee72186a7 . "_" . $v67afa08079] = $v78108fb2bd; if ($pc9421a7d) { $v04a366a14b["get_" . $v2ee72186a7 . "_" . $pc9421a7d] = $v78108fb2bd; $v04a366a14b["get_" . $v90917a75d0 . "_" . $pc9421a7d] = $v78108fb2bd; } if ($pdcad24c1) { $v04a366a14b["get_" . $pdcad24c1 . "_" . $pc3ba545b] = $v78108fb2bd; $v04a366a14b["get_" . $pdcad24c1 . "_" . $v67afa08079] = $v78108fb2bd; if ($pc9421a7d) $v04a366a14b["get_" . $pdcad24c1 . "_" . $pc9421a7d] = $v78108fb2bd; } $v04a366a14b["select_" . $pc3ba545b] = $v78108fb2bd; $v04a366a14b["select_" . $v67afa08079] = $v78108fb2bd; if ($pc9421a7d) $v04a366a14b["select_" . $pc9421a7d] = $v78108fb2bd; $v04a366a14b["select_" . $v2ee72186a7 . "_" . $pc3ba545b] = $v78108fb2bd; $v04a366a14b["select_" . $v90917a75d0 . "_" . $v67afa08079] = $v78108fb2bd; $v04a366a14b["select_" . $v90917a75d0 . "_" . $pc3ba545b] = $v78108fb2bd; $v04a366a14b["select_" . $v2ee72186a7 . "_" . $v67afa08079] = $v78108fb2bd; if ($pc9421a7d) { $v04a366a14b["select_" . $v2ee72186a7 . "_" . $pc9421a7d] = $v78108fb2bd; $v04a366a14b["select_" . $v90917a75d0 . "_" . $pc9421a7d] = $v78108fb2bd; } if ($pdcad24c1) { $v04a366a14b["select_" . $pdcad24c1 . "_" . $pc3ba545b] = $v78108fb2bd; $v04a366a14b["select_" . $pdcad24c1 . "_" . $v67afa08079] = $v78108fb2bd; if ($pc9421a7d) $v04a366a14b["select_" . $pdcad24c1 . "_" . $pc9421a7d] = $v78108fb2bd; } } } return $v04a366a14b; } function getForeignQueriesCountName($pba9184cd, $v8c5df8072b, $v3b6d7c67a8) { $v04a366a14b = array(); if ($pba9184cd) { $v566db8f5a9 = getTableAlias($v8c5df8072b, $v3b6d7c67a8); $v2ee72186a7 = strtolower($v8c5df8072b); $pdcad24c1 = $v566db8f5a9 ? strtolower($v566db8f5a9) : null; $v90917a75d0 = str_replace(".", "_", $v2ee72186a7); $pc37695cb = count($pba9184cd); for ($v43dd7d0051 = 0; $v43dd7d0051 < $pc37695cb; $v43dd7d0051++) { $pa7c14731 = $pba9184cd[$v43dd7d0051]; $pbdbd4aa6 = strtolower($pa7c14731["child_table"]); $v78108fb2bd = $pbdbd4aa6 == $v2ee72186a7 ? $pa7c14731["parent_table"] : $pa7c14731["child_table"]; $pea4553dc = getTableAlias($v78108fb2bd, $v3b6d7c67a8); $v7d1891d6f3 = strtolower($v78108fb2bd); $v4fdabee45a = $pea4553dc ? strtolower($pea4553dc) : null; $v5e633ad35b = str_replace(".", "_", $v7d1891d6f3); $pc3ba545b = CMSPresentationFormSettingsUIHandler::getPlural($v7d1891d6f3); $pc9421a7d = $v4fdabee45a ? CMSPresentationFormSettingsUIHandler::getPlural($v4fdabee45a) : null; $v67afa08079 = str_replace(".", "_", $pc3ba545b); $v61d3466499 = WorkFlowDataAccessHandler::getForeignTableQueryCountName($v8c5df8072b, $v78108fb2bd, $pa7c14731["type"]); $v04a366a14b[$v61d3466499] = $v78108fb2bd; if ($v566db8f5a9) { if ($pea4553dc) { $v61d3466499 = WorkFlowDataAccessHandler::getForeignTableQueryCountName($v566db8f5a9, $pea4553dc, $pa7c14731["type"]); $v04a366a14b[$v61d3466499] = $v78108fb2bd; } $v61d3466499 = WorkFlowDataAccessHandler::getForeignTableQueryCountName($v566db8f5a9, $v78108fb2bd, $pa7c14731["type"]); $v04a366a14b[$v61d3466499] = $v78108fb2bd; } $v04a366a14b["total_number_of_" . $v7d1891d6f3] = $v78108fb2bd; $v04a366a14b["total_number_of_" . $v5e633ad35b] = $v78108fb2bd; if ($v4fdabee45a) $v04a366a14b["total_number_of_" . $v4fdabee45a] = $v78108fb2bd; $v04a366a14b["total_number_of_" . $v2ee72186a7 . "_" . $v7d1891d6f3] = $v78108fb2bd; $v04a366a14b["total_number_of_" . $v90917a75d0 . "_" . $v5e633ad35b] = $v78108fb2bd; $v04a366a14b["total_number_of_" . $v90917a75d0 . "_" . $v7d1891d6f3] = $v78108fb2bd; $v04a366a14b["total_number_of_" . $v2ee72186a7 . "_" . $v5e633ad35b] = $v78108fb2bd; if ($v4fdabee45a) { $v04a366a14b["total_number_of_" . $v2ee72186a7 . "_" . $v4fdabee45a] = $v78108fb2bd; $v04a366a14b["total_number_of_" . $v90917a75d0 . "_" . $v4fdabee45a] = $v78108fb2bd; } if ($pdcad24c1) { $v04a366a14b["total_number_of_" . $pdcad24c1 . "_" . $v7d1891d6f3] = $v78108fb2bd; $v04a366a14b["total_number_of_" . $pdcad24c1 . "_" . $v5e633ad35b] = $v78108fb2bd; if ($v4fdabee45a) $v04a366a14b["total_number_of_" . $pdcad24c1 . "_" . $v4fdabee45a] = $v78108fb2bd; } $v04a366a14b["total_num_of_" . $v7d1891d6f3] = $v78108fb2bd; $v04a366a14b["total_num_of_" . $v5e633ad35b] = $v78108fb2bd; if ($v4fdabee45a) $v04a366a14b["total_num_of_" . $v4fdabee45a] = $v78108fb2bd; $v04a366a14b["total_num_of_" . $v2ee72186a7 . "_" . $v7d1891d6f3] = $v78108fb2bd; $v04a366a14b["total_num_of_" . $v90917a75d0 . "_" . $v5e633ad35b] = $v78108fb2bd; $v04a366a14b["total_num_of_" . $v90917a75d0 . "_" . $v7d1891d6f3] = $v78108fb2bd; $v04a366a14b["total_num_of_" . $v2ee72186a7 . "_" . $v5e633ad35b] = $v78108fb2bd; if ($v4fdabee45a) { $v04a366a14b["total_num_of_" . $v2ee72186a7 . "_" . $v4fdabee45a] = $v78108fb2bd; $v04a366a14b["total_num_of_" . $v90917a75d0 . "_" . $v4fdabee45a] = $v78108fb2bd; } if ($pdcad24c1) { $v04a366a14b["total_num_of_" . $pdcad24c1 . "_" . $v7d1891d6f3] = $v78108fb2bd; $v04a366a14b["total_num_of_" . $pdcad24c1 . "_" . $v5e633ad35b] = $v78108fb2bd; if ($v4fdabee45a) $v04a366a14b["total_num_of_" . $pdcad24c1 . "_" . $v4fdabee45a] = $v78108fb2bd; } $v04a366a14b["total_" . $v7d1891d6f3] = $v78108fb2bd; $v04a366a14b["total_" . $v5e633ad35b] = $v78108fb2bd; if ($v4fdabee45a) $v04a366a14b["total_" . $v4fdabee45a] = $v78108fb2bd; $v04a366a14b["total_" . $v2ee72186a7 . "_" . $v7d1891d6f3] = $v78108fb2bd; $v04a366a14b["total_" . $v90917a75d0 . "_" . $v5e633ad35b] = $v78108fb2bd; $v04a366a14b["total_" . $v90917a75d0 . "_" . $v7d1891d6f3] = $v78108fb2bd; $v04a366a14b["total_" . $v2ee72186a7 . "_" . $v5e633ad35b] = $v78108fb2bd; if ($v4fdabee45a) { $v04a366a14b["total_" . $v2ee72186a7 . "_" . $v4fdabee45a] = $v78108fb2bd; $v04a366a14b["total_" . $v90917a75d0 . "_" . $v4fdabee45a] = $v78108fb2bd; } if ($pdcad24c1) { $v04a366a14b["total_" . $pdcad24c1 . "_" . $v7d1891d6f3] = $v78108fb2bd; $v04a366a14b["total_" . $v91c2483dbf . "_" . $v5e633ad35b] = $v78108fb2bd; $v04a366a14b["total_" . $v91c2483dbf . "_" . $v7d1891d6f3] = $v78108fb2bd; $v04a366a14b["total_" . $pdcad24c1 . "_" . $v5e633ad35b] = $v78108fb2bd; if ($v4fdabee45a) $v04a366a14b["total_" . $pdcad24c1 . "_" . $v4fdabee45a] = $v78108fb2bd; } $v04a366a14b["total_of_" . $pc3ba545b] = $v78108fb2bd; $v04a366a14b["total_of_" . $v67afa08079] = $v78108fb2bd; if ($v4fdabee45a) $v04a366a14b["total_of_" . $pc9421a7d] = $v78108fb2bd; $v04a366a14b["total_of_" . $v2ee72186a7 . "_" . $pc3ba545b] = $v78108fb2bd; $v04a366a14b["total_of_" . $v90917a75d0 . "_" . $v67afa08079] = $v78108fb2bd; $v04a366a14b["total_of_" . $v90917a75d0 . "_" . $pc3ba545b] = $v78108fb2bd; $v04a366a14b["total_of_" . $v2ee72186a7 . "_" . $v67afa08079] = $v78108fb2bd; if ($v4fdabee45a) { $v04a366a14b["total_of_" . $v2ee72186a7 . "_" . $pc9421a7d] = $v78108fb2bd; $v04a366a14b["total_of_" . $v90917a75d0 . "_" . $pc9421a7d] = $v78108fb2bd; } if ($pdcad24c1) { $v04a366a14b["total_of_" . $pdcad24c1 . "_" . $pc3ba545b] = $v78108fb2bd; $v04a366a14b["total_of_" . $pdcad24c1 . "_" . $v67afa08079] = $v78108fb2bd; if ($v4fdabee45a) $v04a366a14b["total_of_" . $pdcad24c1 . "_" . $pc9421a7d] = $v78108fb2bd; } $v04a366a14b["count_of_" . $pc3ba545b] = $v78108fb2bd; $v04a366a14b["count_of_" . $v67afa08079] = $v78108fb2bd; if ($v4fdabee45a) $v04a366a14b["count_of_" . $pc9421a7d] = $v78108fb2bd; $v04a366a14b["count_of_" . $v2ee72186a7 . "_" . $pc3ba545b] = $v78108fb2bd; $v04a366a14b["count_of_" . $v90917a75d0 . "_" . $v67afa08079] = $v78108fb2bd; $v04a366a14b["count_of_" . $v90917a75d0 . "_" . $pc3ba545b] = $v78108fb2bd; $v04a366a14b["count_of_" . $v2ee72186a7 . "_" . $v67afa08079] = $v78108fb2bd; if ($v4fdabee45a) { $v04a366a14b["count_of_" . $v2ee72186a7 . "_" . $pc9421a7d] = $v78108fb2bd; $v04a366a14b["count_of_" . $v90917a75d0 . "_" . $pc9421a7d] = $v78108fb2bd; } if ($pdcad24c1) { $v04a366a14b["count_of_" . $pdcad24c1 . "_" . $pc3ba545b] = $v78108fb2bd; $v04a366a14b["count_of_" . $pdcad24c1 . "_" . $v67afa08079] = $v78108fb2bd; if ($v4fdabee45a) $v04a366a14b["count_of_" . $pdcad24c1 . "_" . $pc9421a7d] = $v78108fb2bd; } $v04a366a14b["count_" . $pc3ba545b] = $v78108fb2bd; $v04a366a14b["count_" . $v67afa08079] = $v78108fb2bd; if ($v4fdabee45a) $v04a366a14b["count_" . $pc9421a7d] = $v78108fb2bd; $v04a366a14b["count_" . $v2ee72186a7 . "_" . $pc3ba545b] = $v78108fb2bd; $v04a366a14b["count_" . $v90917a75d0 . "_" . $v67afa08079] = $v78108fb2bd; $v04a366a14b["count_" . $v90917a75d0 . "_" . $pc3ba545b] = $v78108fb2bd; $v04a366a14b["count_" . $v2ee72186a7 . "_" . $v67afa08079] = $v78108fb2bd; if ($v4fdabee45a) { $v04a366a14b["count_" . $v2ee72186a7 . "_" . $pc9421a7d] = $v78108fb2bd; $v04a366a14b["count_" . $v90917a75d0 . "_" . $pc9421a7d] = $v78108fb2bd; } if ($pdcad24c1) { $v04a366a14b["count_" . $pdcad24c1 . "_" . $pc3ba545b] = $v78108fb2bd; $v04a366a14b["count_" . $pdcad24c1 . "_" . $v67afa08079] = $v78108fb2bd; if ($v4fdabee45a) $v04a366a14b["count_" . $pdcad24c1 . "_" . $pc9421a7d] = $v78108fb2bd; } } } return $v04a366a14b; } function parseBeanObjects($v10eb48c548, $v98ac5e49f1, $v3911ed9dd0, $pdf77ee66, $pd5679809, $pb154d332) { $v52b4591032 = array(); $v75b595c772 = array(UserAuthenticationHandler::$PERMISSION_BELONG_NAME, UserAuthenticationHandler::$PERMISSION_REFERENCED_NAME); foreach ($v10eb48c548 as $pf00752d4 => $pfa76de49) { $v9695385c6c = in_array($pfa76de49["properties"]["item_type"], $v3911ed9dd0); $v8aa142e92e = in_array($pfa76de49["properties"]["item_type"], $v98ac5e49f1); if ($v9695385c6c || $v8aa142e92e) { if ($pfa76de49["properties"]["path"]) { $v3fab52f440 = $pd5679809 . $pfa76de49["properties"]["path"]; if (!$pdf77ee66->isInnerFilePermissionAllowed($v3fab52f440, "layer", "access")) continue; else if ($pb154d332 && !$pdf77ee66->isLayoutInnerFilePermissionAllowed($v3fab52f440, $pb154d332, "layer", $v75b595c772)) continue; } if ($v9695385c6c) { $v1b52505418 = parseBeanObjects($pfa76de49, $v98ac5e49f1, $v3911ed9dd0, $pdf77ee66, $pd5679809, $pb154d332); if (in_array($pfa76de49["properties"]["item_type"], $v98ac5e49f1)) { $pfa76de49["properties"]["name"] = $pf00752d4; $pfa76de49["properties"]["childs"] = $v1b52505418; $v52b4591032[] = $pfa76de49["properties"]; } else { $v52b4591032 = array_merge($v52b4591032, $v1b52505418); } } else if ($v8aa142e92e) { $pfa76de49["properties"]["name"] = $pf00752d4; $v52b4591032[] = $pfa76de49["properties"]; } } } return $v52b4591032; } function getTableAlias($v8c5df8072b, $v3b6d7c67a8) { $v596ed11fcc = strtolower($v8c5df8072b); if ($v3b6d7c67a8) foreach ($v3b6d7c67a8 as $pd98df87c => $v566db8f5a9) if (strtolower($pd98df87c) == $v596ed11fcc) return $v566db8f5a9; return null; } ?>
