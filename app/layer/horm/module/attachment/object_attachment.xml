<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN" "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">

<sql_mapping>
	<class name="ObjectAttachment" table="mat_object_attachment">
		<id column="attachment_id"></id>
		<id column="object_type_id"></id>
		<id column="object_id"></id>
	
		<relationships>
			<one_to_many name="object_attachment">
				<attribute column="*" table="mat_attachment" />
				
				<key pcolumn="attachment_id" fcolumn="attachment_id" ftable="mat_attachment" />
			</one_to_many>
		</relationships>
		
		<queries>
			<delete id="delete_corrupted_object_attachments">
				delete from mat_object_attachment where attachment_id not in (select attachment_id from mat_attachment)
			</delete>
		</queries>
	</class>
</sql_mapping>
