<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sql_mapping>
	<insert id="insert_zone">
		insert into mz_zone (city_id, name, created_date, modified_date) values (#city_id#, '#name#', '#created_date#', '#modified_date#')
	</insert>
	
	<insert id="insert_zone_with_ai_pk" hard_coded_ai_pk="1">
		insert into mz_zone (zone_id, city_id, name, created_date, modified_date) values (#zone_id#, #city_id#, '#name#', '#created_date#', '#modified_date#')
	</insert>
	
	<update id="update_zone">
		update mz_zone set city_id=#city_id#, name='#name#', modified_date='#modified_date#' where zone_id=#zone_id#
	</update>
	
	<delete id="delete_zone">
		delete from mz_zone where zone_id=#zone_id#
	</delete>
	
	<delete id="delete_zones_by_conditions">
		delete from mz_zone where #conditions#
	</delete>
	
	<delete id="delete_zones_by_state_id">
		delete zo.*
		from mz_city ci on ci.state_id=#state_id#
		inner join mz_zone zo on zo.city_id=ci.city_id
	</delete>
	
	<delete id="delete_zones_by_country_id">
		delete zo.*
		from mz_state st on st.country_id=#country_id#
		inner join mz_city ci on ci.state_id=st.state_id
		inner join mz_zone zo on zo.city_id=ci.city_id
	</delete>
	
	<select id="get_zone">
		select zo.*, ci.city_id, ci.name as 'city', st.state_id, st.name as 'state', co.country_id, co.name as 'country'
		from mz_zone zo
		inner join mz_city ci on ci.city_id=zo.city_id
		inner join mz_state st on st.state_id=ci.state_id
		inner join mz_country co on co.country_id=st.country_id
		where zo.zone_id=#zone_id#
	</select>
	
	<select id="get_all_zones">
		select * from mz_zone
	</select>
	
	<select id="count_all_zones">
		select count(zone_id) total from mz_zone
	</select>
	
	<select id="get_zones_by_conditions">
		select * from mz_zone where #conditions#
	</select>
	
	<select id="count_zones_by_conditions">
		select count(zone_id) total from mz_zone where #conditions#
	</select>
	
	<select id="get_full_zones">
		select zo.*, ci.city_id, ci.name as 'city', st.state_id, st.name as 'state', co.country_id, co.name as 'country'
		from mz_zone zo
		inner join mz_city ci on ci.city_id=zo.city_id
		inner join mz_state st on st.state_id=ci.state_id
		inner join mz_country co on co.country_id=st.country_id
	</select>
</sql_mapping>
