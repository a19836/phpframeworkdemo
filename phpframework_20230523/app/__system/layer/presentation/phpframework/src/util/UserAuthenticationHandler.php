<?php
/*
 * Copyright (c) 2007 PHPMyFrameWork - Joao Pinto
 * AUTHOR: Joao Paulo Lopes Pinto -- http://jplpinto.com
 * 
 * The use of this code must be allowed first by the creator Joao Pinto, since this is a private and proprietary code.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS 
 * OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY 
 * AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR 
 * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL 
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, 
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER 
 * IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT 
 * OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. IN NO EVENT SHALL 
 * THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN 
 * AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE 
 * OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */

include_once get_lib("org.phpframework.encryption.CryptoKeyHandler"); include_once get_lib("org.phpframework.util.web.MyCurl"); include_once get_lib("org.phpframework.util.web.CookieHandler"); include_once $EVC->getUtilPath("PHPVariablesFileHandler"); class UserAuthenticationHandler { private $v08d9602741; private $v4ab372da3a; private $v4d53ffcb5b; private $v24fca487e5; private $v5380789621; private $v7ccb6be4c2; private $pb4beacef; private $pc8cfa0e6; private $v32656fa0f9; private $pb70bfc8c; private $v15b05562ca; private $pa170978e; private $v6202772579; private $v8a120a6f88; private $v0e2f315c32; private $v902a67f557; private $v932d8f1db7; private $v764e6d9ccb; private $pd5862d2d; private $v9ee164334c; private $v70d0acb477; private $v876fde503c; private $v6210daa6a2; private $v80e52685d5; private $v7cd20d5c7c = 3; private $v2a0a34710a = 3600; private $v164f1c2710 = 86400; private $pd1721e68 = 1800; private $v1b11d4abe0 = array("post"); private $pca4d8e5a = true; public $auth; public static $USER_SESSION_ID_VARIABLE_NAME = "system_session_id"; public static $USER_SESSION_COOKIES_EXTRA_FLAGS = array("SameSite" => "Strict", "httponly" => true); public static $USER_SESSION_AUTHENTICATION_RESTRICTED_TO_SAME_REFERER_HOST = true; public static $USER_SESSION_CONTROL_VARIABLE_NAME = "system_session_control"; public static $URL_BACK_VARIABLE_NAME = "system_url_back"; public static $AVAILABLE_LAYOUTS_TYPES = array(0 => "From Project"); public static $LAYOUTS_TYPE_FROM_PROJECT_ID = 0; public static $PERMISSION_BELONG_NAME = "belong"; public static $PERMISSION_REFERENCED_NAME = "referenced"; public function __construct($v08d9602741, $v4ab372da3a, $v4d53ffcb5b, $v24fca487e5) { $this->v08d9602741 = $v08d9602741; $this->v4ab372da3a = $v4ab372da3a; $this->v4d53ffcb5b = $v4d53ffcb5b; $this->v24fca487e5 = $v24fca487e5; } public function setEncryptionKeys($v9994512d98) { $this->v5380789621 = $v9994512d98["permission_table_encryption_key"]; $this->v7ccb6be4c2 = $v9994512d98["user_table_encryption_key"]; $this->pb4beacef = $v9994512d98["user_type_table_encryption_key"]; $this->pc8cfa0e6 = $v9994512d98["object_type_table_encryption_key"]; $this->v32656fa0f9 = $v9994512d98["user_type_permission_table_encryption_key"]; $this->pb70bfc8c = $v9994512d98["user_user_type_table_encryption_key"]; $this->v15b05562ca = $v9994512d98["login_control_table_encryption_key"]; $this->pa170978e = $v9994512d98["user_stats_table_encryption_key"]; $this->v6202772579 = $v9994512d98["layout_type_table_encryption_key"]; $this->v8a120a6f88 = $v9994512d98["layout_type_permission_table_encryption_key"]; } public function setAuthSettings($v7cd20d5c7c, $v2a0a34710a, $v164f1c2710, $pca4d8e5a) { if (is_numeric($v7cd20d5c7c)) $this->v7cd20d5c7c = $v7cd20d5c7c; if (is_numeric($v2a0a34710a)) $this->v2a0a34710a = $v2a0a34710a; if (is_numeric($v164f1c2710)) $this->v164f1c2710 = $v164f1c2710; if (isset($pca4d8e5a)) $this->pca4d8e5a = $pca4d8e5a ? true : false; } public function isLocalDB() { return $this->pca4d8e5a; } public function getURLContent($v6f3a2700dd, $pd65a9318 = null, $pfe5382a0 = 0) { $v1fc19b96e1 = parse_url($v6f3a2700dd, PHP_URL_HOST); $v7c0d95d431 = explode(":", $_SERVER["HTTP_HOST"]); $v7c0d95d431 = $v7c0d95d431[0]; $v30857f7eca = array( "url" => $v6f3a2700dd, "post" => $pd65a9318, "cookie" => $v7c0d95d431 == $v1fc19b96e1 ? $_COOKIE : null, "settings" => array( "referer" => $_SERVER["HTTP_REFERER"], "follow_location" => 1, "connection_timeout" => $pfe5382a0, ) ); if ($_SERVER["AUTH_TYPE"] && $_SERVER["PHP_AUTH_USER"]) { $v30857f7eca["settings"]["http_auth"] = $_SERVER["AUTH_TYPE"]; $v30857f7eca["settings"]["user_pwd"] = $_SERVER["PHP_AUTH_USER"] . ":" . $_SERVER["PHP_AUTH_PW"]; } $v56a64ecb97 = new MyCurl(); $v56a64ecb97->initSingle($v30857f7eca); $v56a64ecb97->get_contents(); $pae77d38c = $v56a64ecb97->getData(); return $pae77d38c[0]["content"]; } public function moveLocalDBToAnotherFolder($pb6dc9016) { $v5c1c342594 = true; if ($pb6dc9016 && $pb6dc9016 != $this->v4ab372da3a) { if (!is_dir($pb6dc9016)) @mkdir($pb6dc9016, 0755, true); if (!is_dir($pb6dc9016)) return false; $v6ee393d9fb = scandir($this->v4ab372da3a); foreach ($v6ee393d9fb as $v7dffdb5a5b) if (!is_dir($this->v4ab372da3a . "/$v7dffdb5a5b") && $v7dffdb5a5b != "." && $v7dffdb5a5b != "..") if (!rename($this->v4ab372da3a . "/$v7dffdb5a5b", $pb6dc9016 . "/$v7dffdb5a5b")) $v5c1c342594 = false; } return $v5c1c342594; } public function moveLocalDBToRemoteDBOrViceVersa($pca4d8e5a, $pd7a36e35) { $v5c1c342594 = true; $pca4d8e5a = $pca4d8e5a ? true : false; $v05461178ef = $this->pca4d8e5a != $pca4d8e5a; $pf8e6eaae = false; if (!$v05461178ef && !$pca4d8e5a) { $pdcf670f6 = $GLOBALS["default_db_driver"]; $v202cbc1ae3 = $pdcf670f6 . $GLOBALS[$pdcf670f6 . "_db_host"] . $GLOBALS[$pdcf670f6 . "_db_name"] . $GLOBALS[$pdcf670f6 . "_db_encoding"] . $GLOBALS[$pdcf670f6 . "_db_odbc_data_source"]; $pdcf670f6 = $pd7a36e35["default_db_driver"]; $pf733dd6c = $pdcf670f6 . $pd7a36e35[$pdcf670f6 . "_db_host"] . $pd7a36e35[$pdcf670f6 . "_db_name"] . $pd7a36e35[$pdcf670f6 . "_db_encoding"] . $pd7a36e35[$pdcf670f6 . "_db_odbc_data_source"]; $pf8e6eaae = $v202cbc1ae3 != $pf733dd6c; } if ($v05461178ef || $pf8e6eaae) { $v0565564551 = $this->mfe542d7f43af(); $this->pca4d8e5a = $pca4d8e5a; $pfaf08f23 = new PHPVariablesFileHandler(GLOBAL_VARIABLES_PROPERTIES_FILE_PATH); $pfaf08f23->startUserGlobalVariables(); if ($pf8e6eaae) { $v2a9b6f4e3b = $this->v08d9602741->getPresentationLayer()->getPHPFrameWork(); $v52b4591032 = $v2a9b6f4e3b->getObjects(); $v1346f812b1 = $GLOBALS["default_db_driver"]; $v2a9b6f4e3b->getObject("DBLayer")->setDefaultBrokerName($v1346f812b1); foreach ($v52b4591032 as $v55c0c0e582 => $v972f1a5c2b) { if (is_a($v972f1a5c2b, "DB") && $v972f1a5c2b->getType() == $v1346f812b1) { $v968ce26ec3 = $v972f1a5c2b->getOptions(); foreach ($v968ce26ec3 as $v101cf0807e => $v9be6913e98) { $pd5c2e01d = $v1346f812b1 . "_" . (substr($v101cf0807e, 0, 3) == "db_" ? "" : "db_") . $v101cf0807e; if (isset($GLOBALS[$pd5c2e01d])) $v968ce26ec3[$v101cf0807e] = $GLOBALS[$pd5c2e01d]; } $v972f1a5c2b->setOptions($v968ce26ec3); } } } $v5c1c342594 = $this->f9bf653414c() && $this->f287f98fae5($v0565564551); $pfaf08f23->endUserGlobalVariables(); } return $v5c1c342594; } private function mfe542d7f43af() { $v071f6e4dbf = $this->getAllLoginControls(); $pef34936b = $this->getAllPermissions(); $v9d327640d1 = $this->getAllUsers(); $pdb7688d1 = $this->getAllUserTypes(); $v7953a8daf6 = $this->getAllObjectTypes(); $pd5862d2d = $this->getAllUserTypePermissions(); $pcf7bebfa = $this->getAllUserUserTypes(); $v85cfc8b4a4 = $this->getAllUserStats(); $v94e23d3150 = $this->getAllLayoutTypes(); $pff25d6bd = $this->getAllLayoutTypePermissions(); return array( "login_controls" => $v071f6e4dbf, "permissions" => $pef34936b, "users" => $v9d327640d1, "user_types" => $pdb7688d1, "object_types" => $v7953a8daf6, "user_type_permissions" => $pd5862d2d, "user_user_types" => $pcf7bebfa, "user_stats" => $v85cfc8b4a4, "layout_types" => $v94e23d3150, "layout_type_permissions" => $pff25d6bd, ); } private function f9bf653414c() { return $this->f9887d51e15() && $this->mce46dbdbe346() && $this->mc76874ada7a0() && $this->md4760be86c64() && $this->f0c2093085c() && $this->mcae4e768ee10() && $this->f73a6f3ac2b() && $this->f1b01980d8d() && $this->f7e3347ae87() && $this->f56285706f8(); } private function f287f98fae5($v0565564551) { $v5c1c342594 = true; $v071f6e4dbf = $v0565564551["login_controls"]; $pef34936b = $v0565564551["permissions"]; $v9d327640d1 = $v0565564551["users"]; $pdb7688d1 = $v0565564551["user_types"]; $v7953a8daf6 = $v0565564551["object_types"]; $pd5862d2d = $v0565564551["user_type_permissions"]; $pcf7bebfa = $v0565564551["user_user_types"]; $v85cfc8b4a4 = $v0565564551["user_stats"]; $v94e23d3150 = $v0565564551["layout_types"]; $pff25d6bd = $v0565564551["layout_type_permissions"]; $pc37695cb = $v071f6e4dbf ? count($v071f6e4dbf) : 0; for ($v43dd7d0051 = 0; $v43dd7d0051 < $pc37695cb; $v43dd7d0051++) if (!$this->insertLoginControl( $v071f6e4dbf[$v43dd7d0051] )) $v5c1c342594 = false; $pc37695cb = $pef34936b ? count($pef34936b) : 0; for ($v43dd7d0051 = 0; $v43dd7d0051 < $pc37695cb; $v43dd7d0051++) if (!$this->insertPermission( $pef34936b[$v43dd7d0051] )) $v5c1c342594 = false; $pc37695cb = $v9d327640d1 ? count($v9d327640d1) : 0; for ($v43dd7d0051 = 0; $v43dd7d0051 < $pc37695cb; $v43dd7d0051++) { $v9d327640d1[$v43dd7d0051]["options"]["raw_password"] = true; if (!$this->insertUser( $v9d327640d1[$v43dd7d0051] )) $v5c1c342594 = false; } $pc37695cb = $pdb7688d1 ? count($pdb7688d1) : 0; for ($v43dd7d0051 = 0; $v43dd7d0051 < $pc37695cb; $v43dd7d0051++) if (!$this->insertUserType( $pdb7688d1[$v43dd7d0051] )) $v5c1c342594 = false; $pc37695cb = $v7953a8daf6 ? count($v7953a8daf6) : 0; for ($v43dd7d0051 = 0; $v43dd7d0051 < $pc37695cb; $v43dd7d0051++) if (!$this->insertObjectType( $v7953a8daf6[$v43dd7d0051] )) $v5c1c342594 = false; $pc37695cb = $pd5862d2d ? count($pd5862d2d) : 0; for ($v43dd7d0051 = 0; $v43dd7d0051 < $pc37695cb; $v43dd7d0051++) if (!$this->insertUserTypePermission( $pd5862d2d[$v43dd7d0051] )) $v5c1c342594 = false; $pc37695cb = $pcf7bebfa ? count($pcf7bebfa) : 0; for ($v43dd7d0051 = 0; $v43dd7d0051 < $pc37695cb; $v43dd7d0051++) if (!$this->insertUserUserType( $pcf7bebfa[$v43dd7d0051] )) $v5c1c342594 = false; $pc37695cb = $v85cfc8b4a4 ? count($v85cfc8b4a4) : 0; for ($v43dd7d0051 = 0; $v43dd7d0051 < $pc37695cb; $v43dd7d0051++) if (!$this->insertUserStat( $v85cfc8b4a4[$v43dd7d0051] )) $v5c1c342594 = false; $pc37695cb = $v94e23d3150 ? count($v94e23d3150) : 0; for ($v43dd7d0051 = 0; $v43dd7d0051 < $pc37695cb; $v43dd7d0051++) if (!$this->insertLayoutType( $v94e23d3150[$v43dd7d0051] )) $v5c1c342594 = false; $pc37695cb = $pff25d6bd ? count($pff25d6bd) : 0; for ($v43dd7d0051 = 0; $v43dd7d0051 < $pc37695cb; $v43dd7d0051++) if (!$this->insertLayoutTypePermission( $pff25d6bd[$v43dd7d0051] )) $v5c1c342594 = false; return $v5c1c342594; } public function login($pd97bc935, $v8a9d082c74) { $this->auth = false; $v317efb26b3 = $this->getUserByUsernameAndPassword($pd97bc935, $v8a9d082c74); if ($v317efb26b3 && $v317efb26b3["username"]) { $pf503710f = $_COOKIE[ self::$USER_SESSION_ID_VARIABLE_NAME ]; $v164f1c2710 = time() + $this->v164f1c2710; $v539082ff30 = array( "username" => $pd97bc935, "login_expired_time" => $v164f1c2710, "session_id" => $pf503710f ); $pf503710f = $this->insertLoginControl($v539082ff30); if ($pf503710f) { unset($v317efb26b3["password"]); $this->auth = array( "login_expired_time" => $v164f1c2710, "user_data" => $v317efb26b3, ); CookieHandler::setSafeCookie(self::$USER_SESSION_ID_VARIABLE_NAME, $pf503710f, 0, "/", self::$USER_SESSION_COOKIES_EXTRA_FLAGS); $v492fce9a5d = CryptoKeyHandler::encryptText( time() + $this->pd1721e68, $this->v15b05562ca ); $v492fce9a5d = CryptoKeyHandler::binToHex($v492fce9a5d); CookieHandler::setSafeCookie(self::$USER_SESSION_CONTROL_VARIABLE_NAME, $v492fce9a5d, 0, "/", self::$USER_SESSION_COOKIES_EXTRA_FLAGS); return true; } } } public function logout() { $pf503710f = $_COOKIE[ self::$USER_SESSION_ID_VARIABLE_NAME ]; if ($pf503710f) $this->expireSession($pf503710f); unset($_COOKIE[ self::$USER_SESSION_ID_VARIABLE_NAME ]); CookieHandler::setCurrentDomainEternalRootSafeCookie(self::$USER_SESSION_ID_VARIABLE_NAME, "", -1); unset($_COOKIE[ self::$URL_BACK_VARIABLE_NAME ]); CookieHandler::setCurrentDomainEternalRootSafeCookie(self::$URL_BACK_VARIABLE_NAME, "", -1); return true; } public function getUrlBack() { return $_COOKIE[ self::$URL_BACK_VARIABLE_NAME ]; } public function checkPresentationFileAuthentication($pf3dc0762, $pef34936b) { return $this->f2105a1f07d($pf3dc0762, "page", $pef34936b); } private function f2105a1f07d($pf3dc0762, $v982d6fe381, $pef34936b) { $v932d8f1db7 = $this->getAvailableObjectTypes(); $v0a035c60aa = $v932d8f1db7[$v982d6fe381]; $v3fab52f440 = str_replace(APP_PATH, "", $pf3dc0762); $v3fab52f440 = substr($v3fab52f440, 0, 1) == "/" ? substr($v3fab52f440, 1) : $v3fab52f440; $v3fab52f440 = str_replace("//", "/", $v3fab52f440); return $this->f42fab66e23($v0a035c60aa, $v3fab52f440, $pef34936b); } private function f42fab66e23($v0a035c60aa, $v3fab52f440, $pef34936b) { unset($_COOKIE[ self::$URL_BACK_VARIABLE_NAME ]); CookieHandler::setCurrentDomainEternalRootSafeCookie(self::$URL_BACK_VARIABLE_NAME, "", -1); $this->v70d0acb477 = $v0a035c60aa; $this->v876fde503c = $v3fab52f440; if ($this->mc5f431beedd4()) { $pef34936b = is_array($pef34936b) ? $pef34936b : array($pef34936b); foreach ($pef34936b as $v76032145ee) if (!$this->isCurrentPagePermissionAllowed($v76032145ee)) $this->mfff9dcc5d15c($this->v24fca487e5); } else { $this->logout(); $this->mfff9dcc5d15c($this->v4d53ffcb5b); } } public function checkInnerFilePermissionAuthentication($pf3dc0762, $v982d6fe381, $v76032145ee, $v1122be2a8a = true) { unset($_COOKIE[ self::$URL_BACK_VARIABLE_NAME ]); CookieHandler::setCurrentDomainEternalRootSafeCookie(self::$URL_BACK_VARIABLE_NAME, "", -1); if ($this->mc5f431beedd4()) { if (!$this->isInnerFilePermissionAllowed($pf3dc0762, $v982d6fe381, $v76032145ee, $v1122be2a8a)) $this->mfff9dcc5d15c($this->v24fca487e5); } else { $this->logout(); $this->mfff9dcc5d15c($this->v4d53ffcb5b); } } public function isCurrentPagePermissionAllowed($v76032145ee) { return $this->f984b2a1db7($this->v70d0acb477, $this->v876fde503c, $v76032145ee); } public function isPresentationFilePermissionAllowed($pf3dc0762, $v76032145ee) { return $this->isFilePermissionAllowed($pf3dc0762, "page", $v76032145ee); } public function isFilePermissionAllowed($pf3dc0762, $v982d6fe381, $v76032145ee) { $v932d8f1db7 = $this->getAvailableObjectTypes(); $v0a035c60aa = $v932d8f1db7[$v982d6fe381]; $v3fab52f440 = str_replace(APP_PATH, "", $pf3dc0762); $v3fab52f440 = substr($v3fab52f440, 0, 1) == "/" ? substr($v3fab52f440, 1) : $v3fab52f440; $v3fab52f440 = str_replace("//", "/", $v3fab52f440); return $this->f984b2a1db7($v0a035c60aa, $v3fab52f440, $v76032145ee); } public function isInnerFilePermissionAllowed($pf3dc0762, $v982d6fe381, $v76032145ee, $v1122be2a8a = true) { $v932d8f1db7 = $this->getAvailableObjectTypes(); $v0a035c60aa = $v932d8f1db7[$v982d6fe381]; $v6dbbc9ebc6 = $v0a035c60aa ? $this->v9ee164334c[$v0a035c60aa] : null; if ($v6dbbc9ebc6) { if (substr(strtolower($pf3dc0762), 0, strlen(APP_PATH)) == strtolower(APP_PATH)) $v3fab52f440 = substr($pf3dc0762, strlen(APP_PATH)); else $v3fab52f440 = $pf3dc0762; $v3fab52f440 = substr($v3fab52f440, 0, 1) == "/" ? substr($v3fab52f440, 1) : $v3fab52f440; $v3fab52f440 .= substr($v3fab52f440, -1) != "/" ? "/" : ""; $v3fab52f440 = preg_replace("/\/+/", "/", $v3fab52f440); $v45f636ba82 = ""; foreach ($v6dbbc9ebc6 as $v9ff79a4a24 => $pef34936b) { $v3f88f6c564 = $v9ff79a4a24 . (substr($v9ff79a4a24, -1) != "/" ? "/" : ""); if (strlen($v3fab52f440) >= strlen($v3f88f6c564) && substr($v3fab52f440, 0, strlen($v3f88f6c564)) == $v3f88f6c564 && strlen($v45f636ba82) < strlen($v9ff79a4a24)) $v45f636ba82 = $v9ff79a4a24; } if ($v45f636ba82) { return $this->f984b2a1db7($v0a035c60aa, $v45f636ba82, $v76032145ee); } return $v1122be2a8a; } return false; } private function f984b2a1db7($v0a035c60aa, $v3fab52f440, $v76032145ee) { $v0e2f315c32 = $this->getAvailablePermissions(); $pb76ee81a = $v0e2f315c32[strtolower($v76032145ee)]; $v87830a8f2a = $v0a035c60aa && $v3fab52f440 ? $this->v9ee164334c[$v0a035c60aa][$v3fab52f440] : null; return is_array($v87830a8f2a) ? in_array($pb76ee81a, $v87830a8f2a) : false; } public function isLayoutInnerFilePermissionAllowed($pf3dc0762, $v67eb76783f, $v982d6fe381, $v76032145ee, $v1122be2a8a = false, $pc49eef79 = true) { $v932d8f1db7 = $this->getAvailableObjectTypes(); $v0a035c60aa = $v932d8f1db7[$v982d6fe381]; $v0e2f315c32 = $this->getAvailablePermissions(); if (is_array($v76032145ee)) { $pb76ee81a = array(); foreach ($v76032145ee as $v9acf40c110) $pb76ee81a[] = $v0e2f315c32[strtolower($v9acf40c110)]; } else $pb76ee81a = $v0e2f315c32[strtolower($v76032145ee)]; $v67eb76783f = preg_replace("/\/+/", "/", $v67eb76783f); $v6dbbc9ebc6 = $v67eb76783f && $v0a035c60aa ? $this->v80e52685d5[$v67eb76783f][$v0a035c60aa] : null; if ($pb76ee81a && $v6dbbc9ebc6) { if (substr(strtolower($pf3dc0762), 0, strlen(APP_PATH)) == strtolower(APP_PATH)) $v3fab52f440 = substr($pf3dc0762, strlen(APP_PATH)); else $v3fab52f440 = $pf3dc0762; $v3fab52f440 = substr($v3fab52f440, 0, 1) == "/" ? substr($v3fab52f440, 1) : $v3fab52f440; $v3fab52f440 .= substr($v3fab52f440, -1) != "/" ? "/" : ""; $v3fab52f440 = preg_replace("/\/+/", "/", $v3fab52f440); $v45f636ba82 = ""; $v20da793cb0 = ""; foreach ($v6dbbc9ebc6 as $v9ff79a4a24 => $pef34936b) if (is_array($pef34936b)) { if (is_array($pb76ee81a)) $v158cba88c4 = count(array_intersect($pb76ee81a, $pef34936b)); else $v158cba88c4 = in_array($pb76ee81a, $pef34936b); if ($v158cba88c4) { $v3f88f6c564 = $v9ff79a4a24 . (substr($v9ff79a4a24, -1) != "/" ? "/" : ""); if (strlen($v3fab52f440) >= strlen($v3f88f6c564) && substr($v3fab52f440, 0, strlen($v3f88f6c564)) == $v3f88f6c564 && strlen($v45f636ba82) < strlen($v9ff79a4a24) ) $v45f636ba82 = $v9ff79a4a24; else if ($pc49eef79 && strlen($v3fab52f440) < strlen($v3f88f6c564) && substr($v3f88f6c564, 0, strlen($v3fab52f440)) == $v3fab52f440 && (!$v20da793cb0 || strlen($v20da793cb0) > strlen($v9ff79a4a24)) ) $v20da793cb0 = $v9ff79a4a24; } } $pc1da042e = $v45f636ba82 ? $v45f636ba82 : $v20da793cb0; if ($pc1da042e) { if (is_array($v76032145ee)) { foreach ($v76032145ee as $v9acf40c110) if ($this->f98f503c94e($v67eb76783f, $v0a035c60aa, $pc1da042e, $v9acf40c110)) return true; } else return $this->f98f503c94e($v67eb76783f, $v0a035c60aa, $pc1da042e, $v76032145ee); } return $v1122be2a8a; } return false; } private function f98f503c94e($v67eb76783f, $v0a035c60aa, $v3fab52f440, $v76032145ee) { $v0e2f315c32 = $this->getAvailablePermissions(); $pb76ee81a = $v0e2f315c32[strtolower($v76032145ee)]; $v87830a8f2a = $v67eb76783f && $v0a035c60aa && $v3fab52f440 ? $this->v80e52685d5[$v67eb76783f][$v0a035c60aa][$v3fab52f440] : null; return is_array($v87830a8f2a) ? in_array($pb76ee81a, $v87830a8f2a) : false; } private function mfff9dcc5d15c($v6f3a2700dd) { $pd0f08866 = (!empty($_SERVER['HTTPS']) && $_SERVER['HTTPS'] !== 'off' || $_SERVER['SERVER_PORT'] == 443 ? "https://" : "http://") . $_SERVER["HTTP_HOST"] . $_SERVER["REQUEST_URI"]; $_COOKIE[ self::$URL_BACK_VARIABLE_NAME ] = $pd0f08866; CookieHandler::setCurrentDomainEternalRootSafeCookie(self::$URL_BACK_VARIABLE_NAME, $pd0f08866); header("Location: " . $v6f3a2700dd); die("<script>document.location = '" . $v6f3a2700dd . "';</script>"); } private function f6cfde46671() { $v06ba5136db = $_SERVER["HTTP_REFERER"] ? strtolower(parse_url($_SERVER["HTTP_REFERER"], PHP_URL_HOST)) : null; $v0e7ba85a30 = explode(":", $_SERVER["HTTP_HOST"]); $v0e7ba85a30 = $v0e7ba85a30[0]; return $v06ba5136db && $v06ba5136db == strtolower($v0e7ba85a30); } private function mc5f431beedd4() { $pf503710f = $_COOKIE[ self::$USER_SESSION_ID_VARIABLE_NAME ]; if ($pf503710f) { $v5c1c342594 = true; if (self::$USER_SESSION_AUTHENTICATION_RESTRICTED_TO_SAME_REFERER_HOST) $v5c1c342594 = $this->f6cfde46671(); if ($v5c1c342594) { if (!$this->auth["user_data"]["user_id"]) { $v94a3a0e2c5 = $this->getLoginControlBySessionId($pf503710f); if ($v94a3a0e2c5["username"]) { $v317efb26b3 = $this->searchUsers(array("username" => $v94a3a0e2c5["username"])); $v317efb26b3 = $v317efb26b3[0]; unset($v317efb26b3["password"]); $this->auth["user_data"] = $v317efb26b3; $this->auth["login_expired_time"] = $v94a3a0e2c5["login_expired_time"]; } } if ($this->auth["user_data"]["user_id"]) { $this->f5de9379417(); if ($this->auth["login_expired_time"] > time()) { if (in_array(strtolower($_SERVER['REQUEST_METHOD']), $this->v1b11d4abe0)) { $pd6a77b38 = $_COOKIE[ self::$USER_SESSION_CONTROL_VARIABLE_NAME ]; if ($pd6a77b38) { $pd6a77b38 = CryptoKeyHandler::hexToBin($pd6a77b38); $pd6a77b38 = CryptoKeyHandler::decryptText($pd6a77b38, $this->v15b05562ca); } if (is_numeric($pd6a77b38) && $pd6a77b38 >= time()) { $v492fce9a5d = CryptoKeyHandler::encryptText( time() + $this->pd1721e68, $this->v15b05562ca ); $v492fce9a5d = CryptoKeyHandler::binToHex($v492fce9a5d); CookieHandler::setSafeCookie(self::$USER_SESSION_CONTROL_VARIABLE_NAME, $v492fce9a5d, 0, "/", self::$USER_SESSION_COOKIES_EXTRA_FLAGS); return $this->auth["user_data"]["user_id"]; } } else { $v492fce9a5d = CryptoKeyHandler::encryptText( time() + $this->pd1721e68, $this->v15b05562ca ); $v492fce9a5d = CryptoKeyHandler::binToHex($v492fce9a5d); CookieHandler::setSafeCookie(self::$USER_SESSION_CONTROL_VARIABLE_NAME, $v492fce9a5d, 0, "/", self::$USER_SESSION_COOKIES_EXTRA_FLAGS); return $this->auth["user_data"]["user_id"]; } } } } } } private function f5de9379417() { if (empty($this->pd5862d2d)) { $this->pd5862d2d = array(); $this->v9ee164334c = array(); if ($this->auth["user_data"]["user_id"]) { $pcf7bebfa = $this->getUserUserTypesByUserId($this->auth["user_data"]["user_id"]); foreach ($pcf7bebfa as $v6bbd1726b0) { $pd5862d2d = $this->searchUserTypePermissions(array("user_type_id" => $v6bbd1726b0)); if (is_array($pd5862d2d)) { $this->pd5862d2d = array_merge($this->pd5862d2d, $pd5862d2d); foreach ($pd5862d2d as $v84775e80c1) { $this->v9ee164334c[ $v84775e80c1["object_type_id"] ][ $v84775e80c1["object_id"] ][] = $v84775e80c1["permission_id"]; } } } } } } public function loadLayoutPermissions($v67eb76783f, $pb13127fc = 0) { if (empty($this->layout_type_permissions[$v67eb76783f])) { $this->v6210daa6a2[$v67eb76783f] = array(); $this->v80e52685d5[$v67eb76783f] = array(); $v94e23d3150 = $this->getAvailableLayoutTypes($pb13127fc); $v1a222c94d4 = $v94e23d3150[$v67eb76783f]; if ($v1a222c94d4) { $pff25d6bd = $this->searchLayoutTypePermissions(array("layout_type_id" => $v1a222c94d4)); if (is_array($pff25d6bd)) { $this->v6210daa6a2[$v67eb76783f] = array_merge($this->v6210daa6a2[$v67eb76783f], $pff25d6bd); foreach ($pff25d6bd as $pb8889c54) $this->v80e52685d5[$v67eb76783f][ $pb8889c54["object_type_id"] ][ $pb8889c54["object_id"] ][] = $pb8889c54["permission_id"]; } } } } public function changeLoginControlTableEncryptionKey($pf11e1c70) { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->v15b05562ca, "new_encryption_key" => $pf11e1c70); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBLoginControlService.changeTableEncryptionKey", $v539082ff30); } } private function f9887d51e15() { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->v15b05562ca); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBLoginControlService.dropAndCreateTable", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBLoginControlService.dropAndCreateTable"); } public function insertLoginControl($v539082ff30) { if ($this->pca4d8e5a) { $v539082ff30["root_path"] = $this->v4ab372da3a; $v539082ff30["encryption_key"] = $this->v15b05562ca; return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBLoginControlService.insert", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBLoginControlService.insert", $v539082ff30); } public function insertFailedLoginAttempt($pd97bc935) { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->v15b05562ca, "username" => $pd97bc935); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBLoginControlService.insertFailedLoginAttempt", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBLoginControlService.insertFailedLoginAttempt", array("username" => $pd97bc935)); } public function expireSession($pf503710f) { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->v15b05562ca, "session_id" => $pf503710f); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBLoginControlService.expireSession", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBLoginControlService.expireSession", array("session_id" => $pf503710f)); } public function resetFailedLoginAttempts($pd97bc935) { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->v15b05562ca, "username" => $pd97bc935); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBLoginControlService.resetFailedLoginAttempts", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBLoginControlService.resetFailedLoginAttempts", array("username" => $pd97bc935)); } public function getFailedLoginAttempts($pd97bc935) { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->v15b05562ca, "username" => $pd97bc935); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBLoginControlService.getFailedLoginAttempts", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBLoginControlService.getFailedLoginAttempts", array("username" => $pd97bc935)); } public function getLoginControl($pd97bc935) { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->v15b05562ca, "username" => $pd97bc935); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBLoginControlService.get", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBLoginControlService.get", array("username" => $pd97bc935)); } public function getLoginControlBySessionId($pf503710f) { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->v15b05562ca, "session_id" => $pf503710f); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBLoginControlService.getBySessionId", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBLoginControlService.getBySessionId", array("session_id" => $pf503710f)); } public function isUserBlocked($pd97bc935) { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->v15b05562ca, "username" => $pd97bc935, "maximum_failed_attempts" => $this->v7cd20d5c7c, "user_blocked_expired_time" => $this->v2a0a34710a); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBLoginControlService.isUserBlocked", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBLoginControlService.isUserBlocked", array("username" => $pd97bc935, "maximum_failed_attempts" => $this->v7cd20d5c7c, "user_blocked_expired_time" => $this->v2a0a34710a)); } public function getAllLoginControls() { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->v15b05562ca); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBLoginControlService.getAll", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBLoginControlService.getAll"); } public function changePermissionTableEncryptionKey($pf11e1c70) { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->v5380789621, "new_encryption_key" => $pf11e1c70); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBPermissionService.changeTableEncryptionKey", $v539082ff30); } } private function mce46dbdbe346() { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->v5380789621); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBPermissionService.dropAndCreateTable", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBPermissionService.dropAndCreateTable"); } public function insertPermission($v539082ff30) { if ($this->pca4d8e5a) { $v539082ff30["root_path"] = $this->v4ab372da3a; $v539082ff30["encryption_key"] = $this->v5380789621; return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBPermissionService.insert", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBPermissionService.insert", $v539082ff30); } public function updatePermission($v539082ff30) { if ($this->pca4d8e5a) { $v539082ff30["root_path"] = $this->v4ab372da3a; $v539082ff30["encryption_key"] = $this->v5380789621; return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBPermissionService.update", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBPermissionService.update", $v539082ff30); } public function deletePermission($pb76ee81a) { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->v5380789621, "permission_id" => $pb76ee81a); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBPermissionService.delete", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBPermissionService.delete", array("permission_id" => $pb76ee81a)); } public function getPermission($pb76ee81a) { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->v5380789621, "permission_id" => $pb76ee81a); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBPermissionService.get", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBPermissionService.get", array("permission_id" => $pb76ee81a)); } public function getAllPermissions() { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->v5380789621); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBPermissionService.getAll", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBPermissionService.getAll"); } public function searchPermissions($paf1bc6f6) { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->v5380789621, "conditions" => $paf1bc6f6); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBPermissionService.search", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBPermissionService.search", array("conditions" => $paf1bc6f6)); } public function getAvailablePermissions() { if (empty($this->v0e2f315c32)) { $this->v0e2f315c32 = array(); $pef34936b = $this->getAllPermissions(); if ($pef34936b) { $pc37695cb = count($pef34936b); for ($v43dd7d0051 = 0; $v43dd7d0051 < $pc37695cb; $v43dd7d0051++) { $v9acf40c110 = $pef34936b[$v43dd7d0051]; $this->v0e2f315c32[ $v9acf40c110["name"] ] = $v9acf40c110["permission_id"]; } } } return $this->v0e2f315c32; } public function getReservedPermissions() { return array(1, 2, 3); } public function changeUserTableEncryptionKey($pf11e1c70) { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->v7ccb6be4c2, "new_encryption_key" => $pf11e1c70); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBUserService.changeTableEncryptionKey", $v539082ff30); } } private function mc76874ada7a0() { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->v7ccb6be4c2); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBUserService.dropAndCreateTable", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBUserService.dropAndCreateTable"); } public function insertUser($v539082ff30) { if ($this->pca4d8e5a) { $v539082ff30["root_path"] = $this->v4ab372da3a; $v539082ff30["encryption_key"] = $this->v7ccb6be4c2; return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBUserService.insert", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBUserService.insert", $v539082ff30); } public function updateUser($v539082ff30) { if ($this->pca4d8e5a) { $v539082ff30["root_path"] = $this->v4ab372da3a; $v539082ff30["encryption_key"] = $this->v7ccb6be4c2; return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBUserService.update", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBUserService.update", $v539082ff30); } public function deleteUser($v00da14d176) { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->v7ccb6be4c2, "user_id" => $v00da14d176); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBUserService.delete", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBUserService.delete", array("user_id" => $v00da14d176)); } public function getUser($v00da14d176) { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->v7ccb6be4c2, "user_id" => $v00da14d176); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBUserService.get", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBUserService.get", array("user_id" => $v00da14d176)); } public function getUserByUsernameAndPassword($pd97bc935, $v8a9d082c74) { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->v7ccb6be4c2, "username" => $pd97bc935, "password" => $v8a9d082c74); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBUserService.getByUsernameAndPassword", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBUserService.getByUsernameAndPassword", array("username" => $pd97bc935, "password" => $v8a9d082c74)); } public function getAllUsers() { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->v7ccb6be4c2); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBUserService.getAll", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBUserService.getAll"); } public function searchUsers($paf1bc6f6) { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->v7ccb6be4c2, "conditions" => $paf1bc6f6); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBUserService.search", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBUserService.search", array("conditions" => $paf1bc6f6)); } public function getAvailableUsers() { if (empty($this->v764e6d9ccb)) { $this->v764e6d9ccb = array(); $v9d327640d1 = $this->getAllUsers(); if ($v9d327640d1) { $pc37695cb = count($v9d327640d1); for ($v43dd7d0051 = 0; $v43dd7d0051 < $pc37695cb; $v43dd7d0051++) { $pde2db2cc = $v9d327640d1[$v43dd7d0051]; $this->v764e6d9ccb[ $pde2db2cc["name"] ] = $pde2db2cc["user_id"]; } } } return $this->v764e6d9ccb; } public function changeUserTypeTableEncryptionKey($pf11e1c70) { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->pb4beacef, "new_encryption_key" => $pf11e1c70); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBUserTypeService.changeTableEncryptionKey", $v539082ff30); } } private function md4760be86c64() { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->pb4beacef); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBUserTypeService.dropAndCreateTable", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBUserTypeService.dropAndCreateTable"); } public function insertUserType($v539082ff30) { if ($this->pca4d8e5a) { $v539082ff30["root_path"] = $this->v4ab372da3a; $v539082ff30["encryption_key"] = $this->pb4beacef; return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBUserTypeService.insert", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBUserTypeService.insert", $v539082ff30); } public function updateUserType($v539082ff30) { if ($this->pca4d8e5a) { $v539082ff30["root_path"] = $this->v4ab372da3a; $v539082ff30["encryption_key"] = $this->pb4beacef; return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBUserTypeService.update", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBUserTypeService.update", $v539082ff30); } public function deleteUserType($v6bbd1726b0) { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->pb4beacef, "user_type_id" => $v6bbd1726b0); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBUserTypeService.delete", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBUserTypeService.delete", array("user_type_id" => $v6bbd1726b0)); } public function getUserType($v6bbd1726b0) { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->pb4beacef, "user_type_id" => $v6bbd1726b0); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBUserTypeService.get", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBUserTypeService.get", array("user_type_id" => $v6bbd1726b0)); } public function getAllUserTypes() { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->pb4beacef); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBUserTypeService.getAll", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBUserTypeService.getAll"); } public function searchUserTypes($paf1bc6f6) { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->pb4beacef, "conditions" => $paf1bc6f6); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBUserTypeService.search", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBUserTypeService.search", array("conditions" => $paf1bc6f6)); } public function getAvailableUserTypes() { if (empty($this->v902a67f557)) { $this->v902a67f557 = array(); $pdb7688d1 = $this->getAllUserTypes(); if ($pdb7688d1) { $pc37695cb = count($pdb7688d1); for ($v43dd7d0051 = 0; $v43dd7d0051 < $pc37695cb; $v43dd7d0051++) { $pcb71a4d9 = $pdb7688d1[$v43dd7d0051]; $this->v902a67f557[ $pcb71a4d9["name"] ] = $pcb71a4d9["user_type_id"]; } } } return $this->v902a67f557; } public function changeObjectTypeTableEncryptionKey($pf11e1c70) { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->pc8cfa0e6, "new_encryption_key" => $pf11e1c70); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBObjectTypeService.changeTableEncryptionKey", $v539082ff30); } } private function f0c2093085c() { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->pc8cfa0e6); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBObjectTypeService.dropAndCreateTable", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBObjectTypeService.dropAndCreateTable"); } public function insertObjectType($v539082ff30) { if ($this->pca4d8e5a) { $v539082ff30["root_path"] = $this->v4ab372da3a; $v539082ff30["encryption_key"] = $this->pc8cfa0e6; return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBObjectTypeService.insert", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBObjectTypeService.insert", $v539082ff30); } public function updateObjectType($v539082ff30) { if ($this->pca4d8e5a) { $v539082ff30["root_path"] = $this->v4ab372da3a; $v539082ff30["encryption_key"] = $this->pc8cfa0e6; return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBObjectTypeService.update", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBObjectTypeService.update", $v539082ff30); } public function deleteObjectType($v0a035c60aa) { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->pc8cfa0e6, "object_type_id" => $v0a035c60aa); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBObjectTypeService.delete", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBObjectTypeService.delete", array("user_type_id" => $v6bbd1726b0)); } public function getObjectType($v0a035c60aa) { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->pc8cfa0e6, "object_type_id" => $v0a035c60aa); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBObjectTypeService.get", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBObjectTypeService.get", array("user_type_id" => $v6bbd1726b0)); } public function getAllObjectTypes() { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->pc8cfa0e6); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBObjectTypeService.getAll", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBObjectTypeService.getAll"); } public function searchObjectTypes($paf1bc6f6) { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->pc8cfa0e6, "conditions" => $paf1bc6f6); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBObjectTypeService.search", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBObjectTypeService.search", array("conditions" => $paf1bc6f6)); } public function getAvailableObjectTypes() { if (empty($this->v932d8f1db7)) { $this->v932d8f1db7 = array(); $v7953a8daf6 = $this->getAllObjectTypes(); if ($v7953a8daf6) { $pc37695cb = count($v7953a8daf6); for ($v43dd7d0051 = 0; $v43dd7d0051 < $pc37695cb; $v43dd7d0051++) { $v975b306af3 = $v7953a8daf6[$v43dd7d0051]; $this->v932d8f1db7[ $v975b306af3["name"] ] = $v975b306af3["object_type_id"]; } } } return $this->v932d8f1db7; } public function getReservedObjectTypes() { return array(1); } public function changeUserTypePermissionTableEncryptionKey($pf11e1c70) { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->v32656fa0f9, "new_encryption_key" => $pf11e1c70); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBUserTypePermissionService.changeTableEncryptionKey", $v539082ff30); } } private function mcae4e768ee10() { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->v32656fa0f9); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBUserTypePermissionService.dropAndCreateTable", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBUserTypePermissionService.dropAndCreateTable"); } public function insertUserTypePermission($v539082ff30) { if ($this->pca4d8e5a) { $v539082ff30["root_path"] = $this->v4ab372da3a; $v539082ff30["encryption_key"] = $this->v32656fa0f9; return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBUserTypePermissionService.insert", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBUserTypePermissionService.insert", $v539082ff30); } public function updateUserTypesByObjectsPermissions($v6bbd1726b0, $v18f16d2ce6) { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->v32656fa0f9, "user_type_id" => $v6bbd1726b0, "permissions_by_objects" => $v18f16d2ce6); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBUserTypePermissionService.updateByObjectsPermissions", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBUserTypePermissionService.updateByObjectsPermissions", array("user_type_id" => $v6bbd1726b0, "permissions_by_objects" => $v18f16d2ce6)); } public function deleteUserTypePermission($v6bbd1726b0, $pb76ee81a, $v0a035c60aa, $v3fab52f440) { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->v32656fa0f9, "user_type_id" => $v6bbd1726b0, "permission_id" => $pb76ee81a, "object_type_id" => $v0a035c60aa, "object_id" => $v3fab52f440); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBUserTypePermissionService.delete", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBUserTypePermissionService.delete", array("user_type_id" => $v6bbd1726b0, "permission_id" => $pb76ee81a, "object_type_id" => $v0a035c60aa, "object_id" => $v3fab52f440)); } public function deleteUserTypePermissionsByConditions($paf1bc6f6) { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->v32656fa0f9, "conditions" => $paf1bc6f6); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBUserTypePermissionService.deleteByConditions", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBUserTypePermissionService.deleteByConditions", array("conditions" => $paf1bc6f6)); } public function getUserTypePermission($v6bbd1726b0, $pb76ee81a, $v0a035c60aa, $v3fab52f440) { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->v32656fa0f9, "user_type_id" => $v6bbd1726b0, "permission_id" => $pb76ee81a, "object_type_id" => $v0a035c60aa, "object_id" => $v3fab52f440); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBUserTypePermissionService.get", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBUserTypePermissionService.get", array("user_type_id" => $v6bbd1726b0, "permission_id" => $pb76ee81a, "object_type_id" => $v0a035c60aa, "object_id" => $v3fab52f440)); } public function getAllUserTypePermissions() { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->v32656fa0f9); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBUserTypePermissionService.getAll", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBUserTypePermissionService.getAll"); } public function searchUserTypePermissions($paf1bc6f6) { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->v32656fa0f9, "conditions" => $paf1bc6f6); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBUserTypePermissionService.search", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBUserTypePermissionService.search", array("conditions" => $paf1bc6f6)); } public function changeUserUserTypeTableEncryptionKey($pf11e1c70) { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->pb70bfc8c, "new_encryption_key" => $pf11e1c70); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBUserUserTypeService.changeTableEncryptionKey", $v539082ff30); } } private function f73a6f3ac2b() { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->pb70bfc8c); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBUserUserTypeService.dropAndCreateTable", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBUserUserTypeService.dropAndCreateTable"); } public function insertUserUserType($v539082ff30) { if ($this->pca4d8e5a) { $v539082ff30["root_path"] = $this->v4ab372da3a; $v539082ff30["encryption_key"] = $this->pb70bfc8c; return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBUserUserTypeService.insert", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBUserUserTypeService.insert", $v539082ff30); } public function deleteUserUserType($v00da14d176, $v6bbd1726b0) { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->pb70bfc8c, "user_id" => $v00da14d176, "user_type_id" => $v6bbd1726b0); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBUserUserTypeService.delete", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBUserUserTypeService.delete", array("user_id" => $v00da14d176, "user_type_id" => $v6bbd1726b0)); } public function deleteUserUserTypesByConditions($paf1bc6f6) { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->pb70bfc8c, "conditions" => $paf1bc6f6); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBUserUserTypeService.deleteByConditions", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBUserUserTypeService.deleteByConditions", array("conditions" => $paf1bc6f6)); } public function getUserUserType($v00da14d176, $v6bbd1726b0) { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->pb70bfc8c, "user_id" => $v00da14d176, "user_type_id" => $v6bbd1726b0); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBUserUserTypeService.get", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBUserUserTypeService.get", array("user_id" => $v00da14d176, "user_type_id" => $v6bbd1726b0)); } public function getAllUserUserTypes() { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->pb70bfc8c); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBUserUserTypeService.getAll", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBUserUserTypeService.getAll"); } public function searchUserUserTypes($paf1bc6f6) { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->pb70bfc8c, "conditions" => $paf1bc6f6); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBUserUserTypeService.search", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBUserUserTypeService.search", array("conditions" => $paf1bc6f6)); } public function getUserUserTypesByUserId($v00da14d176) { $pcf7bebfa = array(); $v539082ff30 = $this->searchUserUserTypes(array("user_id" => $v00da14d176)); if ($v539082ff30) { $pc37695cb = count($v539082ff30); for ($v43dd7d0051 = 0; $v43dd7d0051 < $pc37695cb; $v43dd7d0051++) $pcf7bebfa[] = $v539082ff30[$v43dd7d0051]["user_type_id"]; } return $pcf7bebfa; } public function changeUserStatsTableEncryptionKey($pf11e1c70) { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->pa170978e, "new_encryption_key" => $pf11e1c70); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBUserStatsService.changeTableEncryptionKey", $v539082ff30); } } private function f1b01980d8d() { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->pa170978e); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBUserStatsService.dropAndCreateTable", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBUserStatsService.dropAndCreateTable"); } public function insertUserStat($v539082ff30) { if ($this->pca4d8e5a) { $v539082ff30["root_path"] = $this->v4ab372da3a; $v539082ff30["encryption_key"] = $this->pa170978e; return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBUserStatsService.insert", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBUserStatsService.insert", $v539082ff30); } public function getUserStat($v5e813b295b) { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->pa170978e, "name" => $v5e813b295b); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBUserStatsService.get", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBUserStatsService.get", array("name" => $v5e813b295b)); } public function getAllUserStats() { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->pa170978e); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBUserStatsService.getAll", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBUserStatsService.getAll"); } public function changeLayoutTypeTableEncryptionKey($pf11e1c70) { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->v6202772579, "new_encryption_key" => $pf11e1c70); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBLayoutTypeService.changeTableEncryptionKey", $v539082ff30); } } private function f7e3347ae87() { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->v6202772579); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBLayoutTypeService.dropAndCreateTable", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBLayoutTypeService.dropAndCreateTable"); } public function insertLayoutType($v539082ff30) { if ($this->pca4d8e5a) { $v539082ff30["root_path"] = $this->v4ab372da3a; $v539082ff30["encryption_key"] = $this->v6202772579; return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBLayoutTypeService.insert", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBLayoutTypeService.insert", $v539082ff30); } public function updateLayoutType($v539082ff30) { if ($this->pca4d8e5a) { $v539082ff30["root_path"] = $this->v4ab372da3a; $v539082ff30["encryption_key"] = $this->v6202772579; return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBLayoutTypeService.update", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBLayoutTypeService.update", $v539082ff30); } public function deleteLayoutType($v1a222c94d4) { if ($this->deleteLayoutTypePermissionsByConditions(array("layout_type_id" => $v1a222c94d4))) { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->v6202772579, "layout_type_id" => $v1a222c94d4); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBLayoutTypeService.delete", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBLayoutTypeService.delete", array("layout_type_id" => $v1a222c94d4)); } return false; } public function getLayoutType($v1a222c94d4) { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->v6202772579, "layout_type_id" => $v1a222c94d4); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBLayoutTypeService.get", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBLayoutTypeService.get", array("layout_type_id" => $v1a222c94d4)); } public function getAllLayoutTypes() { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->v6202772579); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBLayoutTypeService.getAll", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBLayoutTypeService.getAll"); } public function searchLayoutTypes($paf1bc6f6) { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->v6202772579, "conditions" => $paf1bc6f6); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBLayoutTypeService.search", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBLayoutTypeService.search", array("conditions" => $paf1bc6f6)); } public function getAvailableLayoutTypes($pb13127fc) { if (empty($this->available_layout_types)) { $this->available_layout_types = array(); $v94e23d3150 = is_numeric($pb13127fc) ? $this->searchLayoutTypes(array("type_id" => $pb13127fc)) : $this->getAllLayoutTypes(); if ($v94e23d3150) { $pc37695cb = count($v94e23d3150); for ($v43dd7d0051 = 0; $v43dd7d0051 < $pc37695cb; $v43dd7d0051++) { $pcb71a4d9 = $v94e23d3150[$v43dd7d0051]; $this->available_layout_types[ $pcb71a4d9["name"] ] = $pcb71a4d9["layout_type_id"]; } } } return $this->available_layout_types; } public function changeLayoutTypePermissionTableEncryptionKey($pf11e1c70) { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->v8a120a6f88, "new_encryption_key" => $pf11e1c70); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBLayoutTypePermissionService.changeTableEncryptionKey", $v539082ff30); } } private function f56285706f8() { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->v8a120a6f88); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBLayoutTypePermissionService.dropAndCreateTable", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBLayoutTypePermissionService.dropAndCreateTable"); } public function insertLayoutTypePermission($v539082ff30) { if ($this->pca4d8e5a) { $v539082ff30["root_path"] = $this->v4ab372da3a; $v539082ff30["encryption_key"] = $this->v8a120a6f88; return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBLayoutTypePermissionService.insert", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBLayoutTypePermissionService.insert", $v539082ff30); } public function updateLayoutTypesByObjectsPermissions($v1a222c94d4, $v18f16d2ce6) { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->v8a120a6f88, "layout_type_id" => $v1a222c94d4, "permissions_by_objects" => $v18f16d2ce6); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBLayoutTypePermissionService.updateByObjectsPermissions", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBLayoutTypePermissionService.updateByObjectsPermissions", array("layout_type_id" => $v1a222c94d4, "permissions_by_objects" => $v18f16d2ce6)); } public function deleteLayoutTypePermission($v1a222c94d4, $pb76ee81a, $v0a035c60aa, $v3fab52f440) { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->v8a120a6f88, "layout_type_id" => $v1a222c94d4, "permission_id" => $pb76ee81a, "object_type_id" => $v0a035c60aa, "object_id" => $v3fab52f440); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBLayoutTypePermissionService.delete", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBLayoutTypePermissionService.delete", array("layout_type_id" => $v1a222c94d4, "permission_id" => $pb76ee81a, "object_type_id" => $v0a035c60aa, "object_id" => $v3fab52f440)); } public function deleteLayoutTypePermissionsByConditions($paf1bc6f6) { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->v8a120a6f88, "conditions" => $paf1bc6f6); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBLayoutTypePermissionService.deleteByConditions", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBLayoutTypePermissionService.deleteByConditions", array("conditions" => $paf1bc6f6)); } public function getLayoutTypePermission($v1a222c94d4, $pb76ee81a, $v0a035c60aa, $v3fab52f440) { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->v8a120a6f88, "layout_type_id" => $v1a222c94d4, "permission_id" => $pb76ee81a, "object_type_id" => $v0a035c60aa, "object_id" => $v3fab52f440); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBLayoutTypePermissionService.get", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBLayoutTypePermissionService.get", array("layout_type_id" => $v1a222c94d4, "permission_id" => $pb76ee81a, "object_type_id" => $v0a035c60aa, "object_id" => $v3fab52f440)); } public function getAllLayoutTypePermissions() { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->v8a120a6f88); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBLayoutTypePermissionService.getAll", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBLayoutTypePermissionService.getAll"); } public function searchLayoutTypePermissions($paf1bc6f6) { if ($this->pca4d8e5a) { $v539082ff30 = array("root_path" => $this->v4ab372da3a, "encryption_key" => $this->v8a120a6f88, "conditions" => $paf1bc6f6); return $this->v08d9602741->getBroker()->callBusinessLogic("auth.localdb", "LocalDBLayoutTypePermissionService.search", $v539082ff30); } return $this->v08d9602741->getBroker()->callBusinessLogic("auth.remotedb", "RemoteDBLayoutTypePermissionService.search", array("conditions" => $paf1bc6f6)); } public function isUsersMaximumNumberReached() { $v6c3f76fcae = $this->v08d9602741->getPresentationLayer()->getPHPFrameWork()->gLI(); $v9d327640d1 = $this->getAllUsers(); return $v6c3f76fcae["umn"] != -1 && count($v9d327640d1) >= $v6c3f76fcae["umn"]; } public function isUsersMaximumNumberExceeded() { $v6c3f76fcae = $this->v08d9602741->getPresentationLayer()->getPHPFrameWork()->gLI(); $v9d327640d1 = $this->getAllUsers(); return $v6c3f76fcae["umn"] != -1 && count($v9d327640d1) > $v6c3f76fcae["umn"]; } public static function checkUsersMaxNum($UserAuthenticationHandler) { $v258de04f2e = "246578636565646564203d20245573657241757468656e7469636174696f6e48616e646c65722d3e697355736572734d6178696d756d4e756d626572457863656564656428293b20246d73673d22596f752065786365656420746865206d6178696d756d206e756d626572206f66207573657273207468617420796f7572206c6963656e636520616c6c6f772e223b"; $v067674f4e4 = ""; for ($v43dd7d0051 = 0; $v43dd7d0051 < strlen($v258de04f2e) - 1; $v43dd7d0051 += 2) $v067674f4e4 .= chr( hexdec($v258de04f2e[$v43dd7d0051] . $v258de04f2e[$v43dd7d0051+1]) ); eval($v067674f4e4); if ($exceeded) { echo $msg; die(1); } } public function incrementUsedActionsTotal() { $v539082ff30 = $this->getUserStat("used_actions_total"); if (!$v539082ff30) $v539082ff30 = array( "name" => "used_actions_total", "value" => CryptoKeyHandler::binToHex(CryptoKeyHandler::encryptText(1, $this->pa170978e)), ); else { $v67db1bd535 = CryptoKeyHandler::decryptText(CryptoKeyHandler::hexTobin($v539082ff30["value"]), $this->pa170978e); $v67db1bd535++; $v539082ff30["value"] = CryptoKeyHandler::binToHex(CryptoKeyHandler::encryptText($v67db1bd535, $this->pa170978e)); } return $this->insertUserStat($v539082ff30); } public function getUsedActionsTotal() { $v539082ff30 = $this->getUserStat("used_actions_total"); return $v539082ff30 ? CryptoKeyHandler::decryptText(CryptoKeyHandler::hexTobin($v539082ff30["value"]), $this->pa170978e) : null; } public function isActionsMaximumNumberReached() { $v6c3f76fcae = $this->v08d9602741->getPresentationLayer()->getPHPFrameWork()->gLI(); $v73bff618b8 = $this->getUsedActionsTotal(); return $v6c3f76fcae["amn"] != -1 && $v73bff618b8 >= $v6c3f76fcae["amn"]; } public static function checkActionsMaxNum($UserAuthenticationHandler) { $v258de04f2e = "2472656163686564203d20245573657241757468656e7469636174696f6e48616e646c65722d3e6973416374696f6e734d6178696d756d4e756d6265725265616368656428293b20246d73673d22596f75207265616368656420746865206d6178696d756d206e756d626572206f6620616374696f6e73207468617420796f7572206c6963656e636520616c6c6f772e223b"; $v067674f4e4 = ""; for ($v43dd7d0051 = 0; $v43dd7d0051 < strlen($v258de04f2e) - 1; $v43dd7d0051 += 2) $v067674f4e4 .= chr( hexdec($v258de04f2e[$v43dd7d0051] . $v258de04f2e[$v43dd7d0051+1]) ); eval($v067674f4e4); if ($reached) { echo $msg; die(1); } } public function isAllowedDomain() { $v6c3f76fcae = $this->v08d9602741->getPresentationLayer()->getPHPFrameWork()->gLI(); $v3d07ac58bb = str_replace(";", ",", trim($v6c3f76fcae["ad"])); $pca291ee6 = $_SERVER["HTTP_HOST"]; $pca291ee6 = !$v6c3f76fcae["cadp"] && strpos($pca291ee6, ":") !== false ? strstr($pca291ee6, ":", true) : $pca291ee6; return !$v3d07ac58bb || preg_match("/,s*" . str_replace(".", "\\.", $pca291ee6) . "s*,/i", ",$v3d07ac58bb,"); } public function isAllowedPath() { $v6c3f76fcae = $this->v08d9602741->getPresentationLayer()->getPHPFrameWork()->gLI(); $v42a3926f5b = str_replace(";", ",", preg_replace("/\/+/", "/", trim($v6c3f76fcae["ap"]))); $pfd460c59 = preg_replace("/\/+$/", "", preg_replace("/\/+/", "/", CMS_PATH)); return !$v42a3926f5b || preg_match("/,s*" . str_replace("/", "\\/", str_replace(".", "\\.", $pfd460c59)) . "\/?s*,/i", ",$v42a3926f5b,"); } } ?>
